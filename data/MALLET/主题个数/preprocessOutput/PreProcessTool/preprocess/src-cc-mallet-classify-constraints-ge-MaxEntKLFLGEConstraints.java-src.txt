2011 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e classify constraint ge type matrix ops math expectation constraint g e penaliz k l divergence target multiple constraint group together here thing efficient gregory druck max ent k l f l g e constraint max ent f l g e constraint max ent k l f l g e constraint num feature num label value num feature num label value get value value 0 0 fi constraint key max ent f l g e constraint constraint constraint get fi constraint count 0 0 constraint value 0 0 label index 0 label index num label ++label index constraint target label index 0 0 target zero expectation 0 infinite penalty constraint expectation label index 0 0 n e g t v e n f n t y p log q p log p negative k l constraint value + constraint target label index math log constraint expectation label index constraint count math log constraint target label index na n constraint value infinite constraint value value + constraint value constraint weight value override add constraint fi ex weight math almost equal matrix ops sum ex 1 constraint put fi max ent k l f l g e constraint ex weight max ent k l f l g e constraint max ent f l g e constraint max ent k l f l g e constraint target weight target weight override get value count 0 target 0 expectation 0 0 weight target expectation 