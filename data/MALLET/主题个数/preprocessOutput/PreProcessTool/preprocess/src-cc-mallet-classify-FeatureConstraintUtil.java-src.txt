2009 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e classify io buffer reader io io reader collection hash map iterator logging logger topic parallel topic model type alphabet type feature vector type info gain type instance type instance type label type matrix ops logger math utility function create feature constraint can g e training gregory druck gdruck gdruck feature constraint logger logger logger get logger feature constraint get name read range constraint store format can feature name label name lower probability upper probability + feature name label name probability + constraint feature label pair present filename feature constraint instance alphabet constraint hash map read range constraint filename instance hash map constraint hash map 0 get target alphabet size li++ err get target alphabet lookup buffer reader reader buffer reader reader filename line reader read line line split line split \\s+ assume feature name space feature name split 0 feature index get alphabet lookup index feature name feature index 1 runtime feature + feature name + found alphabet prob get target alphabet size 2 0 prob length i++ fill prob n e g t v e n f n t y index 1 index split length index++ label split split index split get target alphabet lookup index label split 0 1 label split 0 label split 1 contain range split label split 1 split lower parse range split 0 upper parse range split 1 prob 0 lower prob 1 upper prob parse label split 1 prob 0 prob prob 1 prob constraint put feature index prob line reader read line e e print stack trace exit 1 constraint read feature constraint they store index filename feature constraint instance alphabet constraint hash map read constraint filename instance test constraint index filename read constraint index filename read constraint filename read feature constraint store feature name label name probability + label appear get probability 0 filename feature constraint instance alphabet constraint hash map read constraint filename instance hash map constraint hash map filename buffer reader reader buffer reader reader line reader read line line split line split \\s+ assume feature name space feature name split 0 feature index get alphabet lookup index feature name split length 1 get target alphabet size split length + + get target alphabet size prob split length 1 index 1 index split length index++ label split split index split get target alphabet lookup index label split 0 1 label + label split 0 + found prob parse label split 1 prob prob constraint put feature index prob line reader read line e e print stack trace exit 1 constraint read feature constraint store feature index label 0 prob label 1 prob label n prob here label appear filename feature constraint instance alphabet constraint hash map read constraint index filename instance hash map constraint hash map filename buffer reader reader buffer reader reader line reader read line line split line split \\s+ feature index parse split 0 split length 1 get target alphabet size prob split length 1 index 1 index split length index++ prob parse split index prob index 1 prob constraint put feature index prob line reader read line e e print stack trace exit 1 constraint test constraint index filename filename first line buffer reader reader buffer reader reader first line reader read line e e print stack trace exit 1 first line contain select feature high information gain instance computing information gain num feature feature select feature high information gain select feature info gain instance num feature feature info gain infogain info gain rank 0 rank num feature rank++ feature add infogain get index rank rank feature select top feature l topic num sel feature feature select lda est l estimate pr provide l model seq alphabet alphabet dataset different vector dataset alphabet alphabet vector dataset alphabet index select feature select top l feature num sel feature parallel topic model lda alphabet alphabet feature alphabet seq alphabet lda get alphabet num topic lda get num topic sort lda get top word seq alphabet size po 0 po seq alphabet size pos++ ti 0 ti num topic ti++ feat sort ti po fi alphabet lookup index feat fi 0 feature contain fi logger info select feature + feat feature add fi feature size num sel feature feature feature hash map target instance feature target feature hash map target instance feature normalize target feature normalize target distribution estimate instance estimate target feature feature constraint normalize normalize feature count constraint map feature index target target estimate supply hash map target instance feature value normalize hash map constraint hash map feature label count get feature label count value 0 feature size i++ fi feature get fi get alphabet size prob feature label count fi normalize smooth probability distribution add very small count we just need sure they aren t zero k l divergence infinite matrix ops plus equal prob 1e 8 matrix ops time equal prob 1 matrix ops sum prob constraint put fi prob constraint target distribution schapire heuristic describe learning label feature generalize expectation criterion gregory druck gideon mann mc callum label feature hash map feature index list label index feature num label total label majority prob probability mass divide among majority label constraint map feature index target target distribution heuristic hash map target heuristic hash map label feature num label majority prob hash map constraint hash map iterator key it label feature key iterator key it next fi key it next label label feature get fi constraint put fi get heuristic prior label num label majority prob constraint target distribution feature voting heuristic describe learning label feature generalize expectation criterion gregory druck gideon mann mc callum label feature hash map feature index list label index feature training instance computing expectation feature voting constraint map feature index target target distribution feature voting hash map target feature voting hash map label feature instance training hash map constraint hash map num label training get target alphabet size iterator key it label feature key iterator feature count label feature size num label 0 training size ii++ instance instance training get feature vector fv feature vector instance get label label training get get label label dist num label label label voting label feature instance label dist label get best index label dist 1 key it label feature key iterator 0 key it next fi key it next fv location fi 0 0 num label li++ feature count + label dist fv value location fv location fi i++ key it label feature key iterator 0 key it next fi key it next smooth count matrix ops plus equal feature count 1e 8 matrix ops time equal feature count 1 matrix ops sum feature count constraint put fi feature count i++ constraint label feature heuristic describe learning label feature generalize expectation criterion gregory druck gideon mann mc callum instance compute statistic label feature feature feature label reject reject label feature label feature hash map mapping feature index label hash map label feature instance feature reject hash map label feature hash map feature label count get feature label count num label get target alphabet size min rank 100 num label info gain infogain info gain sum 0 rank 0 rank min rank rank++ sum + infogain get value rank rank sum min rank 0 feature size i++ fi feature get reject feature infogain les cutoff reject infogain value fi err oracle label reject label + get alphabet lookup fi logger info oracle label reject label + get alphabet lookup fi prob feature label count fi matrix ops plus equal prob 1e 8 matrix ops time equal prob 1 matrix ops sum prob sort index get max index prob label num label 2 take anyth factor 2 best num label 2 discard threshold prob sort index 0 2 0 num label li++ prob threshold label add reject label size num label 2 err oracle label reject label + get alphabet lookup fi logger info oracle label reject label + get alphabet lookup fi discard discard label add sort index 0 label feature put fi label label feature hash map label feature instance feature label feature feature get feature label count instance value num feature get alphabet size num label get target alphabet size feature label count num feature num label 0 size ii++ instance instance get feature vector feature vector feature vector instance get handle distribution over label 0 num label li++ py instance get label value loc 0 loc feature vector num location loc++ fi feature vector index location loc val value val feature vector value location loc val 1 0 feature label count fi + py val feature label count get heuristic prior label feature num label majority prob num index label feature size dist num label num index num label 0 dist length i++ dist 1 num label dist keyword prob majority prob num index prob 1 majority prob num label num index 0 label feature size i++ label feature get dist keyword prob 0 num label li++ dist 0 dist prob math almost equal matrix ops sum dist 1 dist label voting hash map label feature instance instance score feature vector fv feature vector instance get num feature instance get alphabet size + 1 num label instance get target alphabet size iterator key iterator label feature key iterator key iterator next majority label feature get key iterator next 0 majority size i++ majority get num label ++ key iterator label feature key iterator key iterator next next key iterator next next num feature loc fv location next loc 0 majority label feature get next 0 majority size i++ majority get score + 1 sum matrix ops sum score sum 0 matrix ops plus equal score 1 0 sum matrix ops sum score 0 score length li++ score sum these function longer get pr word topic l hyp lda num topic lda get num topic num type lda get alphabet size pr word topic num topic num type ti 0 ti num topic ti++ wi 0 wi num type wi++ pr word topic ti wi lda get count feature topic wi ti lda get count topic ti pr word topic get sort topic pr topic word num topic pr topic word length num type pr topic word 0 length sort topic idx num topic num type ti 0 ti num topic ti++ topic idx get max index pr topic word ti arraycopy topic idx 0 sort topic idx ti 0 topic idx length sort topic idx get max index element element 0 length i++ element element element add element collection sort collection reverse sort index length 0 length i++ sort index get index sort index element comparable element index value element index value index index value value compare element element compare value element value 