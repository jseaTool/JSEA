io serializable type label alphabet type provide factory inference engine training transducer sum lattice factory serializable sum lattice sum lattice transducer tran input sum lattice tran input transducer incrementor sum lattice sum lattice transducer tran input transducer incrementor incrementor sum lattice tran input incrementor sum lattice sum lattice transducer tran input output sum lattice tran input output transducer incrementor sum lattice sum lattice transducer tran input output transducer incrementor incrementor sum lattice tran input output incrementor sum lattice sum lattice transducer tran input output transducer incrementor incrementor label alphabet output alphabet sum lattice tran input output incrementor output alphabet sum lattice sum lattice transducer tran input output transducer incrementor incrementor save xi sum lattice tran input output incrementor save xi sum lattice run forward backward tran transducer model input input output output forward backward constrain match output incrementor update weight save xi save transition weight well output alphabet output alphabet label vector position output indicate probability over possible output index sum lattice sum lattice transducer tran input output transducer incrementor incrementor save xi label alphabet output alphabet 