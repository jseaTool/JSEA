topic io type gnu trove topic model diagnostics num topic num top word t w o p e r e n t n e 1 f f t y p e r e n t n e 6 e f u l t o p r o p o r t o n 0 01 0 02 0 05 0 1 0 2 0 3 0 5 word sort count tree sorter topic sort word top n word topic easy access topic top word topic score diagnostics parallel topic model model alphabet alphabet topic codocument matrix num rank1 document num zero document num document proportion quantity entropy calculation sum count time log count word type count num 0 topic model diagnostics parallel topic model model num top word num topic model get num topic num top word num top word model model alphabet model get alphabet topic sort word model get sort word topic top word num topic num top word num rank1 document num topic num zero document num topic num document proportion num topic e f u l t o p r o p o r t o n length sum count time log count num topic diagnostics topic score topic 0 topic num topic topic++ position 0 tree sorter sort word topic sort word get topic many word we report? some topic few word zero weight limit num top word sort word size num top word limit sort word size iterator sorter iterator sort word iterator 0 limit i++ sorter info iterator next topic top word topic alphabet lookup info get collect document statistic diagnostics add get topic model topic diagnostics add get document entropy model topic diagnostics add get word length score diagnostics add get coherence diagnostics add get distance uniform diagnostics add get distance corpus diagnostics add get effective word diagnostics add get document discrepancy diagnostics add get rank1 percent diagnostics add get document percent ratio f f t y p e r e n t n e t w o p e r e n t n e diagnostics add get document percent 5 diagnostics add get exclusivity collect document statistic topic codocument matrix num topic num top word num top word word type count alphabet size num 0 hash set contain word interest topic check word some position word t hash topic top word index t hash num topic same topic top word index instead iterate over position topic word index num topic num top word hash set hold word interest present document clear document t hash doc topic word index t hash num topic num doc model get size count topic again clear document topic count num topic topic 0 topic num topic topic++ t hash word index t hash 0 num top word i++ topic top word topic type alphabet lookup index topic top word topic topic word index topic type word index add type topic top word index topic word index doc topic word index topic t hash doc 0 topic assignment document model get feature feature document instance get feature topic feature document topic position 0 position size position++ type get index position position topic topic get index position position num tokens++ word type count type ++ topic count topic ++ topic top word index topic contain type doc topic word index topic add type doc length size doc length 0 max topic 1 max count 1 topic 0 topic num topic topic++ topic count topic 0 num zero document topic ++ topic count topic max count max topic topic max count topic count topic sum count time log count topic + topic count topic math log topic count topic proportion model alpha topic + topic count topic model alpha sum + doc length 0 e f u l t o p r o p o r t o n length i++ proportion e f u l t o p r o p o r t o n num document proportion topic ++ t hash support word doc topic word index topic index topic word index topic 0 num top word i++ support word contain index j j num top word j++ j diagonal total document word w topic t topic codocument matrix topic ++ support word contain index j topic codocument matrix topic j ++ topic codocument matrix topic j ++ doc topic word index topic clear topic count topic 0 max topic 1 num rank1 document max topic ++ doc++ get codocument matrix topic topic codocument matrix topic topic score get topic topic topic score score topic score num topic num top word topic 0 topic num topic topic++ score topic score topic topic topic score topic score get document entropy topic topic score score topic score document entropy num topic num top word topic 0 topic num topic topic++ score topic score topic sum count time log count topic topic topic + math log topic topic score topic score get distance uniform topic model topic topic score score topic score uniform dist num topic num top word score word score define num type alphabet size topic 0 topic num topic topic++ topic score 0 0 position 0 tree sorter sort word topic sort word get topic sorter info sort word type info get count info get weight score count topic topic math log count num type topic topic position num top word score topic word score topic position score topic score + score position++ score topic score topic topic score score topic score get effective word topic model topic topic score score topic score eff num word num topic num top word num type alphabet size topic 0 topic num topic topic++ sum square probability 0 0 tree sorter sort word topic sort word get topic sorter info sort word type info get probability info get weight topic topic sum square probability + probability probability score topic score topic 1 0 sum square probability score low quality topic very similar global topic score get distance corpus topic model topic topic score score topic score corpus dist num topic num top word score word score define topic 0 topic num topic topic++ coefficient num topic topic topic score 0 0 position 0 tree sorter sort word topic sort word get topic sorter info sort word type info get count info get weight score count topic topic math log coefficient count word type count type position num top word alphabet lookup type + + count + + num + + word type count type + + topic topic + + coefficient count word type count type score topic word score topic position score topic score + score position++ score topic score topic topic score score topic score get document discrepancy topic score score topic score doc diff num topic num top word score word score define topic 0 topic num topic topic++ matrix topic codocument matrix topic tree sorter sort word topic sort word get topic topic score 0 0 word num top word doc num top word word sum 0 0 doc sum 0 0 position 0 iterator sorter iterator sort word iterator iterator next position num top word sorter info iterator next word position info get weight doc position matrix position position word sum + word position doc sum + doc position position++ position 0 position num top word position++ p word position word sum q doc position doc sum prob 0 5 p + q score 0 0 p 0 score + 0 5 p math log p prob q 0 score + 0 5 q math log q prob score topic word score topic position score topic score + score score topic score topic topic score score low quality topic often lot unusually word topic score get word length score topic score score topic score word length num topic num top word score word score define topic 0 topic num topic topic++ total 0 position 0 position topic top word topic length position++ topic top word topic position length topic top word topic position length total + length score topic word score topic position length score topic score topic total topic top word topic length score low quality topic often lot unusually word topic score get word length standard deviation topic score score topic score word length sd num topic num top word score word score define get length length 0 0 total word 0 topic 0 topic num topic topic++ position 0 position topic top word topic length position++ some topic n word topic top word topic position length + topic top word topic position length total word ++ length total word now calculate standard deviation length variance 0 0 topic 0 topic num topic topic++ position 0 position topic top word topic length position++ topic top word topic position length topic top word topic position length length variance + length length length length length variance total word 1 produce overall topic score length math sqrt length variance topic 0 topic num topic topic++ position 0 position topic top word topic length position++ topic top word topic position length topic top word topic position length score add topic score topic length length length score topic word score topic position length length length score topic score get coherence topic score score topic score coherence num topic num top word score word score define topic 0 topic num topic topic++ matrix topic codocument matrix topic topic score 0 0 row 0 row num top word row++ row score 0 0 min score 0 0 col 0 col row col++ score math log matrix row col + model beta matrix col col + model beta row score + score score min score min score score topic score + row score score topic word score topic row min score score topic score topic topic score score topic score get rank1 percent topic score score topic score rank 1 doc num topic num top word topic 0 topic num topic topic++ score topic score topic num rank1 document topic num zero document topic score topic score get document percent ratio numerator index denominator index topic score score topic score allocation ratio num topic num top word numerator index num document proportion 0 length || denominator index num document proportion 0 length err proportion index max + num document proportion 0 length 1 + + numerator index + + denominator index score topic 0 topic num topic topic++ score topic score topic num document proportion topic numerator index num document proportion topic denominator index score topic score get document percent topic score score topic score allocation count num topic num top word num document proportion 0 length err proportion index max + num document proportion 0 length 1 + + score topic 0 topic num topic topic++ score topic score topic num document proportion topic num zero document topic score low quality topic word also prominent topic topic score get exclusivity topic model topic topic score score topic score exclusivity num topic num top word score word score define sum prob 0 0 topic 0 topic num topic topic++ sum prob + model beta model beta sum + topic topic topic 0 topic num topic topic++ topic score 0 0 position 0 tree sorter sort word topic sort word get topic sorter info sort word type info get count info get weight sum type prob sum prob topic count model type topic count type index 0 index topic count length topic count index 0 topic topic count index model topic mask count topic count index model topic bit we ve already account smooth parameter now we need add count zero topic sum type prob + count model beta sum + topic topic index++ score model beta + count model beta sum + topic topic sum type prob score topic word score topic position score topic score + score position++ position num top word score topic score topic topic score num top word score builder builder formatt formatt formatt locale u topic 0 topic num topic topic++ formatt format topic %d topic topic score score diagnostics formatt format % % 4f score name score score topic formatt format position 0 position topic top word topic length position++ topic top word topic position formatt format % topic top word topic position topic score score diagnostics score word score define formatt format % % 4f score name score topic word score topic position append xml topic model topic builder builder formatt formatt formatt locale u append ?xml \ 1 0\ encoding \ u t f 8\ ? append model topic 0 topic num topic topic++ matrix topic codocument matrix topic formatt format topic %d topic topic score score diagnostics formatt format % % 4f score name score score topic append tree sorter sort word topic sort word get topic many word we report? some topic few word zero weight limit num top word sort word size num top word limit sort word size cumulative probability 0 0 iterator sorter iterator sort word iterator position 0 position limit position++ sorter info iterator next probability info get weight topic topic cumulative probability + probability formatt format word rank %d count % 0f prob % 5f cumulative % 5f doc %d position+1 info get weight probability cumulative probability matrix position position topic score score diagnostics score word score define formatt format % % 4f score name score topic word score topic position formatt format % word topic top word topic position replace amp replace append topic append model topic score name score topic word score some diagnostics meaningful value word other word score define topic score name num topic num word name name score num topic topic word score num topic num word topic score topic score score topic score add topic score topic score score topic + score topic word score topic word position score topic word score topic word position score word score define instance instance instance load 0 num topic parse 1 parallel topic model model parallel topic model num topic 5 0 0 01 model add instance instance model num iteration 1000 model estimate topic model diagnostics diagnostics topic model diagnostics model 20 length 3 print writer print writer 2 diagnostics xml close 