2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e mc callum optimize logging optimize optimizable type matrix type matrix ops logger brent information p405 numeric recipe gradient bracket line optimiz line optimiz logger logger logger get logger gradient bracket line optimiz get name max iteration 50 optimizable gradient value optimizable gradient bracket line optimiz optimizable gradient value function optimizable function maximize optimizable function matrix line step maximize optimizable gradient function line step t o o seem work slow back track line search why? last step size line point direction we want move get high value optimize line step step 0 optimizable get num gradient optimizable get num optimizable get optimizable get value gradient gradient left center t test ax bx cx tx step domain these delta ay cy ty range ag bg cg tg project gradient ox step last function call orig y tx ax bx cx ox 0 ty ay cy orig y optimizable get value tg ag bg matrix ops dot gradient line sure search line point upward logger info gradient +tg ag 0 optimizable search direction \ line\ point down uphill + gradient dot line +ag+ positive find cx value gradient point we know local zero gradient fall between ax cx iteration 0 iterations++ max iteration illegal exceed maximum allow iteration search gradient over we still looking move ax toward ax bx ay ag bg save possibly middle point acceptable bx bx tx ty bg tg tx 0 step 1 0 tx step tx 1 0 sometime suggest step very large value go infinity tx step tx 1 0 tx 3 0 logger info gradient over search increment + tx ox matrix ops plus equal line tx ox optimizable ty optimizable get value optimizable get value gradient gradient tg matrix ops dot gradient line logger info next gradient +tg ox tx tg 0 err iteration + total iteration cx tx cy ty cg tg logger info gradient over ax +ax+ bx +bx+ cx +cx logger info gradient over ay +ay+ +by+ cy +cy logger info gradient over ag +ag+ bg +bg+ cg +cg we need find les both ay cy na n ay || cy || bx ax last happen we first loop once iterations++ max iteration illegal exceed maximum allow iteration search bracket iteratation count +iteration xxx what tolerance be? xxx m nervou masking some below be previously failing they be failing due round off o k math ab bg 100 || math ab ay 10 || math ab cy 10 bx ax math ab bg 10 || math ab ay 1 || math ab cy 1 bx ax magically we instead find interpolate point fitting parabola jump y value tolerance parabola fit guess we parabola split region again there some worse simply bisect we now function parabola shape gradient ag bg point same direction value les ay vice versa bg cg ax bx || ag bg 0 ay || bg cg 0 cy na n bg bg 0 high value bx drop ax ay ax bx ay ag bg lower value bx drop cx cy cx bx cy cg bg find mid point bx ax + cx 2 logger info bx search increment + bx ox matrix ops plus equal line bx ox optimizable optimizable get value na n optimizable get value gradient gradient bg matrix ops dot gradient line ox bx logger info dur min bx search +iterations+ ax +ax+ bx +bx+ cx +cx logger info dur min bx search +iterations+ ay +ay+ +by+ cy +cy logger info dur min bx search +iterations+ ag +ag+ bg +bg+ cg +cg we now two point ax cx straddle mid point bx value lower ay cy tx ax + bx ax bx ax cy ay cx ax cx ax ay 2 0 bx ax cy ay cx ax ay logger info ending ax +ax+ bx +bx+ cx +cx+ tx +tx logger info ending ay +ay+ +by+ cy +cy matrix ops plus equal line tx ox optimizable function get value orig y logger info ending cost +optimizable get value suggestion next inital step distance our step we found err iteration + total iteration exit 0 math max 1 tx step 