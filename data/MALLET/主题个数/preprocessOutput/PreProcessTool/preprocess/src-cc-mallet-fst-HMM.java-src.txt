2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e aron culotta culotta culotta mc callum io io output stream io o io input stream io output stream io serializable hash map iterator random logging logger regex pattern type alphabet type feature type instance type instance type multinomial type pipe pipe logger hide markov model h m m transducer serializable logger logger logger get logger h m m get name l e l e p r t o r alphabet input alphabet alphabet output alphabet hash map name2state hash map multinomial estimator transition estimator multinomial estimator emission estimator multinomial estimator estimator multinomial transition multinomial multinomial emission multinomial multinomial multinomial h m m pipe input pipe pipe output pipe input pipe input pipe output pipe output pipe input alphabet input pipe get alphabet output alphabet input pipe get target alphabet h m m alphabet input alphabet alphabet output alphabet input alphabet stop growth logger info h m m input dictionary size + input alphabet size input alphabet input alphabet output alphabet output alphabet alphabet get input alphabet input alphabet alphabet get output alphabet output alphabet multinomial get transition multinomial transition multinomial multinomial get emission multinomial emission multinomial multinomial get multinomial multinomial print buffer sb buffer 0 num i++ get sb append t t e n m e \ sb append name sb append \ sb append destination length sb append outgo transition sb append sb append weight sb append weight sb append sb append sb append weight sb append weight sb append sb append emission + emission multinomial + sb append transition + transition multinomial sb add name weight weight destination name label name label name length destination name length name2state get name illegal argument name ` + name + already name size weight weight destination name label name print add weight m p o l e w e g h t add name2state put name add equal zero label going arc same name destination name add name destination name add name 0 0 destination name destination name add group fully connect equal zero label going arc same name destination name add fully connect name 0 name length i++ add name name add fully connect label label output alphabet size assume entry output alphabet 0 output alphabet size i++ label output alphabet lookup add fully connect label label connection instance training num label output alphabet size connection num label num label instance instance training feature output feature instance get target j 1 j output size j++ index output alphabet lookup index output get j 1 d index output alphabet lookup index output get j index 0 d index 0 connection index d index connection add first markov model label add transition occur training add label connect instance training num label output alphabet size connection label connection training 0 num label i++ num destination 0 j 0 j num label j++ connection j num destinations++ destination name num destination destination index 0 j 0 j num label j++ connection j destination name destination index++ output alphabet lookup j add output alphabet lookup destination name add many there label t weight destination pair instead incoming transition share same weight add half label connect instance training num label output alphabet size connection label connection training 0 num label i++ num destination 0 j 0 j num label j++ connection j num destinations++ destination name num destination destination index 0 j 0 j num label j++ connection j destination name destination index++ output alphabet lookup j add output alphabet lookup 0 0 0 0 destination name destination name add many there label t observational test weight destination pair instead incoming transition share same observational feature test weight feature transition h m m style transition probability add three quarter label connect instance training num label output alphabet size connection label connection training 0 num label i++ num destination 0 j 0 j num label j++ connection j num destinations++ destination name num destination destination index 0 j 0 j num label j++ connection j label name output alphabet lookup j destination name destination index label name transition weight feature gsc variable nev wn output alphabet lookup + + output alphabet lookup j destination index++ add output alphabet lookup 0 0 0 0 destination name destination name add fully connect three quarter label instance training num label output alphabet size 0 num label i++ destination name num label j 0 j num label j++ label name output alphabet lookup j destination name j label name add output alphabet lookup 0 0 0 0 destination name destination name add fully connect bi label label output alphabet size assume entry output alphabet 0 output alphabet size i++ label output alphabet lookup 0 label length i++ j 0 j label length j++ destination name label length k 0 k label length k++ destination name k label j + l e l e p r t o r + label k add label + l e l e p r t o r + label j 0 0 0 0 destination name label add second markov model label add transition occur training add bi label connect instance training num label output alphabet size connection label connection training 0 num label i++ j 0 j num label j++ connection j num destination 0 k 0 k num label k++ connection j k num destinations++ destination name num destination label num destination destination index 0 k 0 k num label k++ connection j k destination name destination index output alphabet lookup j + l e l e p r t o r + output alphabet lookup k label destination index output alphabet lookup k destination index++ add output alphabet lookup + l e l e p r t o r + output alphabet lookup j 0 0 0 0 destination name label add fully connect tri label label output alphabet size assume entry output alphabet 0 output alphabet size i++ logger info h m m output alphabet lookup + output alphabet lookup get get name label output alphabet lookup 0 label length i++ j 0 j label length j++ k 0 k label length k++ destination name label length l 0 l label length l++ destination name l label j + l e l e p r t o r + label k + l e l e p r t o r + label l add label + l e l e p r t o r + label j + l e l e p r t o r + label k 0 0 0 0 destination name label add self transition label name label output alphabet size destination name output alphabet size 0 output alphabet size i++ label output alphabet lookup destination name name add name 0 0 0 0 destination name label concat label label sep buffer buf buffer 0 label length i++ buf append sep append label sep l e l e p r t o r buf next k gram history k next sep buffer buf buffer start history length + 1 k start history length i++ buf append sep append history sep l e l e p r t o r buf append sep append next buf allow transition prev curr pattern pattern yes pair concat label prev curr matcher pair match yes yes matcher pair match allow history history pattern pattern yes 1 history length i++ allow transition history 1 history yes h m m output alphabet contain create em n em h m m input predicate output label training connectivity weight remain argument training training instance order increase negative number giving order feature h m m large em n em markov h m m em n em tuple output label number em k em order weight share destination last most recent em k em label agree order 0 h m m build same length order position indicate weight correspond contain weight feature weight weight feature build input predicate start label context start also label forbid specifie what pair successive label allow both construct em n em transition label pair em u em em v em allow em u em + + em v em match forbid allow specifie what pair successive label allow both construct em n em transition label pair em u em em v em allow em u em + + em v em match allow fully connect allow transition occur training name start add n instance training order start pattern forbid pattern allow fully connect connection fully connect connection label connection training 1 length order length illegal argument match order order 0 0 order length i++ order illegal argument order negative ascending order 0 0 0 history index history label0 output alphabet lookup 0 0 i++ history label0 num label output alphabet size history index 0 num label logger info prepare + concat label history allow history history forbid allow name concat label history nt 0 d name num label label name num label next index 0 next index num label next index++ next output alphabet lookup next index allow transition history 1 next forbid allow fully connect || connection history index 1 next index d name nt next k gram history next label name nt next nt++ nt num label d name nt label name nt t 0 t nt t++ d name t d name t label name t label name t d name d name label name label name add name 0 0 0 0 d name label name o 1 o 0 o ++history index o num label history o output alphabet lookup history index o o 0 history index o 0 history o label0 0 i++ history start concat label history name output alphabet size 0 output alphabet size s++ name output alphabet lookup 0 output alphabet size s++ add name 0 0 0 0 name name start get name name2state get name num size transducer get index transducer get index iterator iterator iterator trainable alphabet get transition alphabet alphabet transition alphabet alphabet 0 num i++ transition alphabet lookup index get get name transition alphabet deprecate reset emission estimator multinomial laplace estimator num transition estimator multinomial laplace estimator num emission multinomial multinomial num transition multinomial multinomial num alphabet transition alphabet get transition alphabet 0 num i++ emission estimator multinomial laplace estimator input alphabet transition estimator multinomial laplace estimator transition alphabet emission multinomial multinomial get uniform input alphabet size input alphabet transition multinomial multinomial get uniform transition alphabet size transition alphabet multinomial multinomial get uniform transition alphabet size transition alphabet estimator multinomial laplace estimator transition alphabet initialization transition emission probability proportional 1+ uniform 0 1 ^noise kedarb random random uniform noise noise exponent zero uniform init transition random random noise alphabet transition alphabet get transition alphabet multinomial multinomial get random transition alphabet size random noise transition alphabet estimator multinomial laplace estimator transition alphabet transition multinomial multinomial num transition estimator multinomial laplace estimator num 0 num i++ transition multinomial multinomial get random transition alphabet size random noise transition alphabet transition estimator multinomial laplace estimator transition alphabet weight get weight multinomial log probability get name init emission random random noise emission multinomial multinomial num emission estimator multinomial laplace estimator num 0 num i++ emission multinomial multinomial get random input alphabet size random noise input alphabet emission estimator multinomial laplace estimator input alphabet estimate alphabet transition alphabet get transition alphabet multinomial estimator estimate estimator multinomial laplace estimator transition alphabet 0 num i++ get emission multinomial emission estimator estimate transition multinomial transition estimator estimate weight multinomial log probability get name reset estimator emission estimator multinomial laplace estimator input alphabet transition estimator multinomial laplace estimator transition alphabet train h m m validation evaluation train instance ilist train ilist instance instance train h m m tt evaluator tt train instance ilist instance validation instance testing train ilist validation testing transducer evaluator train instance ilist instance validation instance testing transducer evaluator eval ilist size 0 emission estimator emission estimator multinomial laplace estimator num transition estimator multinomial laplace estimator num emission multinomial multinomial num transition multinomial multinomial num alphabet transition alphabet alphabet 0 num i++ transition alphabet lookup index get get name 0 num i++ emission estimator multinomial laplace estimator input alphabet transition estimator multinomial laplace estimator transition alphabet emission multinomial multinomial get uniform input alphabet size input alphabet transition multinomial multinomial get uniform transition alphabet size transition alphabet estimator multinomial laplace estimator transition alphabet instance instance ilist feature input feature instance get feature output feature instance get target sum lattice input output incrementor multinomial estimator estimate 0 num i++ emission multinomial emission estimator estimate transition multinomial transition estimator estimate get weight multinomial log probability get get name incrementor transducer incrementor increment transducer count increment transducer count estimator increment get name count increment transition transducer transition iterator ti count input ftr ti get input src h m m transition iterator ti get d h m m transition iterator ti get destination index ti get index emission estimator index increment input ftr count transition estimator src get index increment d get name count weight incrementor transducer incrementor weight 1 0 weight incrementor wt weight wt increment transducer count increment transducer count estimator increment get name weight count increment transition transducer transition iterator ti count input ftr ti get input src h m m transition iterator ti get d h m m transition iterator ti get destination index ti get index emission estimator index increment input ftr weight count transition estimator src get index increment d get name weight count write f output stream oo output stream output stream f oo write oo close o e err + f + + e get uniform size ret size 0 size i++ gsc remove unnecessary cast size ret 1 0 size ret kedarb p 1+random ^noise sum get random size random random noise ret size sum 0 0 size i++ ret random ? 1 0 math pow 1 0 + random next noise sum + ret 0 size i++ ret sum ret serialization h m m serial u 1 u r r e n t e r l v e r o n 1 n u l l n t e g e r 1 need check pointer bug fix cheng ju kuo cju kuo gmail com write output stream o size write u r r e n t e r l v e r o n write input pipe write output pipe write input alphabet write output alphabet size size write size 0 size i++ write get size size write size 0 size i++ write get write name2state emission estimator size emission estimator length write size 0 size i++ write emission estimator write n u l l n t e g e r emission multinomial size emission multinomial length write size 0 size i++ write emission multinomial write n u l l n t e g e r transition estimator size transition estimator length write size 0 size i++ write transition estimator write n u l l n t e g e r transition multinomial size transition multinomial length write size 0 size i++ write transition multinomial write n u l l n t e g e r bug fix cheng ju kuo cju kuo gmail com read input stream o found size read input pipe pipe read output pipe pipe read input alphabet alphabet read output alphabet alphabet read size read 0 size i++ h m m read add size read 0 size i++ h m m read add name2state hash map read size read size n u l l n t e g e r emission estimator emission estimator multinomial estimator size 0 size i++ emission estimator multinomial estimator read size read size n u l l n t e g e r emission multinomial emission multinomial multinomial size 0 size i++ emission multinomial multinomial read size read size n u l l n t e g e r transition estimator transition estimator multinomial estimator size 0 size i++ transition estimator multinomial estimator read size read size n u l l n t e g e r transition multinomial transition multinomial multinomial size 0 size i++ transition multinomial multinomial read transducer serializable index destination feature index name index weight weight destination name destination label h m m hmm constructor serialization name index weight weight destination name label name h m m hmm destination name length label name length name name index index weight weight weight weight destination name destination name length destination label name length label label name length hmm hmm 0 label name length i++ sure label appear our output alphabet hmm output alphabet lookup index label name destination name destination name label label name transducer get transducer hmm get weight weight get weight weight weight weight weight weight print + index + \ + name + \ weight + weight + weight + weight destination + destination length 0 destination length i++ + destination name get destination index ret ret destination index ret destination index hmm name2state get destination name index ret index ret transducer transition iterator transition iterator input input position output output position input position 0 || output position 0 unsupport operation epsilon transition input unsupport operation h m m generative model yet input feature unsupport operation h m m currently expect instance feature transition iterator feature input input position output ? output get output position hmm get name name get index index increment count count increment count count serialization serial u 1 u r r e n t e r l v e r o n 0 n u l l n t e g e r 1 write output stream o size write u r r e n t e r l v e r o n write name write index size destination name ? n u l l n t e g e r destination name length write size size n u l l n t e g e r 0 size i++ write destination name size destination ? n u l l n t e g e r destination length write size size n u l l n t e g e r 0 size i++ write destination size label ? n u l l n t e g e r label length write size size n u l l n t e g e r 0 size i++ write label write hmm read input stream o found size read name read index read size read size n u l l n t e g e r destination name size 0 size i++ destination name read destination name size read size n u l l n t e g e r destination size 0 size i++ destination read destination size read size n u l l n t e g e r label size 0 size i++ label read input alphabet alphabet read output alphabet alphabet read label hmm h m m read transition iterator transducer transition iterator serializable index next index input po weight log prob eventually change because we space efficient feature vector cannot feature vector feature input input feature h m m hmm transition iterator feature input seq input position output h m m hmm hmm hmm input input seq input feature input get index position input position input po input position weight destination length tran index 0 tran index destination length tran index++ output || output equal label tran index weight tran index 0 xxx emission next observation? log emission prob hmm emission multinomial get index log probability input seq get input position d index get destination tran index get index log emission prob hmm emission multinomial d index log probability input seq get input position log transition prob hmm transition multinomial get index log probability destination name tran index weight log probability weight tran index log emission prob + log transition prob na n weight tran index weight tran index m p o l e w e g h t next index 0 next index destination length weight next index m p o l e w e g h t next index++ next next index destination length transducer next next index destination length index next index next index++ next index destination length weight next index m p o l e w e g h t next index++ get destination index get index index contain feature index symbol position input get input input feature get input position input po get output label index get weight weight index transducer get transducer get destination get destination index serialization transition iterator serial u 1 u r r e n t e r l v e r o n 0 n u l l n t e g e r 1 write output stream o write u r r e n t e r l v e r o n write write index write next index write input po weight write weight length 0 weight length i++ write weight write n u l l n t e g e r write input write input feature write hmm read input stream o found read read index read next index read input po read size read size n u l l n t e g e r weight weight size 0 size i++ weight read input feature read input feature read hmm h m m read 