2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e mc callum math statistic functionspublic math libbow dirichlet write tom minka minka stat cmu log gamma y xnum xden d1 5 772156649015328605195174e 1 p1 4 945235359296727046734888e0 2 018112620856775083915565e2 2 290838373831346393026739e3 1 131967205903380828685045e4 2 855724635671635335736389e4 3 848496228443793359990269e4 2 637748787624195437963534e4 7 225813979700288197698961e3 q1 6 748212550303777196073036e1 1 113332393857199323513008e3 7 738757056935398733233834e3 2 763987074403340708898585e4 5 499310206226157329794414e4 6 161122180066002127833352e4 3 635127591501940507276287e4 8 785536302431013170870835e3 d2 4 227843350984671393993777e 1 p2 4 974607845568932035012064e0 5 424138599891070494101986e2 1 550693864978364947665077e4 1 847932904445632425417223e5 1 088204769468828767498470e6 3 338152967987029735917223e6 5 106661678927352456275255e6 3 074109054850539556250927e6 q2 1 830328399370592604055942e2 7 765049321445005871323047e3 1 331903827966074194402448e5 1 136705821321969608938755e6 5 267964117437946917577538e6 1 346701454311101692290052e7 1 782736530353274213975932e7 9 533095591844353613395747e6 d4 1 791759469228055000094023e0 p4 1 474502166059939948905062e4 2 426813369486704502836312e6 1 214755574045093227939592e8 2 663432449630976949898078e9 2 940378956634553899906876e10 1 702665737765398868392998e11 4 926125793377430887588120e11 5 606251856223951465078242e11 q4 2 690530175870899333379843e3 6 393885654300092398984238e5 4 135599930241388052042842e7 1 120872109616147941376570e9 1 488613728678813811542398e10 1 016803586272438228077304e11 3 417476345507377132798597e11 4 463158187419713286462081e11 1 910444077728e 03 8 4171387781295e 04 5 952379913043012e 04 7 93650793500350248e 04 2 777777777777681622553e 03 8 333333333333333331554247e 02 5 7083835261e 03 0 6796875 0 5 || 1 5 0 5 math log test machine epsilon x+1 1 0 0 5 0 5 xnum 0 xden 1 0 8 i++ xnum xnum + p1 xden xden + q1 + d1 + xnum xden || 1 5 4 math log 0 5 0 5 0 2 xnum 0 xden 1 0 8 i++ xnum xnum + p2 xden xden + q2 + d2 + xnum xden 12 4 xnum 0 xden 1 0 8 i++ xnum xnum + p4 xden xden + q4 d4 + xnum xden 12 y math log y 1 y 0 5 + 9189385332046727417803297 1 y xnum 6 0 6 i++ xnum xnum y + xnum + xnum numeric recipe old log gamma j y tmp s cof 76 18009172947146 86 50532032941677 24 01409824083091 1 231739572450155 0 1208650973866179e 2 0 5395239384953e 5 y tmp + 5 5 + 0 5 math log + 5 5 s 1 000000000190015 j 0 j 5 j++ s + cof j ++y math log 2 5066282746310005 s tmp log beta log gamma +log gamma log gamma a+b beta math log beta gamma math log gamma factorial n math log gamma n+1 log factorial n log gamma n+1 compute p n p n p copy classic catherine loader fast accurate computation binomial probability 2001 fast accurate log binom n p log factorial n log factorial log factorial n + math log p + n math log 1 p vastly inefficient o compute cdf n p pbinom n p sum n e g t v e n f n t y 0 i++ sum sum log prob sum log binom n p math sum sigmod beta 1 0 1 0+ math beta sigmod rev sig math log sig 1 sig logit p math log p 1 p combination? num n r math log factorial n log factorial r log factorial n r permutation? num permutation n r math log factorial n log factorial r cosh 0 0 5 math + math 0 5 math + math tanh math math math + math number closer consider equal almost equal e p l o n 0 000001 almost equal d1 d2 almost equal d1 d2 e p l o n almost equal d1 d2 epsilon math ab d1 d2 epsilon almost equal d1 d2 ep 0 d1 length i++ v1 d1 v2 d2 almost equal v1 v2 ep gsc check tt min lt value lt max tt check range value min max value min || almost equal value min e p l o n value max || almost equal value max e p l o n log2 math log 2 gsc k l divergence k p1 || p2 log w r t base 2 p note value tt p2 tt tt 0 0 tt k l divergence tt infinite tt kl divergence p1 p2 p1 length p2 length kl div 0 0 0 p1 length ++i p1 0 p2 0 p o t v e n f n t y kl div + p1 math log p1 p2 kl div log2 move division loop m gsc jensen shannon divergence jensen shannon divergence p1 p2 p1 length p2 length average p1 length 0 p1 length ++i average + p1 + p2 2 kl divergence p1 average + kl divergence p2 average 2 sum two express log space pre sum log prob log e^a + e^b log e^a 1 + e^ + log 1 + e^ pre exponentiat tt tt we better numerical precision we we calculate tt e^a tt tt e^b tt directly p note function just link transducer sum neg log prob sum neg log prob t t transducer t t log aren t negate sum log prob n e g t v e n f n t y n e g t v e n f n t y + math log 1 + math + math log 1 + math below stanford n l p sloppy math l o g t o l e r n e 30 0 sum number log x1 log xn save some unnecessary call math log two argument p note g n o r e element input l o g t o l e r n e currently 30 0 les maximum element p cursory testing me wonder actually much fast repeat 2 argument ca val log x1 log x2 log xn log x1+x2+ +xn sum log prob val max n e g t v e n f n t y len val length maxidx 0 0 len i++ val max max val maxidx intermediate 0 0 cutoff max l o g t o l e r n e 0 maxidx i++ val cutoff intermediate + math val max maxidx + 1 len i++ val cutoff intermediate + math val max max + math log 1 0 + intermediate max difference two express log space pre sum log prob log e^a e^b log e^a 1 e^ + log 1 e^ pre exponentiat tt tt we better numerical precision we we calculate tt e^a tt tt e^b tt directly p tt na n tt log e^a e^b undefin subtract log prob n e g t v e n f n t y + math log 1 math get entropy dist entropy 0 0 dist length i++ dist 0 entropy dist math log dist entropy 