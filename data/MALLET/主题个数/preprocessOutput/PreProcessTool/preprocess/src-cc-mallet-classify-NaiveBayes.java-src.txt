2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e classify io output stream io input stream io serializable io o classify classifier pipe pipe type type multinomial log classifier classifie instance accord naive bayes bayes classifier p classification| p data| classification p classification p p compute likelihood p data| classification p d1 d2 dn | classification naive bayes assumption conditionally independent classification p d1 d2 dn | classification p d1| classification p d2| classification p classifier naive bayes two trainer classifier link classify naive bayes trainer produce estimate variou p dn| classifier contruct estimate p instance assume link type feature vector p classifier classification perform instance process pipe classif ie naive bayes get pipe instance naive bayes trainer set pipe pipe process training instance p naive bayes classifier can persist reuse serialization see naive bayes trainer see feature vector mc callum naive bayes classifier serializable multinomial log prior multinomial log p construct naive bayes classifier pipe prior estimate classification feature estimate classification naive bayes classifier generally generate naive bayes trainer construct directly proability estimate convert save logarithm internally instance pipe check feature vector dictionary instance same pipe suppress check prior mulinomial give estimate prior probability classification index2 feature prob multinomial giving estimate probability classification feature featurevector naive bayes pipe instance pipe multinomial log prior multinomial log index2 feature prob instance pipe prior prior p index2 feature prob multinomial log log multinomial multinomial m multinomial log ml multinomial log m length 0 m length i++ ml multinomial log m ml construct naive bayes classifier pipe prior estimate classification feature estimate classification naive bayes classifier generally generate naive bayes trainer construct directly pipe check feature vector dictionary instance same pipe suppress check prior mulinomial give estimate prior probability classification index2 feature prob multinomial giving estimate probability classification feature featurevector naive bayes pipe pipe multinomial prior multinomial index2 feature prob pipe multinomial log prior log multinomial index2 feature prob multinomial log get multinomial p log get prior prior print word num print alphabet alphabet instance pipe get alphabet num feature alphabet size num label instance pipe get target alphabet size prob num feature num print math min num print num feature 0 num label li++ fill prob 0 0 p add probability prob rank feature vector rfv rank feature vector alphabet prob feature probability +instance pipe get target alphabet lookup 0 num print i++ rfv get rank + +rfv get value rank classify instance naive bayes accord train alphabet feature vector instance match alphabe pipe train classifier instance classified feature vector classification contain label instance classification classify instance instance note current size label alphabet can large training we careful here correctly handle label here we assume log prior probability minus infinity num get label alphabet size score num feature vector fv feature vector instance get sure feature vector feature dictionary match what we expect our pipe thus our notion feature probability instance pipe || fv get alphabet instance pipe get alphabet fvisize fv num location prior add log probability score score accord feature weight probability fvi 0 fvi fvisize fvi++ fi fv index location fvi ci 0 ci num ci++ guard alphabet target alphabet growing can happen classify nev see feature ignore these ci p length || fi p ci size score ci + fv value location fvi p ci log probability fi get score range near zero accurate max score n e g t v e n f n t y ci 0 ci num ci++ score ci max score max score score ci ci 0 ci num ci++ score ci max score exponentiate normalize sum 0 ci 0 ci num ci++ sum + score ci math score ci ci 0 ci num ci++ score ci sum classification classification instance label vector get label alphabet score log probability instance instance label index feature vector fv feature vector instance get fvisize fv num location log prob 0 fvi 0 fvi fvisize fvi++ log prob + fv value location fvi p label index log probability fv index location fvi log prob log likelihood instance ilist log likelihood 0 0 ilist size ii++ instance weight ilist get instance weight instance inst ilist get label label inst get label label log likelihood + instance weight log probability inst label get best index label predict classify inst get label err label +label err predict +predict lpo 0 lpo predict num location lpos++ predict index location lpo label weight predict value location lpo err print +label weight label weight 0 log likelihood + instance weight label weight log probability inst log likelihood label log likelihood instance ilist log likelihood 0 0 ilist size ii++ instance weight ilist get instance weight instance inst ilist get label label inst get label label label predict classify inst get label err label +label err predict +predict label num location 1 log likelihood + instance weight math log predict value label get best index lpo 0 lpo label num location lpos++ label index location lpo label weight label value location lpo err print +label weight label weight 0 log likelihood + instance weight label weight math log predict value log likelihood serialization serial u overriden prevent innocuou making serialization mechanism think external format change serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n write get instance pipe write prior write prior write conditional probability estimate write p read input stream o found read u r r e n t e r l v e r o n found mismatch naive bayes want + u r r e n t e r l v e r o n + get + instance pipe pipe read prior multinomial log read p multinomial log read 