topic random command type io concurrent word embedding command input command word embedding input f l e n m e filename read training instance stdin + instance feature feature bigram feature vector command output command word embedding output f l e n m e weight txt filename write format word vector command num dimension command word embedding num dimension n t e g e r 50 dimension fit command window size command word embedding window size n t e g e r 5 adjacent word consider command num thread command word embedding num thread n t e g e r 1 thread parallel training command num sample command word embedding num sample n t e g e r 5 negative sample training command word command word embedding word t r n g define periodically show close vector word alphabet vocabulary num word num column weight square gradient sum stride word count sampling sampling table sampling table size 100000000 sampling sum 0 0f total word 0 max value 6 0 min value 6 0 sigmoid cache sigmoid cache size 1000 window size 5 query word random random random word embedding word embedding alphabet num column window size vocabulary num word vocabulary size format vocab size %d num word num column num column stride 2 num column weight num word stride square gradient sum num word stride word 0 word num word word++ col 0 col 2 num column col++ weight word stride + col random next 0 5f num column word count num word sampling num word sampling table sampling table size window size window size sigmoid cache sigmoid cache size + 1 0 sigmoid cache size i++ value sigmoid cache size max value min value + min value sigmoid cache 1 0 1 0 + math value count word instance instance instance instance instance feature feature instance get length get length position 0 position length position++ type get index position position word count type ++ total word + length normalizer 1 0f total word sampling 0 math pow normalizer word count 0 0 75 word 1 word num word word++ sampling word sampling word 1 + math pow normalizer word count word 0 75 sampling sum sampling num word 1 word 0 0 sampling table size i++ sampling sum sampling table size sampling word word++ sampling table word counting train instance instance num thread num sample executor service executor executor fix thread pool num thread word embed runnable runnable word embed runnable num thread thread 0 thread num thread thread++ runnable thread word embed runnable instance num sample num thread thread executor submit runnable thread start current milli difference 0 0 finish finish thread sleep 5000 interrupt e word far 0 thread done? thread 0 thread num thread thread++ word far + runnable thread word far format % 3f runnable thread get running milli current milli start format %d %d %fk w %f %f avg word far running milli word far running milli difference 10000 average ab weight difference 0 0 word far 5 total word finish thread 0 thread num thread thread++ runnable thread run query word find close query word executor shutdown now find close target vector sorter sort word sorter num word target square sum 0 0 col 0 col num column col++ target square sum + target vector col target vector col target normalizer 1 0 math sqrt target square sum target square sum word 0 word num word word++ inner 0 0 word square sum 0 0 col 0 col num column col++ word square sum + weight word stride + col weight word stride + col word normalizer 1 0 math sqrt word square sum col 0 col num column col++ inner + target normalizer target vector col word normalizer weight word stride + col sort word word sorter word inner sort sort word 0 10 i++ format %f %d % sort word get weight sort word get vocabulary lookup sort word get average ab weight sum 0 0 word 0 word num word word++ col 0 col num column col++ sum + math ab weight word stride + col sum num word num column write print writer word 0 word num word word++ formatt buffer formatt buffer format % vocabulary lookup word col 0 col num column col++ buffer format % 6f weight word stride + col buffer word vocabulary lookup index word word num column col 0 col num column col++ col weight word stride + col add word add vocabulary lookup index word add word col 0 col num column col++ col + weight word stride + col subtract word subtract vocabulary lookup index word subtract word col 0 col num column col++ col weight word stride + col process command line option command summary word embedding train continuou word embedding skip gram negative sampling command process word embedding instance instance instance load input value word embedding matrix word embedding instance get alphabet num dimension value window size value matrix query word word value matrix count word instance matrix train instance num thread value num sample value print writer print writer output value matrix write close 