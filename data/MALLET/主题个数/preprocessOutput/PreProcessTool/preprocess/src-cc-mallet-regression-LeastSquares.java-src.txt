regression io format type optimize m v normal stat function least square linear regression regression instance training residual square 0 0 sum square sum square model degree freedom format formatt precision index intercept index dimension transpose inverse least square instance 0 0 least square instance regularization training regression linear regression training get alphabet regression get intercept index length 2 precision index length 1 residual training size formatt format get instance formatt maximum fraction digit 8 we re concern precision variable dimension length 1 transpose dimension dimension transpose y dimension y 0 0 instance instance feature vector predictor feature vector instance get y instance get target value y + y 0 predictor num location i++ index1 predictor index location value1 predictor value location j 0 j predictor num location j++ index2 predictor index location j value2 predictor value location j transpose dimension index1 + index2 + value1 value2 handle off diagonal intercept transpose dimension index1 + intercept index + value1 transpose dimension intercept index + index1 + value1 now y transpose y index1 + value1 y intercept term count instance transpose dimension intercept index + intercept index ++ transpose y intercept index + y l2 regularize regression aka ridge regression regularization 0 0 0 dimension d++ transpose dimension + + regularization y size transpose inverse m v normal invert p transpose dimension over n square 1 0 size size now multiply matrix x^ 1 vector y index1 0 index1 dimension index1++ index2 0 index2 dimension index2++ index1 + transpose inverse index1 dimension + index2 transpose y index2 compute residual square sum square 0 0 sum square model 0 0 degree freedom training size dimension 0 training size i++ instance instance training get prediction regression predict instance y instance get target value residual y prediction sum square + residual residual sum square model + y prediction y prediction square sum square degree freedom p value value dimension index 0 index dimension index++ standard math sqrt square transpose inverse dimension index + index value index 2 1 0 stat function pt math ab index standard degree freedom value print summary regression similar summary lm r print summary standard t percentile std err t value pr |t| print print formatt format intercept index + standard math sqrt square transpose inverse dimension intercept index + intercept index print formatt format standard + print formatt format intercept index standard + t percentile 2 1 0 stat function pt math ab intercept index standard degree freedom formatt format t percentile + + significance star t percentile index 0 index dimension 1 index++ print training get alphabet lookup index + print formatt format index + standard math sqrt square transpose inverse dimension index + index print formatt format standard + print formatt format index standard + t percentile 2 1 0 stat function pt math ab index standard degree freedom formatt format t percentile + + significance star t percentile e + formatt format sum square + f + degree freedom r^2 + formatt format sum square model sum square + sum square model significance star p p 0 001 p 0 01 p 0 05 p 0 1 get num length get parameter get buffer 0 length i++ buffer linear regression get regression regression instance instance load 0 least square l length 1 l least square parse 1 l least square l print summary 