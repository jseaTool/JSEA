2010 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e semi supervise constraint gnu trove t gnu trove t hash map bit hash map sum lattice semi supervise label map type feature vector type feature vector type instance type instance constraint individual input feature label pair g e penaliz l 2^2 difference between model target distribution multiple constraint group together here thing efficient gregory druck label l2 range g e constraint g e constraint map between input feature index constraint t hash map label l2 ind g e constraint constraint label map map cache constrain feature fire last feature vector preproces call t cache label l2 range g e constraint constraint t hash map label l2 ind g e constraint cache t label l2 range g e constraint t hash map label l2 ind g e constraint constraint label map map constraint constraint map map cache t add constraint fi lower upper weight constraint contain key fi constraint put fi label l2 ind g e constraint constraint get fi add lower upper weight constraint label map label map map map map pre process feature vector fv cache reset quick fi cache constrain input feature loc 0 loc fv num location loc++ fi fv index location loc constraint contain key fi cache add fi constraint contain key fv get alphabet size cache add fv get alphabet size find example contain constrain input feature bit pre process instance count 0 fi feature vector fv bit bit bit size instance instance feature vector fv feature vector instance get ip 0 ip fv size ip++ fv fv get ip loc 0 loc fv num location loc++ fi fv index location loc constraint contain key fi constraint get fi count + 1 bit constraint contain key fv get alphabet size bit constraint get fv get alphabet size count + 1 ii++ bit get composite constraint feature value feature vector fv ip si1 si2 value 0 li2 map get label index si2 0 cache size i++ value + constraint get cache get quick get gradient li2 value get value value 0 0 fi constraint key label l2 ind g e constraint constraint constraint get fi constraint count 0 0 value due current constraint label index 0 label index map get num label ++label index value constraint get value label index na n value infinite value value zero expectation fi constraint key constraint get fi expectation constraint get fi get num constrain label compute expectation sum lattice lattice gamma t cache t 0 lattice size i++ lattice get sum lattice lattice lattice get feature vector fv feature vector lattice get input gamma lattice get gamma ip 0 ip fv size ++ip cache reset quick feature vector fv fv get feature vector ip fi loc 0 loc fv num location loc++ fi fv index location loc binary constraint feature constraint contain key fi cache add fi constraint contain key fv get alphabet size cache add fv get alphabet size 0 map get num ++ map get label index label map t r t l e l gamma prob math gamma ip+1 j 0 j cache size j++ constraint get cache get quick j increment expectation gamma prob g e constraint label l2 range g e constraint constraint map label l2 ind g e constraint index count lower upper weight hash map label map expectation label l2 ind g e constraint lower upper weight label map hash map index 0 count 0 add label lower upper weight lower add lower upper add upper weight add weight label map put label index index++ increment expectation value label map contain key label map get expectation + value get value label map contain key label map get count 0 ex expectation count ex lower get weight get math pow lower get ex 2 ex upper get weight get math pow upper get ex 2 0 get num constrain label index get gradient label map contain key label map get count 0 ex expectation count ex lower get 2 weight get lower get count expectation count count ex upper get 2 weight get upper get count expectation count count 0 