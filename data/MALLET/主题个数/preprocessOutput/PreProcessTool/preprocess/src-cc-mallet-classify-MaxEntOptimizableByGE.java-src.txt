2011 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e classify logging logger classify constraint ge max ent g e constraint optimize optimizable type feature vector type instance type instance type matrix ops progress message logger training max ent model label feature generalize expectation criterion learning label feature generalize expectation criterion gregory druck gideon mann mc callum g r 2008 gregory druck gdruck gdruck gdruck max ent optimizable g e optimizable gradient value logger progress logger progress message logger get logger max ent optimizable g e get name + pl cache stale feature index temperature obj weight cache value gaussian prior variance cache gradient instance training max ent classifier max ent g e constraint constraint training unlabel training instance constraint feature expectation constraint init classifier classifier max ent optimizable g e instance training max ent g e constraint constraint max ent init classifier temperature 1 0 obj weight 1 0 gaussian prior variance 1 0 training training num feature training get alphabet size feature index num feature num label training get target alphabet size cache gradient num feature + 1 num label cache value 0 init classifier init classifier classifier init classifier num feature + 1 num label classifier max ent training get pipe constraint constraint max ent g e constraint constraint constraint constraint pre process training set variance gaussian prior equivalently inverse weight l2 regularization term variance gaussian prior variance gaussian prior variance variance gaussian prior variance variance model probability raise power 1 temperature renormalize temperature decrease model probability approach 1 maximum probability 0 e f u l t 1 temp temperature temperature temp temperature temp weight g e term objective function weight g e term weight weight weight obj weight weight max ent get classifier classifier get value cache stale cache value obj weight 0 0 0 max ent g e constraint constraint constraint constraint zero expectation fill cache gradient 0 num feature training get alphabet size + 1 num label training get target alphabet size score training size num label constraint value num label pas 1 calculate model 0 training size ii++ instance instance training get instance weight training get instance weight instance skip label instance get target feature vector fv feature vector instance get classifier get classification score temperature instance temperature score max ent g e constraint constraint constraint constraint compute expectation fv score instance weight compute value value 0 max ent g e constraint constraint constraint value + constraint get value value obj weight pas 2 determine gradient 0 training size ii++ instance instance training get skip label instance get target fill constraint value 0 instance expectation 0 instance weight training get instance weight instance feature vector fv feature vector instance get max ent g e constraint constraint constraint constraint pre process fv label 0 label num label label++ val constraint get composite constraint feature value fv label constraint value label + val instance expectation + val score label label 0 label num label label++ score label 0 infinite score label weight obj weight instance weight score label constraint value label instance expectation temperature na n weight matrix ops row plus equal cache gradient num feature label fv weight cache gradient num feature label + feature index + weight cache value value cache stale reg get regularization progress logger info value g e + value + gaussian prior + reg + + cache value cache value get regularization regularization 0 pi 0 pi length pi++ p pi regularization p p 2 gaussian prior variance cache gradient pi p gaussian prior variance cache value + regularization regularization get value gradient buffer cache stale get value buffer length cache gradient length arraycopy cache gradient 0 buffer 0 buffer length get num length get parameter index index get buffer buffer length length arraycopy 0 buffer 0 buffer length parameter index value cache stale index value length length cache stale arraycopy 0 0 length 