topic value gradient function dirichlet multinomial regression see guimarae lindrooth introduction m r mimno mc callum u 2008 application multinomial mixture model optimize optimizable classify max ent type instance type instance type alphabet type feature vector type dirichlet type matrix ops logger progress message logger logging format decimal format gnu trove t hash map m r optimizable optimizable gradient value logger logger logger get logger m r optimizable get name logger progress logger progress message logger get logger m r optimizable get name + pl max ent classifier instance training num get value call 0 num get value gradient call 0 num iteration m v l u e format formatt e f u l t g u n p r o r v r n e 1 e f u l t l r g e g u n p r o r v r n e 100 e f u l t g u n p r o r m e n 0 0 gaussian prior e f u l t g u n p r o r m e n gaussian prior variance e f u l t g u n p r o r v r n e allow feature base level fluctuate freely feature much better result feature gaussian prior variance e f u l t l r g e g u n p r o r v r n e cache gradient cache value cache value stale cache gradient stale num label num feature feature index m r optimizable m r optimizable instance instance max ent classifier training instance alphabet alphabet instance get alphabet alphabet label alphabet instance get target alphabet num label label alphabet size add feature feature num feature alphabet size + 1 add spot intercept term num feature + num feature + num label + num label feature index num feature 1 num label num feature constraint num label num feature cache gradient num label num feature classifier classifier classifier classifier get feature index classifier get feature index classifier get instance pipe instance get pipe classifier classifier max ent instance get pipe formatt decimal format 0 e0 cache value stale cache gradient stale initialize constraint logger fine instance training + training size instance instance training feature vector multinomial value feature vector instance get target multinomial value feature vector feature feature vector instance get feature get alphabet alphabet na n 0 feature num location i++ na n feature value location logger info na n feature + alphabet lookup feature index location na n na n logger info na n instance + instance get name test maximizable test value gradient current variance feature aka intercept generally large variance regular feature intercept gaussian prior variance sigma square feature gaussian prior variance sigma square variance regular feature generally small variance feature regular gaussian prior variance sigma square gaussian prior variance sigma square max ent get classifier classifier get parameter index index parameter index v cache value stale cache gradient stale index v get num length get buff buff || buff length length buff length arraycopy 0 buff 0 length buff buff cache value stale cache gradient stale buff length length buff length arraycopy buff 0 0 buff length log probability observe count vector feature get value cache value stale cache value num get value calls++ cache value 0 incorporate likelihood score training get target alphabet size value 0 0 instance index 0 instance instance training feature vector multinomial value feature vector instance get target multinomial value l now +input alphabet size + regular feature get predict probability current model classifier get unnormaliz classification score instance score sum score 0 0 exponentiate score 0 score length i++ due underflow very likely some these score 0 0 score math score sum score + score feature vector feature feature vector instance get really since feature vector define casting total length 0 0 multinomial value num location i++ label multinomial value index location count multinomial value value location value + dirichlet log gamma stirl score label + count dirichlet log gamma stirl score label total length + count value dirichlet log gamma stirl sum score + total length dirichlet log gamma stirl sum score check na n value logger fine m max ent trainer instance + instance get name + na n value label multinomial value get index logger fine log score + math log score label + score + score label infinite value logger warning instance + instance get + infinite value skip value gradient cache value value cache value stale value value cache value + value instance index++ incorporate prior prior 0 log gaussian prior x^2 2sigma^2 label 0 label num label label++ feature 0 feature num feature 1 feature++ label num feature + feature prior gaussian prior gaussian prior 2 gaussian prior variance label num feature + feature index prior gaussian prior gaussian prior 2 feature gaussian prior variance label probability cache value cache value + prior cache value stale progress logger info value likelihood + formatt format label probability + prior + formatt format prior + + formatt format cache value cache value get value gradient buffer matrix ops cache gradient 0 0 incorporate likelihood score training get target alphabet size instance index 0 instance instance training feature vector multinomial value feature vector instance get target multinomial value get predict probability current model classifier get unnormaliz classification score instance score sum score 0 0 exponentiate score 0 score length i++ due underflow very likely some these score 0 0 score math score sum score + score feature vector feature feature vector instance get total length 0 count multinomial value get value total length + count digamma difference sum dirichlet digamma sum score + total length dirichlet digamma sum score loc 0 loc feature num location loc++ index feature index location loc value feature value location loc value 0 0 feature vector there easy say you know about id? ve into two loop label just zero one label 0 label num label label++ cache gradient label num feature + index value score label digamma difference sum label loc 0 label loc multinomial value num location label loc++ label multinomial value index location label loc count multinomial value value location label loc diff 0 0 count 20 0 count i++ diff + 1 score label + diff dirichlet digamma score label + count dirichlet digamma score label cache gradient label num feature + index + value score label diff now add feature label 0 label num label label++ cache gradient label num feature + feature index score label digamma difference sum label loc 0 label loc multinomial value num location label loc++ label multinomial value index location label loc count multinomial value value location label loc diff 0 0 count 20 0 count i++ diff + 1 score label + diff dirichlet digamma score label + count dirichlet digamma score label cache gradient label num feature + feature index + score label diff num get value gradient calls++ label 0 label num label label++ feature 0 feature num feature 1 feature++ label num feature + feature cache gradient label num feature + feature gaussian prior gaussian prior variance label num feature + feature index cache gradient label num feature + feature index gaussian prior feature gaussian prior variance parameter infinity external user we gradient 0 because parameter value can nev change anyway mess up future calculation matrix norm matrix ops substitute cache gradient n e g t v e n f n t y 0 0 buffer buffer length length arraycopy cache gradient 0 buffer 0 cache gradient length m max ent trainer gradient infinity norm + matrix ops infinity norm cache gradient 