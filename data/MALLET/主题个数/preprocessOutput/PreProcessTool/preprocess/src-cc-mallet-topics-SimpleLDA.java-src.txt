2005 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e topic logging zip io format topic type simple latent dirichlet allocation gibbs sampling slow regular l provide better starting place understanding sampling building topic model david mimno mc callum simple l serializable logger logger logger get logger simple l get name training instance topic assignment topic assignment alphabet input alphabet alphabet alphabet topic label alphabet topic alphabet topic request num topic size vocabulary num type prior alpha dirichlet alpha alpha over topic alpha sum beta prior topic multinomial over word beta sum e f u l t e t 0 01 put topic count current document initialize locally below define here garbage collection overhead doc topic count index document index topic index statistic sampling type topic count index feature index topic index topic index topic index show topic interval 50 word topic 10 random random format formatt print log likelihood simple l topic topic topic e f u l t e t simple l topic alpha sum beta topic alpha sum beta random label alphabet label alphabet num topic label alphabet ret label alphabet 0 num topic i++ ret lookup index topic +i ret simple l topic alpha sum beta random random label alphabet topic alpha sum beta random simple l label alphabet topic alphabet alpha sum beta random random topic assignment topic alphabet topic alphabet num topic topic alphabet size alpha sum alpha sum alpha alpha sum num topic beta beta random random doc topic count num topic topic num topic formatt format get instance formatt maximum fraction digit 5 logger info simple l + num topic + topic alphabet get alphabet alphabet label alphabet get topic alphabet topic alphabet get num topic num topic topic assignment get topic interval n show topic interval interval word topic n random seed seed random random seed get type topic count type topic count get topic total topic add instance instance training alphabet training get alphabet num type alphabet size beta sum beta num type type topic count num type num topic doc 0 instance instance training doc++ feature feature instance get label topic label topic alphabet size topic topic get feature position 0 position size position++ topic random next num topic topic position topic topic topic ++ type get index position position type topic count type topic ++ topic assignment t topic assignment instance topic add t sample iteration o iteration 1 iteration iteration iteration++ iteration start current milli loop over document corpus doc 0 doc size doc++ feature feature get doc instance get label topic label get doc topic sample topic doc topic elapse milli current milli iteration start logger fine iteration + + elapse milli + m occasionally print information show topic interval 0 iteration % show topic interval 0 logger info + iteration + log likelihood + model log likelihood + + top word word topic sample topic doc feature feature topic doc topic topic get feature current type topic count type old topic topic topic weight sum doc length get length local topic count num topic populate topic count position 0 position doc length position++ local topic count doc topic position ++ score sum topic term score num topic iterate over position word document position 0 position doc length position++ type get index position position old topic doc topic position grab relevant row our two dimensional current type topic count type topic count type count local topic count old topic topic old topic topic old topic 0 old topic + old topic + below 0 current type topic count old topic now calculate add up score topic word sum 0 0 here math happen note overall dominate what you loop topic 0 topic num topic topic++ score alpha + local topic count topic beta + current type topic count topic beta sum + topic topic sum + score topic term score topic score random point between 0 sum topic score sample random next uniform sum figure topic contain point topic 1 sample 0 0 topic++ sample topic term score topic sure we actually sample topic topic 1 illegal simple l topic sample put topic into count doc topic position topic local topic count topic ++ topic topic ++ current type topic count topic ++ model log likelihood log likelihood 0 0 likelihood model dirichlet multinomial word topic dirichlet multinomial topic document likelihood function dirichlet multinomial gamma sum alpha prod gamma alpha + n prod gamma alpha gamma sum alpha + n log likelihood log gamma sum alpha log gamma sum alpha + n + sum log gamma alpha + n log gamma alpha document first topic count num topic topic log gamma num topic doc topic topic 0 topic num topic topic++ topic log gamma topic dirichlet log gamma alpha doc 0 doc size doc++ label topic label get doc topic doc topic topic get feature 0 doc topic length token++ topic count doc topic ++ topic 0 topic num topic topic++ topic count topic 0 log likelihood + dirichlet log gamma alpha + topic count topic topic log gamma topic subtract count + parameter sum term log likelihood dirichlet log gamma alpha sum + doc topic length fill topic count 0 add parameter sum term log likelihood + size dirichlet log gamma alpha sum topic log gamma beta dirichlet log gamma beta type 0 type num type type++ reuse pointer topic count type topic count type topic 0 topic num topic topic++ topic count topic 0 log likelihood + dirichlet log gamma beta + topic count topic log gamma beta na n log likelihood topic count topic exit 1 topic 0 topic num topic topic++ log likelihood dirichlet log gamma beta num type + topic topic na n log likelihood topic + topic + + topic topic exit 1 log likelihood + num topic dirichlet log gamma beta num type na n log likelihood exit 1 log likelihood display saving result top word num word builder output builder sorter sort word sorter num type topic 0 topic num topic topic++ type 0 type num type type++ sort word type sorter type type topic count type topic sort sort word output append topic + + topic topic + 0 num word i++ output append alphabet lookup sort word get + output append output filename print threshold print topic proportion great max print many topic print document topic threshold max o print writer print writer print doc topic proportion doc len topic count num topic sorter sort topic sorter num topic topic 0 topic num topic topic++ initialize sorter dummy value sort topic topic sorter topic topic max 0 || max num topic max num topic doc 0 doc size doc++ label topic label get doc topic current doc topic topic get feature print doc print get doc instance get print get doc instance get print print doc len current doc topic length count up 0 doc len token++ topic count current doc topic ++ normalize topic 0 topic num topic topic++ sort topic topic topic topic count topic doc len sort sort topic 0 max i++ sort topic get weight threshold print sort topic get + + sort topic get weight + print fill topic count 0 print f o print stream print stream g z p output stream buffer output stream output stream f print close print print stream doc po typeindex type topic doc 0 doc size doc++ feature feature get doc instance get label topic label get doc topic n get doc instance get get doc instance get position 0 position topic get length position++ type get index position position topic topic get index position position print doc print print print print position print print type print print alphabet lookup type print print topic serialization serial u 1 u r r e n t e r l v e r o n 0 n u l l n t e g e r 1 write f output stream oo output stream output stream f oo write oo close o e err + f + + e write output stream o write u r r e n t e r l v e r o n instance list write write alphabet write topic alphabet write num topic write alpha write beta write beta sum write show topic interval write word topic write random write formatt write print log likelihood write type topic count ti 0 ti num topic ti++ write topic ti read input stream o found feature length read topic assignment read alphabet alphabet read topic alphabet label alphabet read num topic read alpha read alpha sum alpha num topic beta read beta sum read show topic interval read word topic read random random read formatt format read print log likelihood read num doc size num type alphabet size type topic count read topic num topic ti 0 ti num topic ti++ topic ti read o instance training instance load 0 num topic length 1 ? parse 1 200 simple l lda simple l num topic 50 0 0 01 lda add instance training lda sample 1000 