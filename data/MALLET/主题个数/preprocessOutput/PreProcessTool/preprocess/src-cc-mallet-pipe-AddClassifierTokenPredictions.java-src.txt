2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e pipe io o io input stream io output stream io serializable hash map logging logger classify balance winnow trainer classify classification classify classifier classify classifier trainer classify type alphabet type augmentable feature vector type feature vector type feature vector type instance type instance type label type label type label vector type label logger pipe us classifier label e 0 th markov assumption add prediction feature pipe input instance type feature vector augmentable feature vector usage pre 1 serialize feature pipe convert raw input feature vector sequence 2 pipe input feature pipe train classifier via validation serialize classifier 2 pipe input feature pipe pipe save classifier train transducer 4 serialize train transducer pre ghuang add classifier prediction pipe serializable logger logger logger get logger add classifier prediction get name specify prediction feature e g 1 2 add label top 2 high scoring prediction feature m pr ranks2add train classifier classifier m classifier treat instance feature value binary m binary pipe currently being production e being pipeline training transducer m production augment alphabet prediction alphabet m alphabet add classifier prediction instance train train add classifier prediction instance train instance test classifier convert train noop train get pipe 1 convert test noop train get pipe add classifier prediction classifier classifier pr ranks2add binary instance test m pr ranks2add pr ranks2add m binary binary m classifier classifier m production m alphabet alphabet classifier get alphabet clone alphabet label alphabet classifier get label alphabet add prediction feature alphabet 0 m pr ranks2add length i++ j 0 j label alphabet size j++ feat name t o k p r e + label alphabet lookup j + r n k + m pr ranks2add m alphabet lookup index feat name evaluate classifier test m classifier test logger info classifier accuracy test + get accuracy production production m production production get production m production production pipe p value p add classifier prediction add classifier prediction p production value p serial pipe serial pipe sp serial pipe p 0 sp size i++ production sp get pipe value alphabet get alphabet m alphabet add classifier prediction feature instance input instance contain feature vector instance pipe instance carrier feature vector fv feature vector carrier get instance ilist convert carrier noop m classifier get instance pipe fv size ilist size passing instance classifier instance alphabet need match classifier training pip instance instance alphabet need contain classifier prediction feature feature vector fva feature vector fv size 0 ilist size i++ instance inst ilist get classification m classifier classify inst m production label vector lv get label vector augmentable feature vector afv1 augmentable feature vector inst get index afv1 get index augmentable feature vector afv2 augmentable feature vector m alphabet index afv1 get value index length + m pr ranks2add length j 0 j m pr ranks2add length j++ label label lv get label rank m pr ranks2add j idx m alphabet lookup index t o k p r e + label + r n k + m pr ranks2add j idx 0 afv2 add idx 1 fva afv2 carrier feature vector fva carrier convert instance contain feature vector multiple instance contain augmentable feature vector ilist instance feature vector alphabet pipe noop pipe contain target alphabet instance instance instance contain augmentable feature vector instance convert instance ilist noop alphabet pipe ilist monstrosity classifier target alphabet via pipe instance ret instance alphabet pipe instance inst ilist ret add inst 0 ilist size i++ ret add convert ilist get alphabet pipe ret inst input instance feature vector alphabet pipe noop pipe contain target alphabet instance augmentable feature vector instance augmentable feature vector instance convert instance inst noop alphabet pipe instance ret instance alphabet pipe obj inst get obj feature vector feature vector fv feature vector obj label l label inst get target fv size l size inst name inst get name ? n o n m e inst get name j 0 j fv size j++ feature vector fv fv get feature vector j index fv get index feature vector augmentable feature vector alphabet pipe get alphabet index fv get value index length label target l get label position j name inst name + p o + j + 1 inst get instance add alphabet pipe pipe instance target name ret add add ret serialization serial u 1 inner train classifier ghuang classifier classifier serializable fold validation training m num v random seed split training validation m rand seed trainer classifier classifier trainer m trainer classifier train entirety training classifier m classifier table store instance name fold classifier prevent overfitt classifier prediction hash map m table train classifier instance 5 fold validation train training instance classifier instance train train 0 5 classifier instance train rand seed num v ada boost m2 trainer decision tree trainer 2 10 train rand seed num v naive bayes trainer train rand seed num v balance winnow trainer train rand seed num v v m trainer train rand seed num v classifier classifier trainer trainer instance train rand seed num v train get pipe m trainer trainer m rand seed rand seed m num v num v m table hash map training train train classifier training instance train train classifier entire training logger info training classifier entire size + train size + m classifier m trainer train train t m classifier train logger info training accuracy + t get accuracy m num v 0 train classifier validation instance validation iterator cv it train validation iterator m num v m rand seed f 1 cv it next f++ instance fold cv it next split logger info training classifier cv fold + f + + m num v + size + fold 0 size + classifier fold classifier m trainer train fold 0 t1 fold classifier fold 0 t2 fold classifier fold 1 logger info fold accuracy + t1 get accuracy logger info fold accuracy + t2 get accuracy 0 t2 size x++ logger info xxx pr + t2 get classification get label get best label + + t2 get classification get instance get label 0 fold 1 size i++ instance inst fold 1 get m table put inst get name fold classifier classification classify instance instance classify instance instance instance classify fold check instance name fold classifier instance name match training classifier output classification classify instance instance fold inst name instance get name fold || m table contain key inst name m classifier classify instance classifier classifier classifier m table get inst name classifier classify instance serialization serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n write get instance pipe write m num v write m rand seed write m table write m classifier write m trainer read input stream o found read u r r e n t e r l v e r o n found mismatch classifier want + u r r e n t e r l v e r o n + get + instance pipe pipe read m num v read m rand seed read m table hash map read m classifier classifier read m trainer classifier trainer read 