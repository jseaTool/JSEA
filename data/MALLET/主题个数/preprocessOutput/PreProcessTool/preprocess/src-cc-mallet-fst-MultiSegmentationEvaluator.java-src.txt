2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e evaluate segmentation f1 several different tag mark o format tag p e r o n p e r o n o l o t o n l o t o n o mc callum io print stream logging logger decimal format type feature vector type instance type instance type type logger evaluate transducer model compute precision recall f1 score consider segment span acros multiple multi segmentation evaluator transducer evaluator logger logger logger get logger segmentation evaluator get name equal call these determine start continuation segment tag equal these part segment segment start tag segment tag segment start tag multi segmentation evaluator instance instance list instance description segment start tag segment tag instance list instance description segment start tag segment start tag segment tag segment tag segment start tag length segment tag length multi segmentation evaluator instance instance list1 description1 segment start tag segment tag instance instance list1 description1 segment start tag segment tag multi segmentation evaluator instance instance list1 description1 instance instance list2 description2 segment start tag segment tag instance instance list1 instance list2 description1 description2 segment start tag segment tag multi segmentation evaluator instance instance list1 description1 instance instance list2 description2 instance instance list3 description3 segment start tag segment tag instance instance list1 instance list2 instance list3 description1 description2 description3 segment start tag segment tag evaluate instance transducer trainer tt instance description transducer model tt get transducer num correct total num segment num predict segment num correct segment index segment start tag length num segment index+1 num predict segment index+1 num correct segment index+1 total num correct 0 n 0 n num segment length n++ num segment n num predict segment n num correct segment n 0 0 size i++ instance instance get input instance get instance get instance get output instance get target input size output size pr output model transduce input pr output size output size start pr start 1 start index into segment start tag j 0 j output size j++ total tokens++ output get j equal pr output get j num correct tokens++ start pr start 1 count segment start n 0 n segment start tag length n++ segment start tag n equal output get j num segment n ++ num segment index ++ start n count predict segment start n 0 n segment start tag length n++ segment start tag n equal pr output get j num predict segment n ++ num predict segment index ++ pr start n start 1 start pr start truth prediction both agree same segment tag type starting now m pr m j+1 m output size m++ segment tag pr start equal output get m pr segment tag pr start equal pr output get m || pr pr they agree about segment ending somehow num correct segment pr start ++ num correct segment index ++ m output size pr num correct segment pr start ++ num correct segment index ++ decimal format f decimal format 0 logger info description + tokenaccuracy +f format num correct total n 0 n num correct segment length n++ logger info n index ? segment start tag n o v e r l l + precision num predict segment n 0 ? 1 num correct segment n num predict segment n recall num segment n 0 ? 1 num correct segment n num segment n f1 recall+precision 0 0 ? 0 0 2 0 recall precision recall + precision logger info +description+ segment +num segment n + pr +num predict segment n + correct +num correct segment n + miss + num segment n num correct segment n + alarm + num predict segment n num correct segment n logger info +description+ precision +f format precision + recall +f format recall + f1 +f format f1 incorrect segment pr output output truth pr output predict incorrect segment num incorrect segment output pr output num correct total num segment num predict segment num correct segment index segment start tag length num segment index+1 num predict segment index+1 num correct segment index+1 total num correct 0 n 0 n num segment length n++ num segment n num predict segment n num correct segment n 0 pr output size output size 1 start index into segment start tag start pr start j 0 j output size j++ total tokens++ output get j equal pr output get j num correct tokens++ start pr start 1 count segment start n 0 n segment start tag length n++ segment start tag n equal output get j num segment n ++ num segment index ++ start n count predict segment start n 0 n segment start tag length n++ segment start tag n equal pr output get j num predict segment n ++ num predict segment index ++ pr start n start 1 start pr start truth prediction both agree same segment tag type starting now m pr m j+1 m output size m++ segment tag pr start equal output get m pr segment tag pr start equal pr output get m || pr pr they agree about segment ending somehow num correct segment pr start ++ num correct segment index ++ m output size pr num correct segment pr start ++ num correct segment index ++ wrong 0 n 0 n num correct segment length n++ incorrect segment po neg wrong + num segment n num correct segment n wrong test segmentation predict sequence instead link transducer predict t stat useful analysis instance segment predict sequence prediction description description viterbi output stream print viterbi path batch test instance predict sequence description print stream viterbi output stream num correct total num segment num predict segment num correct segment index segment start tag length num segment index+1 num predict segment index+1 num correct segment index+1 total num correct 0 n 0 n num segment length n++ num segment n num predict segment n num correct segment n 0 0 size i++ viterbi output stream viterbi output stream viterbi path +description+ instance +i instance instance get input instance get instance get instance get output instance get target input size output size pr output predict sequence get pr output skip instance pr output size output size start pr start 1 start index into segment start tag j 0 j output size j++ total tokens++ output get j equal pr output get j num correct tokens++ start pr start 1 count segment start n 0 n segment start tag length n++ segment start tag n equal output get j num segment n ++ num segment index ++ start n count predict segment start n 0 n segment start tag length n++ segment start tag n equal pr output get j num predict segment n ++ num predict segment index ++ pr start n start 1 start pr start truth prediction both agree same segment tag type starting now m pr m j+1 m output size m++ segment tag pr start equal output get m pr segment tag pr start equal pr output get m || pr pr they agree about segment ending somehow num correct segment pr start ++ num correct segment index ++ m output size pr num correct segment pr start ++ num correct segment index ++ viterbi output stream feature vector fv feature vector input get j viterbi output stream j + +true output get j + +pr output get j + + fv viterbi output stream print get j get + viterbi output stream output get j + +pr output get j + + fv decimal format f decimal format 0 logger info description + tokenaccuracy +f format num correct total n 0 n num correct segment length n++ logger info n index ? segment start tag n o v e r l l + precision num predict segment n 0 ? 1 num correct segment n num predict segment n recall num segment n 0 ? 1 num correct segment n num segment n f1 recall+precision 0 0 ? 0 0 2 0 recall precision recall + precision logger info segment +num segment n + pr +num predict segment n + correct +num correct segment n + miss + num segment n num correct segment n + alarm + num predict segment n num correct segment n logger info precision +f format precision + recall +f format recall + f1 +f format f1 