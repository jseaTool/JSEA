2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e gain obtain add feature exponential model della pietra della pietra lafferty 1997 what smooth p q we t get zero zero alpha na n klgain ? think put prior over into g q \alpha g now m simply little m estimate smooth p q note we math log log base 2 unit bit mc callum type logging classify classification logger k l gain rank feature vector logger logger logger get logger k l gain get name k l gain feature f define max ent type feature+clas feature f f f k l gain feature f g f k l p ||q k l p ||q f p empirical accord label q imperfect classifier q f imperfect classifier f f weight adjust none weight adjust k l gain feature f g f sum g f calc k l gain instance ilist label vector classification num instance ilist size num ilist get target alphabet size num feature ilist get alphabet size ilist size 0 notation della pietra lafferty 1997 p 4 p p num num feature q q num num feature alpha weight feature alpha num num feature flv feature location value fli feature location index logger info starting klgain instance +num instance label weight sum 0 model label weight sum 0 actually pretty lame smooth ghost count smooth num expectation smooth ? num instances+1 0 num instance attempt some add hoc smooth +1 0 line smooth smooth 0 num i++ j 0 j num feature j++ p j q j 1 0 num expectation num feature num label weight sum + p j model label weight sum + q j 0 num instance i++ classification get label alphabet ilist get target alphabet instance inst ilist get label label inst get label feature vector fv feature vector inst get instance weight ilist get instance weight below relie label weight sum 1 over label 0 num li++ label weight label value num expectation model label weight classification value num expectation label weight sum + label weight model label weight sum + model label weight 500 +i+ +li+ +true label weight+ model +model label weight label weight 0 model label weight 0 fl 0 fl fv num location fl++ fli fv index location fl fv value location fl 1 0 p fli + label weight instance weight num instances+1 q fli + model label weight instance weight num instances+1 p fli + label weight q fli + model label weight math ab label weight sum 1 0 0 001 label weight sum 1 0 +true label weight sum math ab model label weight sum 1 0 0 001 model label weight sum 1 0 +model label weight sum psum 0 qsum 0 0 num i++ j 0 j num feature j++ psum + p j qsum + q j math ab psum 1 0 0 0001 psum 1 0 psum +psum+ qsum +qsum math ab qsum 1 0 0 0001 qsum 1 0 psum +psum+ qsum +qsum 0 num i++ j 0 j num feature j++ alpha j math log p j 1 0 q j q j 1 0 p j q q e^ \alpha g p 4 calculate qeag qeag num num feature model label weight sum 0 0 ilist size i++ classification get label alphabet ilist get target alphabet instance inst ilist get label label inst get label feature vector fv feature vector inst get fv max location fv num location 1 0 num li++ q \omega classification value num instance model label weight classification value num instance model label weight sum + model label weight line now outside loop over instance fi 0 fi num feature fi++ qeag fi + model label weight 1 0 fl 0 fl fv num location fl++ fli fv index location fl qeag fli + model label weight math alpha fli model label weight 0 num li++ fi 0 fi num feature fi++ assume feature fi occur fv thus value 0 alpha 0 1 0 factoring possible because feature value 1 0 qeag fi + model label weight sum 1 0 calculate klgain value klgain num feature 0 num i++ j 0 j num feature j++ alpha j 0 infinite alpha j klgain j + alpha j p j math log qeag j klgain j + math ab alpha j p j klgain j + math ab alpha j logger info klgain length +klgain length j 0 j num feature j++ j % num feature 100 0 0 num i++ logger info +i+ p +ilist get alphabet lookup j + +p j logger info +i+ q +ilist get alphabet lookup j + +q j logger info +i+ alpha +ilist get alphabet lookup j + +alpha j logger info +i+ qeag +ilist get alphabet lookup j + +qeag j logger info klgain +ilist get alphabet lookup j + +klgain j klgain k l gain instance ilist label vector classification ilist get alphabet calc k l gain ilist classification label vector get label vector classification classification label vector ret label vector length 0 length i++ ret get label vector ret k l gain instance ilist classification classification ilist get alphabet calc k l gain ilist get label vector classification classification 