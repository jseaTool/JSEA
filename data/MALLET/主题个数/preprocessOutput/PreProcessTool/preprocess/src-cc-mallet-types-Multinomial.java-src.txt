2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e type io serializable io output stream io o io input stream type alphabet type feature type feature vector random probability over feature represent link type feature vector value element multinomial featur vector probability sum 1 feature index feature index index into underlie alphabet rath location feature vector p link type multinomial estimator provide subhierachy way generate estimate probability count feature mc callum multinomial feature vector multinomial size entry probability value them note dictionary thus multinomial big size dictionary share multiple estimator dictionary grow due another estimator get value probability alphabet dictionary size check sum value dictionary || dictionary size size see comment dictionary || dictionary size size probability length size xxx consider copying we assure we real probability value dictionary ? size dictionary size arraycopy probability 0 value 0 size dictionary || dictionary size probability length value probability check sum check we probability sum 0 0 value length i++ sum + value math ab sum 1 0 0 9999 illegal argument probability sum + sum + value multinomial probability alphabet dictionary size check sum dictionary get value probability dictionary size check sum multinomial probability alphabet dictionary probability dictionary dictionary size multinomial probability size probability size multinomial probability probability probability length size value length probability feature index value feature index probability key dictionary illegal multinomial dictionary probability dictionary lookup index key log probability feature index math log value feature index log probability key dictionary illegal multinomial dictionary log probability dictionary lookup index key alphabet get alphabet dictionary add probability vector 0 value length i++ vector + value random index random r f r next uniform sum 0 0 value length i++ sum + value print sum +sum sum f sum f illegal +i+ f +f+ sum +sum sum f random random r dictionary illegal multinomial dictionary dictionary lookup random index r feature random feature random r length dictionary alphabet unsupport operation multinomial dictionary alphabet feature f feature alphabet dictionary length length 0 f add random index r f size 1 0 weight feature feature vector feature vector random feature vector random r size feature vector random feature r size multinomial value feature index fi math log probability fi instead probability fi log numerical stability log multinomial serial u 1 l log probability alphabet dictionary size log already probability dictionary size log already dictionary || dictionary size size log already 0 size i++ value math log value log probability alphabet dictionary log already probability dictionary dictionary ? probability length dictionary size log already log probability alphabet dictionary size probability dictionary size log probability alphabet dictionary probability dictionary dictionary size log multinomial m m value m dictionary log probability probability probability feature index math value feature index log probability feature index value feature index add probability vector vector length value length fi 0 fi vector length fi++ vector fi + math value fi add log probability vector 0 value length i++ vector + value vector longer value act value be extend value minus infinity value length vector length i++ vector n e g t v e n f n t y serialization serial u 1 l xxx inherit someth augmentable dense feature vector hierarchy produce estimate probability multinomial count element alphabet estimator contain machinery associate manipulate count element alphabet behave sanely alphabet size between call contain generate probability estimate variou estimate subclass estimator cloneable serializable alphabet dictionary count size entry count min capacity 16 estimator count size alphabet dictionary count count size size dictionary dictionary estimator count alphabet dictionary count dictionary size dictionary estimator min capacity 0 estimator size size min capacity ? size min capacity size estimator alphabet dictionary dictionary size dictionary size dictionary alphabet alphabet size size count size dictionary size dictionary ? size dictionary size ensure capacity index dictionary size fix dictionary present? index size size index count length index length count length min capacity ? min capacity count length length index length 2 count length arraycopy count 0 count 0 count length count count xxx note reset size reset 0 count length i++ count 0 xxx method? count count dictionary || count length size xxx instead? xxx size match count length? count count increment index count ensure capacity index count index + count size index + 1 size index + 1 increment key count increment dictionary lookup index key count xxx add increment key count too dangerous? increment feature f scale f get alphabet dictionary illegal argument vocabulary t match fsi 0 fsi f size fsi++ increment f get index position fsi scale increment feature f increment f 1 0 increment feature vector fv scale fv get alphabet dictionary illegal argument vocabulary t match fvi 0 fvi fv num location fvi++ originally value feature being take into account here word be count once document gdruck increment fv index location fvi scale increment fv index location fvi scale fv value location fvi increment feature vector fv increment fv 1 0 get count index count index clone clone clone support e print count illegal foo multinomial estimator 0 size i++ count +i+ + count multinomial estimate serialization serial u overriden prevent innocuou making serialization mechanism think external format change serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n write dictionary write count write size read input stream o found read u r r e n t e r l v e r o n found mismatch multionmial estimator want + u r r e n t e r l v e r o n + get + dictionary alphabet read count read size read estimator estimator probability estimate multinomial generate add constant m specify construction count divide total m bias count m estimator estimator m m estimator alphabet dictionary m dictionary m m m estimator size m size m m m estimator m m m multinomial estimate pr dictionary ? size dictionary size dictionary ensure capacity dictionary size 1 side effect update size member sum 0 0 pr length i++ dictionary dictionary lookup + +count pr count + m sum + pr 0 pr length i++ pr sum multinomial pr dictionary size serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n write m read input stream o found read u r r e n t e r l v e r o n found mismatch multinomial m estimator want + u r r e n t e r l v e r o n + get + m read m estimator m estimator m 0 probability estimate multinomial generate divide count sum count m l estimator m estimator m l estimator 0 m l estimator size size 0 m l estimator alphabet dictionary dictionary 0 serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n read input stream o found read u r r e n t e r l v e r o n found mismatch multinomial m l estimator want + u r r e n t e r l v e r o n + get + m l estimator m estimator m 1 probability estimate multinomial generate add 1 count divide 1 bias count sum 1 bias count laplace estimator m estimator laplace estimator 1 laplace estimator size size 1 laplace estimator alphabet dictionary dictionary 1 serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n read input stream o found read u r r e n t e r l v e r o n found mismatch multinomial laplace estimator want + u r r e n t e r l v e r o n + get + multinomial laplace estimator todo lazy lazy lazy serializable too unimplement m estimator m p estimator estimator dirichlet prior m p estimator dirichlet size prior multinomial estimate xxx unfinish serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n read input stream o found read u r r e n t e r l v e r o n found mismatch multinomial m p estimator want + u r r e n t e r l v e r o n + get + 