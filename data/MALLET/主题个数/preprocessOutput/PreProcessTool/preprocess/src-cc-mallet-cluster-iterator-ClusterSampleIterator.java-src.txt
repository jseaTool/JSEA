cluster iterator iterator cluster clustering cluster neighbor evaluator agglomerative neighbor cluster cluster util type instance random sample cluster instance aron culotta culotta degas 1 0 since 1 0 see pair sample iterator neighbor iterator cluster sample iterator pair sample iterator clustering clustering random randomness positive proportion proportion instance positive example sample total sample generate cluster sample iterator clustering clustering random random positive proportion sample clustering random positive proportion sample instance next agglomerative neighbor neighbor positive count positive target || clustering get num cluster 1 nonsingleton cluster length 0 positive count++ label nonsingleton cluster random next nonsingleton cluster length instance clustering get index label label cluster sample split instance random 2 neighbor agglomerative neighbor clustering clustering cluster labeli random next clustering get num cluster labelj random next clustering get num cluster labeli labelj labelj random next clustering get num cluster neighbor agglomerative neighbor clustering cluster util merge cluster clustering labeli labelj sample clustering get index label labeli random 1 sample clustering get index label labelj random 1 total count++ instance neighbor sample subset element random sample random random min size sample size size math max random next length + 1 min size 0 length i++ add size size size length random next size ret size 0 iterator it iterator it next ret i++ it next value ret sample two disjoint subset element random sample split random random min size sample size size math max random next length + 1 min size 0 length i++ add size size size length random next size ret 2 size1 math max random next size 1 1 ret 0 size1 ret 1 size size1 0 size1 i++ ret 0 get value nadd 0 size1 size i++ ret 1 nadded++ get value ret 