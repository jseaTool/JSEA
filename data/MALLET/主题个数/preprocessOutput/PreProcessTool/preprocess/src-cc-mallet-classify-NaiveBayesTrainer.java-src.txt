2002 univ dept part m l l e t m achine learning languag e toolkit 1 0 information see ` l e n e classify io serializable io output stream io o io input stream iterator classify classifier pipe noop pipe pipe type alphabet type alphabet carry type feature selection type feature vector type instance type instance type label vector type label type multinomial generate naive bayes classifier training bayes classifier p classification| p data| classification p classification p p compute likelihood p data| classification p d1 d2 dn | classification naive bayes assumption conditionally independent classification p d1 d2 dn | classification p d1| classification p d2| classification p classifier naive bayes two trainer classifier naive bayes trainer produce estimate variou p dn| classifier contruct estimate p call train incremental train produce link classify naive bayes classifier can can classify instance call incremental train away internal trainer call incremental train train extend previou training p naive bayes trainer can persist serialization see naive bayes mc callum naive bayes trainer classifier trainer naive bayes classifier trainer instance increment naive bayes boostable alphabet carry serializable these function selection estimator multinomial estimator feature estimator multinomial laplace estimator multinomial estimator prior estimator multinomial laplace estimator support incremental training these count form naive bayes training note these estimate pass naive bayes classifier rath estimate form these count we could these five field into inner multinomial estimator me multinomial estimator pe doc length normalization 1 value 1 t document length normalization naive bayes classifier style incremental training succesful member probably move up into incremental classifier trainer pipe instance pipe construct classifier alphabet alphabet extract instance same call incremental train alphabet target alphabet extract instance same call incremental train naive bayes trainer naive bayes classifier classifier instance pipe classifier get instance pipe alphabet classifier get alphabet target alphabet classifier get label alphabet classifier classifier naive bayes trainer pipe instance pipe instance pipe instance pipe alphabet instance pipe get alphabet target alphabet instance pipe get target alphabet naive bayes trainer naive bayes get classifier classifier naive bayes trainer doc length normalization doc length normalization get doc length normalization doc length normalization get multinomial estimator instance specify type estimator feature estimator clone next call train first call incremental train multinomial estimator get feature multinomial estimator feature estimator multinomial estimator feature mulitnomial estimator internally clone clone maintain count generate probability estimate next train incremental train run multinomial laplace estimator me clone next call train first call incremental train naive bayes trainer feature multinomial estimator multinomial estimator me instance pipe illegal can t incremental train call feature estimator me get multinomial estimator instance specify type estimator prior estimator clone next call train first call incremental train multinomial estimator get prior multinomial estimator prior estimator multinomial estimator prior mulitnomial estimator internally clone clone maintain count generate probability estimate next train incremental train run multinomial laplace estimator me clone next call train first call incremental train naive bayes trainer prior multinomial estimator multinomial estimator me instance pipe illegal can t incremental train call prior estimator me naive bayes classifier training trainer us count feature instance feature vector provide estimate p labeling| feature internal trainer away call reset train call train completely independent training instance train classifier instance slot instance feature vector target slot instance label validation currently unus test currently unus evaluator currently unus classifier currently unus naive bayes classifier train training naive bayes train instance training forget previou statistic count me pe train classifier classifier train incremental training classifier naive bayes train incremental instance training instance add initialize check instance variable setup training instance add incrementally add count training instance instance training instance add incorporate instance instance training instance add get instance weight instance estimate multinomial naive bayes classifier note unlike max ent naive bayes immutable we classifier naive bayes instance pipe pe estimate estimate feature multinomial classifier naive bayes train incremental instance instance setup instance incrementally add count training instance incorporate instance instance 1 0 instance pipe instance pipe noop alphabet target alphabet classifier naive bayes instance pipe pe estimate estimate feature multinomial classifier setup instance instance instance instance instance || instance instance instance instance instance get 0 initialize alphabet alphabet alphabet instance get alphabet target alphabet instance get target alphabet alphabet alphabet match instance sure alphabet match illegal argument training alphabet match naive bayes trainer initialize check instance pipe instance instance pipe instance pipe instance get pipe instance pipe instance get pipe sure pipe match really necessary?? t think could confuse classifier different pipe? akm 1 08 illegal argument training pipe match naive bayes trainer me num label target alphabet size me multinomial estimator num label 0 num label i++ me multinomial estimator feature estimator clone me alphabet alphabet pe multinomial estimator prior estimator clone target alphabet size me length target alphabet grow increase size our multinomial target alphabet size target alphabet size over old value multinomial estimator me multinomial estimator target alphabet size arraycopy me 0 me 0 me length initialize expand space me length target alphabet size i++ multinomial estimator m multinomial estimator feature estimator clone m alphabet alphabet me m me me incorporate instance instance instance instance weight label label instance get label label handle unlabel instance skip them feature vector fv feature vector instance get norm fv norm norm 0 skip instance feature present doc length normalization 0 document count sum doc length normalization e 20 document have 20 word instance weight doc length normalization norm instance weight 0 infinite instance weight lpo 0 lpo label num location lpos++ label index location lpo label weight label value location lpo label weight 0 naive bayes trainer me increment + label weight instance weight me increment fv label weight instance weight relie label weight sum 1 over label pe increment label weight instance weight multinomial estimate feature multinomial num label target alphabet size multinomial m multinomial num label 0 num label li++ me print debug m me estimate m naive bayes classifier training previou trainer call incremental train add trainer incremental training session consist call incremental train call train training instance train classifier instance slot instance feature vector target slot instance label validation currently unus test currently unus evaluator currently unus classifier currently unus naive bayes classifier train training previou training list pass incremental train naive bayes trainer alphabet carry alphabet match alphabet carry alphabet alphabet match alphabet get alphabet alphabet alphabet get alphabet alphabet alphabet target alphabet serialization serial u overriden prevent innocuou making serialization mechanism think external format change serial u 1 u r r e n t e r l v e r o n 1 write output stream o write u r r e n t e r l v e r o n selection estimator write feature estimator write prior estimator these count form naive bayes training write me write pe pipe alphabet write instance pipe write alphabet write target alphabet read input stream o found read u r r e n t e r l v e r o n found mismatch naive bayes trainer want + u r r e n t e r l v e r o n + get + selection estimator feature estimator multinomial estimator read prior estimator multinomial estimator read these count form naive bayes training me multinomial estimator read pe multinomial estimator read pipe alphabet instance pipe pipe read alphabet alphabet read target alphabet alphabet read factory classifier trainer factory naive bayes trainer multinomial estimator feature estimator multinomial laplace estimator multinomial estimator prior estimator multinomial laplace estimator doc length normalization 1 naive bayes trainer classifier trainer classifier classifier naive bayes trainer naive bayes classifier naive bayes trainer factory doc length normalization doc length normalization doc length normalization doc length normalization naive bayes trainer factory feature multinomial estimator multinomial estimator feature estimator feature estimator feature estimator naive bayes trainer factory prior multinomial estimator multinomial estimator prior estimator prior estimator prior estimator 