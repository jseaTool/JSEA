collection concurrent callable concurrent execution concurrent executor concurrent future concurrent thread pool executor concurrent unit logging logger type instance type matrix ops optimize optimizable logger adaptor optimizable batch value gradient p compute value gradient batch multiple thread combine them gaurav chandalia see r f optimizable batch label likelihood thread optimizable optimizable gradient value logger logger logger get logger thread optimizable get name instance training optimizable parallelize optimizable combining batch gradient optimizable value obtain optimizable batch batch cache value gradient obtain optimizable batch batch cache gradient determine value gradient become stale cache stale indicator cache indicator task execute individual thread task instantiate once execute iteration collection callable value task collection callable gradient task thread pool compute value gradient batch thread pool executor executor millisecond l e e p t m e 100 initializ optimizable start thread optimizable optimizable parallelize num factor factor model initialize gradient cache indicator determine value gradient become stale thread optimizable optimizable combining batch gradient optimizable instance training num factor cache stale indicator cache indicator up training training optimizable optimizable num batch optimizable get num batch num batch 0 batch + num batch batch cache value num batch batch cache gradient num batch 0 num batch ++i batch cache gradient add num factor cache indicator cache indicator logger info create + num batch + thread updating gradient executor thread pool executor executor fix thread pool num batch task optimizable combining batch gradient get optimizable optimizable shut down executor start run thread compute value gradient p note clean exit thread recommend call training finish shutdown fix submit mark dredze mdredze jhu executor shutdown executor await termination 30 unit e o n interrupt e e print stack trace executor shutdown now size 0 task didn t finish get value cache indicator value stale compute value again run thread wait them finish future result executor value task compute log probability batch 0 future f result batch cache value batch++ f get execution ee ee print stack trace interrupt ie ie print stack trace cache value matrix ops sum batch cache value logger info get value loglikelihood optimizable label likelihood + cache value cache value matrix ops sum batch cache value gradient re compute gradient stale p note tt buffer tt already initialize get value gradient buffer cache indicator gradient stale compute value again get value compute gradient again run thread wait them finish executor gradient task interrupt ie ie print stack trace optimizable combine gradient batch cache gradient buffer create task execute parallel task look batch task num batch optimizable get num batch value task callable num batch gradient task callable num batch instance batch num batch instance training size num batch batch assignment start 1 1 0 num batch ++i get index batch 0 start 0 start + num batch instance num batch 1 start training size start start + num batch instance value task add value handler start gradient task add gradient handler start get num optimizable get num get buffer optimizable get buffer get parameter index optimizable get parameter index buff optimizable buff parameter index value optimizable parameter index value compute value thread batch value handler callable batch index batch assignment value handler batch index batch assignment batch index batch index batch assignment batch assignment value batch call optimizable get batch value batch index batch assignment compute gradient thread batch gradient handler callable batch index batch assignment gradient handler batch index batch assignment batch index batch index batch assignment batch assignment compute gradient batch call optimizable get batch value gradient batch cache gradient get batch index batch index batch assignment 