tab size 4 indent size 4 no tab collapse fold 1 2007 kazutoshi satoda g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s io importsimport io input stream io i o io input stream io output stream io reader io sequence input stream io writer charset malform input charset unsupport charset hash map map annotation nonnull encoding which b o m at beginning stream since 4 3pre10 kazutoshi satoda encoding b o m encoding constructor encoding b o m plain bom bom map get plain bom unsupport charset plain + b o m plain charset encoding plain bom bom encoding nonnull reader get text reader nonnull input stream i o actual mark bom length count read actual mark count bom length || equal actual mark bom malform input 0 plain get text reader nonnull writer get text writer nonnull output stream out i o out bom plain get text writer out nonnull reader get permissive text reader nonnull input stream i o actual mark bom length count read actual mark count bom length || equal actual mark bom concatenate non b o m rest input so non b o m are reinterepret some character sequence input stream input stream actual mark 0 count plain get permissive text reader detector detector encoding detector detect encoding input stream sample i o mark 4 count sample read mark low b o m16 0xff high b o m16 8 0xff count 4 mark 0 low mark 1 high mark 2 0x00 mark 3 0x00 x u t f 32 l e b o m mark 0 0x00 mark 1 0x00 mark 2 high mark 3 low x u t f 32 b e b o m count 2 mark 0 low mark 1 high x u t f 16 l e b o m mark 0 high mark 1 low x u t f 16 b e b o m doe available an encod u t f 16 actually us big endian correspond b o m just work u t f 16 b e b o m u t f 16 count u t f8 b o m length i 0 i u t f8 b o m length mark i u t f8 b o m i ++i i u t f8 b o m length u t f 8 y member b o m16 0xfeff u t f8 b o m 0xef 0xbb 0xbf map bom map hash map bom map put u t f 8 u t f8 b o m low b o m16 0xff high b o m16 8 0xff bom map put u t f 16 l e low high bom map put u t f 16 b e high low bom map put u t f 32 l e low high 0x00 0x00 bom map put u t f 32 b e 0x00 0x00 high low instance variable charset encoding plain bom 