regexp indent rule tab size 4 indent size 4 no tab collapse fold 1 2005 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s indent list regex pattern regex pattern syntax text segment buffer j edit buffer syntax token syntax token handler syntax token marker regexp indent rule 24415 2016 06 19 11 07 55 kerik sf regexp indent rule indent rule regexp indent rule constructor collapse then next indent rule an opening bracket rule increase indent regexp indent rule regexp indent action prev prev indent action prev indent action line collapse pattern syntax prev prev action prev prev prev action prev action line regexp pattern compile regexp pattern s e i n s e n s i t i v e collapse collapse apply apply j edit buffer buffer line index prev line index prev prev line index list indent action indent action action line match buffer line index indent action add action prev action prev line index 1 line match buffer prev line index indent action add prev action collapse indent action add indent action prev collapse prev prev action prev prev line index 1 line match buffer prev prev line index indent action add prev prev action collapse indent action add indent action prev prev collapse get get name + + regexp + indent action prev prev action prev action action pattern regexp collapse token filter filter which remove non syntactic character comment literal which might confuse regexp matching indent token filter token handler builder result token filter original length result builder original length handle token segment seg offset length token marker line context context avoid replacing an empty token into non empty length 0 token o m m e n t1 token o m m e n t2 token o m m e n t3 token o m m e n t4 replace comment white space so they are simply ignore result append token l i t e r l1 token l i t e r l2 token l i t e r l3 token l i t e r l4 replace literal 0 which mean simple literal most programming language result append 0 result append seg seg offset + offset length set line context token marker line context line context line match line match j edit buffer buffer line index token filter filter token filter buffer get line length line index buffer mark token line index filter regexp matcher filter result match 