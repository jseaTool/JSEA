tab size 4 indent size 4 no tab collapse fold 1 2007 kazutoshi satoda g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s io importsimport io input stream io i o charset charset charset illegal charset name log an encoding detector which extract encoding from xml declaration since 4 3pre10 kazutoshi satoda xml encoding detector encoding detector encoding detector detect encoding input stream sample i o length xml p i use encoding detection ?xml 1 0 encoding ? xml p i l e n g t h 50 xml p i xml p i l e n g t h offset 0 count count sample read xml p i offset xml p i l e n g t h offset 1 offset + count offset xml p i l e n g t h get xml encoding xml p i 0 offset s i i member extract xml encoding name from p i get xml encoding xml p i xml p i start ?xml index xml p i index encoding index 1 || index + 9 xml p i length ch xml p i at index + 9 end index xml p i index ch index + 10 end index 1 encoding xml p i substring index + 10 end index charset support encoding encoding log log log w r n i n g xml encoding detector xml p i specifie unsupport encoding + encoding illegal charset name e log log log w r n i n g xml encoding detector xml p i specifie illegal encoding + encoding e 