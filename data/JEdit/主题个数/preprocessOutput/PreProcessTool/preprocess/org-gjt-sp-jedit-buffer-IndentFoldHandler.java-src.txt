indent fold handler indent base fold handler tab size 4 indent size 4 no tab collapse fold 1 2001 2002 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s buffer list list text segment fold handler fold line base on their indent level indent fold handler 21831 2012 06 18 22 54 17 ezust since j edit 4 0pre1 indent fold handler fold handler indent fold handler indent width leading whitespace given segment contain non whitespace character 1 otherwise get leading whitespace width segment seg tab size offset seg offset count seg count whitespace 0 i 0 i count i++ seg offset + i whitespace++ whitespace + tab size whitespace % tab size whitespace 1 get fold level fold level specify line whitespace only line fold level next non whitespace line level previou line no non whitespace line follow level previou line high buffer buffer question line index line index seg segment fold handler use obtain text from buffer necessary fold level specify line since j edit 4 0pre1 get fold level j edit buffer buffer line index segment seg tab size buffer get tab size look first non whitespace line starting at line index prev level 0 index line index index buffer get line count index++ buffer get line text index seg whitespace get leading whitespace width seg tab size whitespace 0 non whitespace found on line whitespace prev level ? whitespace prev level index 0 0 index line index prev level buffer get fold level line index 1 all line from line index are whitespace only use fold level previou line prev level get precede fold level fold level line precede specify line which depend on specify line buffer buffer question line index line index seg segment fold handler use obtain line fold level fold level specify line fold level precede line decrease line number order i e bottomost line first since j edit 4 3pre18 list get precede fold level j edit buffer buffer line index segment seg line fold level list precede fold level list tab size buffer get tab size whitespace 0 index find previou non whitespace only line index line index 1 index 0 index buffer get line text index seg whitespace get leading whitespace width seg tab size whitespace 0 max line fold level whitespace ? line fold level whitespace index++ index line index index++ precede fold level add value max precede fold level 