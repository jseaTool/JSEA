tab size 4 indent size 4 no tab collapse fold 1 2008 kazutoshi satoda g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s io io input stream io input stream reader io i o regex pattern regex matcher buffer an encoding detector which find regex pattern read sample encoding first some line look regex pattern fail stream cannot read encoding pattern found at near top stream since 4 3pre16 kazutoshi satoda regex encoding detector encoding detector regex pattern match charset name specify charset charset href http download oracle com javase 6 doc api charset charset html name charset name v l e n o d i n g p t t e r n \\p alnum \\p alnum \\ pattern pattern replacement regex encoding detector pattern replacement pattern pattern compile pattern replacement replacement detect encoding input stream sample i o input stream reader reader input stream reader sample buffer size 1024 buffer buffer size read size reader read buffer 0 buffer size read size 0 matcher matcher pattern matcher buffer wrap buffer 0 read size tracking implicit state within matcher require know where start replacement after calling append replacement append position 0 matcher find extract extract replacement matcher append position replacement encoding server ha encoding extract extract append position matcher end replace matcher which ha be match find extract replacement matcher found append position replacement doesn t make sense read before start append replacement require found start found start found end found end source length found end found start length before match found start append position buffer replace buffer length before match + source length 2 found append replacement replace replacement replace substring length before match 