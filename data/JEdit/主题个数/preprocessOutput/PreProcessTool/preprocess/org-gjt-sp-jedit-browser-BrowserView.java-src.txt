browser view tab size 4 indent size 4 no tab collapse fold 1 2000 2003 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s browser importsimport border empty border event event io i o gui dockable window io generic g u i utility log thread utility v f s browser tree view browser view 24428 2016 06 23 02 49 29 suppres warning uncheck t o d o need check on parent directory list make genericclas browser view j panel browser view constructor browser view v f s browser browser browser browser tmp expand hash set dockable window dwm j edit get active view get dockable window key listener key listener dwm close listener v f s browser n m e parent directory parent directory list parent directory add key listener key listener parent directory set name parent parent directory get selection model set selection mode list selection model s i n g l e s e l e t i o n parent directory set cell render parent directory render parent directory set visible row count 5 parent directory add mouse listener parent mouse handler j scroll pane parent scroll j scroll pane parent directory parent scroll set minimum size dimension 0 0 table v f s directory entry table table add mouse listener table mouse handler table add key listener table key listener table set name j scroll pane table scroll j scroll pane table table scroll set minimum size dimension 0 0 table scroll get viewport set background table get background table scroll get viewport add mouse listener table mouse handler split pane j split pane browser horizontal layout ? j split pane h o r i o n t l s p l i t j split pane v e r t i l s p l i t parent scroll table scroll split pane set one touch expandable event queue runnable run parent directory ensure index visible parent directory get model get size browser multiple selection enable table get selection model set selection mode list selection model m u l t i p l e i n t e r v l s e l e t i o n table get selection model set selection mode list selection model s i n g l e s e l e t i o n set layout border layout add border layout e n t e r split pane property change focus on view focus on view table request focus get select v f s get select table get select select none select none table clear selection save expansion state save expansion state tmp expand clear table get expand directory tmp expand clear expansion state clear expansion state tmp expand clear load directory load directory node path add history load directory node path add history load directory load directory node path add history runnable delay w t task path misc utility construct path browser get directory path v f s vf v f s get v f s path path session vf create v f s session path session delay w t task thread utility run dispatch thread delay w t task node parent directory set list data loading placeholder load info 2 runnable runnable runnable run browser directory load node load info add history delay w t task delay w t task run thread utility run background list directory browser task browser session vf path load info runnable directory load rebuild parent view after directory ha be load node path directory directory load node path list v f s directory reload root update parent directory list node list model parent list list model parent path v f s vf v f s get v f s path parent v f s vf v f s session vf create v f s session path browser vf get session parent browser set name vf get name parent i o e log log log e r r o r e e create directory entry manually instead using vf get since so many v f s s v f s vf get name parent parent parent v f s d i r e t o r y 0 l parent list insert element at v f s vf get name parent parent parent v f s d i r e t o r y 0 l 0 parent list insert element at 0 parent vf get parent path parent parent || misc utility path equal parent parent parent parent parent directory set model parent list index parent list get size 1 parent directory set select index index parent directory ensure index visible index table set directory v f s get v f s path path node directory tmp expand update view update view table repaint maybe reload directory maybe reload directory path browser dir browser get directory symlink browser dir misc utility u r l browser dir symlink browser dir browser dir symlink browser dir misc utility resolve symlink browser dir misc utility path equal path symlink browser dir save expansion state load directory browser dir because call every v f s update we t want scan tree all time so we use following algorithm determine path might part tree path start browser s current directory we tree scan browser s directory favorite we tree scan every path appear favorite list browser s directory root path on local filesystem tree scan browser dir start favorite v f s p r o t o o l browser dir start root v f s p r o t o o l path start symlink browser dir browser dir start root v f s p r o t o o l misc utility u r l path equal misc utility get protocol u r l path table maybe reload directory path property change property change show icon j edit get property vf browser show icon table property change split pane set border get browser associate v f s browser instance since j edit 4 2pre1 v f s browser get browser browser get table v f s directory entry table get table table get parent directory list j list get parent directory list parent directory member instance variable v f s browser browser j split pane split pane j list parent directory v f s directory entry table table set tmp expand browser command menu popup show icon show popup show popup v f s component comp point point popup browser command menu browser parent directory right click on click we select click item when popup go away we select currently showing directory popup add popup menu listener popup menu listener popup menu cancel popup menu event e popup menu become visible popup menu event e popup menu become invisible popup menu event e we use utility so action execute before popup hide event queue runnable run index parent directory get model get size 1 parent directory set select index index generic g u i utility show popup menu popup comp point x point y inner parent directory render parent directory render list cell render font plain font font bold font parent directory render plain font u i get font tree font plain font plain font j edit get font property metal secondary font bold font font plain font get name font b o l d plain font get size override component get list cell render component j list list value index select cell ha focus get list cell render component list value index select cell ha focus parent directory render set border empty border 1 index 5 + 1 1 1 value loading placeholder parent directory render set font plain font set icon show icon ? cell render loading icon set text j edit get property vf browser tree loading value v f s v f s dir entry v f s value parent directory render set font bold font set icon show icon ? cell render get icon dir entry set text dir entry get name value set text v f s doe follow v f s p i parent mouse handler parent mouse handler mouse adapter override mouse press mouse event evt row parent directory location index evt get point row 1 obj parent directory get model get element at row obj v f s v f s dir entry v f s obj generic g u i utility popup trigger evt popup popup visible popup set visible popup parent directory set select index row show popup v f s dir entry parent directory evt get point override mouse release mouse event evt evt get click count % 2 0 generic g u i utility middle button evt get modifier row parent directory location index evt get point row 1 obj parent directory get model get element at row obj v f s v f s dir entry v f s obj generic g u i utility popup trigger evt browser set directory dir entry get path browser get mode v f s browser b r o w s e r focus on view table key listener table key listener key adapter override key press key event e e get key key event v k o n t e x t m e n u popup popup visible popup set visible popup row table get select row point po point 0 row table get row height row 1 show popup table po table get selection model select index row table get selection model set selection interval row row show popup get select table po table mouse handler table mouse handler mouse adapter mouse click override mouse click mouse event evt point p evt get point row table row at point p column table column at point p row 1 column 0 v f s directory entry table model entry entry v f s directory entry table model entry table get model get value at row 0 cell render expansion toggle border expansion toggle entry level p x evt get modifier input event b u t t o n1 m s k 0 evt get click count % 2 0 browser activate evt shift down ? v f s browser m o p e n n e w v i e w v f s browser m o p e n generic g u i utility middle button evt get modifier evt shift down table get selection model add selection interval row row table get selection model set selection interval row row browser activate evt shift down ? v f s browser m o p e n n e w v i e w v f s browser m o p e n mouse press override mouse press mouse event evt point p evt get point evt get source table p x table get x p y table get y row table row at point p column table column at point p column 0 row 1 v f s directory entry table model entry entry v f s directory entry table model entry table get model get value at row 0 cell render expansion toggle border expansion toggle entry level p x table toggle expand row generic g u i utility middle button evt get modifier row 1 evt shift down table get selection model add selection interval row row table get selection model set selection interval row row generic g u i utility popup trigger evt popup popup visible popup set visible popup row 1 show popup table evt get point table get selection model select index row table get selection model set selection interval row row show popup get select table evt get point mouse release override mouse release mouse event evt generic g u i utility popup trigger evt table get select row 1 browser select loading placeholder parent directory list j list override dimension get prefer size dimension d get prefer size split pane set divider location browser horizontal layout ? d width + 3 d height + 3 d override process key event key event evt evt get key event k e y p r e s s e d action context ac v f s browser get action context row parent directory get select index evt get key key event v k d o w n evt consume row parent directory get size height 1 parent directory set select index ++row key event v k l e f t evt get modifier input event l t m s k 0 evt consume browser previou directory process event evt key event v k r i g h t evt get modifier input event l t m s k 0 evt consume browser next directory process event evt key event v k t b evt consume evt get modifier input event s h i f t m s k 0 browser focus on component table request focus key event v k u p evt consume row 0 parent directory set select index row key event v k b k s p e evt consume edit action up ac get action vf browser up ac action evt up key event v k f5 evt consume edit action reload ac get action vf browser reload ac action evt reload key event v k e n t e r evt consume row 1 basically same handling parent mouse handler mouse release obj parent directory get model get element at row obj v f s v f s dir entry v f s obj browser set directory dir entry get path browser get mode v f s browser b r o w s e r focus on view these action t work because they look at entry table current select item we need action look at parent directory list item instead key event v k d e l e t e evt consume ea ac get action vf browser delete ac action evt ea key event t r l m s k | key event v k n evt consume ea ac get action vf browser ac action evt ea key event v k i n s e r t evt consume ea ac get action vf browser directory ac action evt ea evt get key event k e y t y p e d evt control down || evt alt down || evt meta down evt consume evt get key evt consume browser get mode v f s browser b r o w s e r browser set directory get property user home evt consume browser get mode v f s browser b r o w s e r browser root directory evt consume browser get mode v f s browser b r o w s e r browser set directory browser get view get buffer get directory evt consume process key event evt 