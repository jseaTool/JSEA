close bracket indent rule tab size 4 indent size 4 no tab collapse fold 1 2005 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s indent list buffer j edit buffer text utility standard utility close bracket indent rule 21831 2012 06 18 22 54 17 ezust close bracket indent rule bracket indent rule close bracket indent rule constructor close bracket indent rule close bracket align text utility get complementary bracket close bracket close bracket align align apply apply j edit buffer buffer line index prev line index prev prev line index list indent action indent action index align index line index index prev line index index 1 sequence line text buffer get line segment index offset offset line text length 1 offset 0 offset line text at offset close bracket offset 1 close count get bracket buffer index close count close count 0 align bracket align bracket align bracket buffer index offset consider following common lisp one opening bracket than closing defun emit push cond eql 0 emit lconst 0 eql 1 emit lconst 1 though we closing bracket match on line 3 next line must indent relative correspond opening bracket from line 1 open line align bracket get open bracket line open line 1 column align bracket get open bracket column align bracket set extra indent get bracket buffer open line 0 column open count indent action add align bracket align align bracket align bracket indent action line offset open bracket line open bracket column sequence open bracket line text extra indent align bracket j edit buffer buffer line offset line line offset offset open bracket index text utility find match bracket buffer line offset open bracket index 1 open bracket line 1 open bracket line buffer get line offset open bracket index open bracket column open bracket index buffer get line start offset open bracket line open bracket line text buffer get line segment open bracket line get extra indent extra indent set extra indent extra indent extra indent extra indent get open bracket column open bracket column get open bracket line open bracket line calculate indent j edit buffer buffer line old indent indent open bracket line text indent standard utility get leading white space width open bracket line text buffer get tab size + extra indent buffer get indent size keep check 