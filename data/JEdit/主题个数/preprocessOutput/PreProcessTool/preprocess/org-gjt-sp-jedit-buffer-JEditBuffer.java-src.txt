j edit buffer j edit buffer tab size 4 indent size 4 no tab collapse fold 1 1998 2005 1999 2000 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s buffer importsimport debug mode text utility indent indent action indent indent rule syntax textarea column block textarea column block line textarea node textarea selection textarea text area log standard utility annotation nonnull text position text segment list concurrent lock reentrant read lock regex pattern j edit buffer represent content an open text maintain computer s memory oppose how may store on disk p partially thread safe howev must pay attention two very important guideline operation such insert remove undo change buffer data lock must call from w t thread when access buffer from another thread must call read lock before read un lock after plan on performing than one read ensure buffer content are change w t thread duration lock only whose description specify thread safety from other thread j edit buffer 24427 2016 06 22 22 29 03 since j edit 4 3pre3 j edit buffer line separator property l i n e s e p line separator character encoding use when loading saving since j edit 3 2pre4 e n o d i n g encoding j edit buffer constructor buffer listener vector listener lock reentrant read lock content mgr content line mgr line position mgr position undo mgr undo property lock property hash map prop value suppres warning uncheck j edit buffer map prop need convert entry prop prop value instance set map entry set prop entry set map entry entry set property put entry get key prop value entry get value fill these from property correspond buffer x x x property set get property e n o d i n g property put e n o d i n g prop value get property encoding get property l i n e s e p property put l i n e s e p prop value get property line separator set fold handler dummy fold handler create j edit buffer use independent textarea only j edit buffer property put wrap prop value none property put prop value none token marker token marker token marker add rule set parser rule set text m i n set token marker token marker load text correspond buffer x x x property set get property e n o d i n g property put e n o d i n g prop value get property encoding get property l i n e s e p property put l i n e s e p prop value get property line separator set fold handler dummy fold handler flag dirty wheth there be unsav change buffer thread safe dirty dirty loading loading loading set loading set loading loading loading loading performing i o buffer currently performing i o thread safe since j edit 2 7pre1 performing i o loading || io set performing i o io buffer currently performing i o thread safe since j edit 2 7pre1 set performing i o io io io editable editable otherwise may become uneditable read only i o progress thread safe since j edit 2 7pre1 editable performing i o read only read only otherwise thread safe read only read only || read only override set read only set read only flag read only read only flag set read only read only read only override read only set dirty d set dirty change since last save flag buffer set dirty d editable editable d editable dirty dirty fix dirty flag being reset on save insert undo redo undo undo progress ensure undo clear dirty flag properly when all edit up save are undo undo mgr reset clear dirty thread safety read lock buffer guarantee change between call link read lock link read unlock call may nest read lock lock read lock lock read unlock buffer guarantee change between call link read lock link read unlock read unlock lock read lock unlock lock attempt obtain read lock block between call link lock link unlock call may nest lock lock lock lock unlock attempt obtain read lock block between call link lock link unlock unlock lock lock unlock line offset get length number character buffer thread safe get length no need lock since just value s content mgr get length get line count number physical line buffer thread safe since j edit 3 1pre1 get line count no need lock since just value s line mgr get line count get line offset line contain specify offset thread safe offset offset line offset since j edit 4 0pre1 get line offset offset read lock offset 0 || offset get length index out bound offset line mgr get line offset offset read unlock get line start offset start offset specify line thread safe line line start offset specify line offset after end line character before line since j edit 4 0pre1 get line start offset line read lock line 0 || line line mgr get line count index out bound line line 0 0 line mgr get line end offset line 1 read unlock get line end offset end offset specify line thread safe line line end offset specify line offset after end line character note buffer get line offset buffer get line end offset x doe x x+1 since j edit 4 0pre1 get line end offset line read lock line 0 || line line mgr get line count index out bound line line mgr get line end offset line read unlock get line length length specify line thread safe line line since j edit 4 0pre1 get line length line read lock get line end offset line get line start offset line 1 read unlock get prior non empty line auto indent need line index line previou non empty line get prior non empty line line index mode get ignore whitespace line index 1 value 1 i line index 1 i 0 i segment seg segment get line text i seg seg count 0 value i j 0 j seg count j++ ch seg seg offset + j character whitespace ch i didn t find line contain non whitespace so index prior whitespace line value text getter setter get line text text on specify line thread safe line line text line invalid since j edit 4 0pre1 get line text line line 0 || line line mgr get line count index out bound line read lock start line 0 ? 0 line mgr get line end offset line 1 end line mgr get line end offset line get text start end start 1 read unlock specify line segment p using segment generally efficient than using because result les memory allocation copying p thread safe line line segment segment since j edit 4 0pre1 get line text line segment segment get line text line 0 segment specify line from starting point pass relative start offset segment p using segment generally efficient than using because result les memory allocation copying p thread safe line line segment segment relative start offset relative start offset since j edit 4 0pre1 get line text line relative start offset segment segment line 0 || line line mgr get line count index out bound line read lock start line 0 ? 0 line mgr get line end offset line 1 end line mgr get line end offset line start+relative start offset end illegal argument index outside line length start+relative offset +start+ + +relative start offset+ + endffset +end get text start+relative start offset end start relative start offset 1 segment read unlock get line segment text on specify line thread safe line line index text line invalid since j edit 4 3pre15 sequence get line segment line line 0 || line line mgr get line count index out bound line read lock start line 0 ? 0 line mgr get line end offset line 1 end line mgr get line end offset line get segment start end start 1 read unlock get text specify text range thread safe start start offset length number character get get text start length read lock start 0 || length 0 || start + length content mgr get length index out bound start + + length content mgr get text start length read unlock full buffer content thread safe since 4 4 1 get text read lock content mgr get text 0 get length read unlock specify text range segment p using segment generally efficient than using because result les memory allocation copying p thread safe start start offset length number character get seg segment text get text start length segment seg read lock start 0 || length 0 || start + length content mgr get length index out bound start + + length content mgr get text start length seg read unlock get segment specify text range thread safe doesn t text start start offset length number character get sequence contain text want text since j edit 4 3pre15 sequence get segment start length read lock start 0 || length 0 || start + length content mgr get length index out bound start + + length content mgr get segment start length read unlock insert insert into buffer offset offset str since j edit 4 0pre1 insert offset str insert offset sequence str insert into buffer offset offset seg segment since j edit 4 0pre1 insert offset segment seg insert offset sequence seg insert into buffer offset offset seq charsequence since j edit 5 0pre1 insert offset sequence seq seq len seq length len 0 lock offset 0 || offset content mgr get length index out bound offset content mgr insert offset seq clear i 0 i len i++ seq at i add i + 1 undo progress undo mgr content insert offset len seq dirty content insert offset len unlock remove remove specify ring efrom buffer offset start offset length number character remove remove offset length length 0 transaction lock offset 0 || length 0 || offset + length content mgr get length index out bound offset + + length start line line mgr get line offset offset end line line mgr get line offset offset + length num line end line start line undo progress loading undo mgr content remove offset length get text offset length dirty fire pre content remove start line offset num line length content mgr remove offset length line mgr content remove start line offset num line length position mgr content remove offset length set dirty fire content remove start line offset num line length otherwise deliver undo progress inside compound edit fire transaction complete transaction unlock indentation remove trailing white space remove trailing whitespace from all line specify list line line number since j edit 3 2pre1 remove trailing white space line begin compound edit line line segment seg segment get line text line seg blank line seg count 0 line start seg offset line end seg offset + seg count 1 po po line end po line start po character whitespace seg po tail line end po no whitespace tail 0 remove get line end offset line 1 tail tail end compound edit shift indent left shift indent each line specify list left line line number since j edit 3 2pre1 shift indent left line tab size get tab size indent size get indent size no tab get property no tab begin compound edit l line line start get line start offset l sequence line get line segment l white space standard utility get leading white space line white space 0 white space width math max 0 standard utility get leading white space width line tab size indent size insert line start + white space standard utility create white space white space width no tab ? 0 tab size remove line start white space end compound edit shift indent right shift indent each line specify list right line line number since j edit 3 2pre1 shift indent right line begin compound edit tab size get tab size indent size get indent size no tab get property no tab l line line start get line start offset l sequence line get line segment l white space standard utility get leading white space line silly usability hack line length 1 white space 0 white space width standard utility get leading white space width line tab size + indent size insert line start + white space standard utility create white space white space width no tab ? 0 tab size remove line start white space end compound edit indent line indent all specify line start first line indent end last line indent since j edit 3 1pre3 indent line start end begin compound edit i start i end i++ indent line i end compound edit indent all specify line line line number since j edit 3 2pre1 indent line line begin compound edit line line indent line line end compound edit simple indent line simply indent given line same level previou nonempty line line index line number indent since j edit 5 0 simple indent line line index whitespace 1 prev line index get prior non empty line line index prev line index 1 indent standard utility get indent get line text prev line index begin compound edit start get line start offset line index remove start whitespace 0 insert start indent end compound edit indent line indent specify line line index line number indent decrease indent indent decrease result set tab key indentation take otherwise since j edit 4 2pre2 indent line line index decrease indent whitespace 1 current indent get current indent line line index whitespace prev line index get prior non empty line line index prev line indent prev line index 1 ? 0 standard utility get leading white space width get line segment prev line index get tab size ideal indent get ideal indent line line index prev line index prev line indent ideal indent 1 || ideal indent current indent || decrease indent ideal indent current indent begin compound edit start get line start offset line index remove start whitespace 0 prev indent prev line index 0 ? standard utility get indent get line text prev line index indent prev indent indent standard utility create white space ideal indent get property no tab ? 0 get tab size ideal indent prev line indent indent prev indent ideal indent prev line indent indent standard utility truncate white space ideal indent get tab size prev indent indent prev indent + standard utility create white space ideal indent prev line indent get property no tab ? 0 get tab size prev line indent insert start indent end compound edit get current indent line line s current leading indent line index line number whitespace non number whitespace character store at 0 index since j edit 4 2pre2 get current indent line line index whitespace segment seg segment get line text line index seg tab size get tab size current indent 0 loop i 0 i seg count i++ seg seg offset + i current indent++ whitespace whitespace 0 ++ current indent + tab size current indent % tab size whitespace whitespace 0 ++ loop current indent get ideal indent line ideal leading indent specify line apply variou auto indent rule line index line number get ideal indent line line index prev line index get prior non empty line line index old indent prev line index 1 ? 0 standard utility get leading white space width get line segment prev line index get tab size get ideal indent line line index prev line index old indent get ideal indent line ideal leading indent specify line apply variou auto indent rule line index line number prev line index index previou non empty line old indent indent width previou line 0 get ideal indent line line index prev line index old indent prev prev line index prev line index 0 ? 1 get prior non empty line prev line index indent old indent list indent rule indent rule get indent rule line index list indent action action link list indent action indent rule rule indent rule rule apply line index prev line index prev prev line index action indent action action action indent action calculate indent line index old indent indent action keep check indent 0 indent 0 indent get virtual width virtual column number taking tab into account specify position line line number column column number since j edit 4 1pre1 get virtual width line column read lock start get line start offset line segment seg segment get text start column seg standard utility get virtual width seg get tab size read unlock get offset virtual column offset virtual column number taking tab into account relative start line question line line number column virtual column number total virtual width non total virtual width store it first location 1 1 column out bound since j edit 4 1pre1 get offset virtual column line column total virtual width read lock segment seg segment get line text line seg standard utility get offset virtual column seg get tab size column total virtual width read unlock insert at column like link insert insert at specify virtual column insert space appropriate line than column line line number col virtual column number str insert at column line col str lock total 1 offset get offset virtual column line col total offset 1 offset get line end offset line 1 str standard utility create white space col total 0 0 + str offset + get line start offset line insert offset str unlock insert indent insert into buffer indent each line match indent first line offset offset text text number character indent insert on each line use abbreviation since j edit 4 2pre14 insert indent offset text begin compound edit obtain leading indent use first line get line offset offset sequence line text get line segment first line leading indent standard utility get leading white space width line text get tab size white space standard utility create white space leading indent get property no tab ? 0 get tab size insert offset text last line get line offset offset + text length note first line last line loop doe execute i first line + 1 i last line i++ insert get line start offset i white space white space length end compound edit electric key insert character trigger re indent current line? ch character line line electric key since j edit 4 3pre9 electric key ch line token marker line context ctx get line context line mode mode mode provider instance get mode ctx rule get mode name mode though s probably an further up mode mode electric key ch syntax highlighting get line context line context token marker specify line token marker line context get line context line line mgr get line context line mark token syntax token specify line line index line number token handler token handler receive syntax token since j edit 4 1pre1 mark token line index token handler token handler segment seg segment line index 0 || line index line mgr get line count index out bound line index first invalid line context line mgr get first invalid line context start context insensitive || first invalid line context 1 start line index start math min first invalid line context line index debug t o k e n m r k e r d e b u g log log log d e b u g tokenize from + start + + line index token marker line context old context token marker line context context i start i line index i++ get line text i seg old context get line context i token marker line context prev context i 0 || context insensitive ? get line context i 1 token handler token handler i line index ? token handler dummy token handler i n s t n e context mark token seg prev context token handler line mgr set line context i context line count line mgr get line count line count 1 line index line mgr set first invalid line context 1 old context context line mgr set first invalid line context line index + 1 first invalid line context 1 line mgr set first invalid line context math max first invalid line context line index + 1 get token marker token marker get token marker token marker set token marker set token marker token marker token marker token marker old token marker token marker token marker token marker t on initial token marker old token marker token marker old token marker line mgr set first invalid line context 0 create position create floating position text position position retain despite text edition p no removal position necessary only dereferenc offset offset position position create position offset read lock offset 0 || offset content mgr get length index out bound offset position mgr create position offset read unlock property property change reload setting from property call after syntax buffer local property are change property change get property fold handler handler fold handler get fold handler handler set fold handler handler set fold handler dummy fold handler get tab size tab size use buffer equivalent calling get property tab size thread safe get tab size tab size get property tab size 8 tab size 0 8 tab size get indent size indent size use buffer equivalent calling get property indent size thread safe since j edit 2 7pre1 get indent size indent size get property indent size 8 indent size 0 8 indent size get property value buffer local property using generally discourage because an which must cast another type order cause problem different type than what caller expect p following use instead link get property link get property link get property thread safe name property name backward compatibility an get property name property lock first buffer local property prop value o property get name o o value backward compatibility name ret val get property name ret val property put name prop value ret val ret val get property get property key set property set value buffer local property name property name value property value since j edit 4 0pre1 set property name value value property remove name prop value test property get name test property put name prop value value test value equal value test value value test value set property set property name value property put name prop value value unset property clear value buffer local property name property name since j edit 4 0pre1 unset property name property remove name reset cache property reset cache property need reset property be cache since might change iterator prop value it property value iterator it ha next prop value value it next value value it remove get property value property thread safe name property name since j edit 4 0pre1 get property name obj get property name obj obj set property set property name property name value value since j edit 4 0pre1 set property name value set property name value get property value property thread safe name property name since j edit 4 0pre1 get property name get property name value property thread safe name property name def value since j edit 4 3pre17 get property name def obj get property name standard utility get obj def set property set property name property name value value since j edit 4 0pre1 set property name value set property name value ? t r u e f l s e get property value an property thread safe name property name value value use since j edit 4 0pre1 get property name value value flag obj prop value value property get name value obj value value value flag value value obj get property name cache from now on value flag obj value obj number number obj value value parse obj trim property put name prop value value value flag value e value set property set an property name property name value value since j edit 4 0pre1 set property name value set property name value get pattern property value property regular expression thread safe name property name flag regular expression compilation flag since j edit 4 3pre5 pattern get pattern property name flag property lock value flag obj prop value value property get name value obj value value value flag value value obj get property name cache from now on value flag obj obj pattern pattern obj pattern re pattern compile obj flag property put name prop value re value flag re get rule set at offset syntax highlighting ruleset at specify offset offset offset since j edit 4 1pre1 parser rule set get rule set at offset offset line get line offset offset offset get line start offset line offset 0 offset token handler token token handler mark token line token token token text utility get token at offset token get token offset token rule get keyword map at offset syntax highlighting keyword map effect at specify offset use b complete word b command complete keyword offset offset since j edit 4 0pre3 keyword map get keyword map at offset offset get rule set at offset offset get keyword get context sensitive property some setting like comment start end vary between different part buffer h t m l text inline script example offset offset name property name property value since j edit 4 0pre3 get context sensitive property offset name parser rule set rule get rule set at offset offset value map ruleset prop rule get property ruleset prop value ruleset prop get name value value value get mode buffer s edit mode thread safe mode get mode mode set mode set buffer s edit mode note calling before buffer load no effect set mode property name mode bit inelegant i know mode mode name since j edit 4 2pre1 set mode mode set mode mode provider instance get mode mode set buffer s edit mode note calling before buffer load no effect set mode property name mode bit inelegant i know mode mode set mode mode mode set mode mode set buffer s edit mode note calling before buffer load no effect set mode property name mode bit inelegant i know mode mode force context insensitive want force buffer insensitive context careful syntax highlight value since j edit 4 5pre1 set mode mode mode force context insensitive protect against stupid people like me stuff like buffer set mode j edit get mode mode pointer mode must non mode mode context insensitive force context insensitive || mode get property context insensitive set token marker mode get token marker reset cache property property change fold start line line specify line begin fold since j edit 3 1pre1 fold start line line get line count 1 get fold level line get fold level line + 1 fold end specify line end fold line line since j edit 4 2pre5 fold end line fold level get fold level line next line fold level line get line count 1 ? 0 get fold level line + 1 fold level next line fold level invalidate cache fold level invalidate all cache fold level information since j edit 4 1pre11 invalidate cache fold level line mgr set first invalid fold level 0 fire fold level change 0 get line count get fold level fold level specify line line physical line index since j edit 3 1pre1 get fold level line line 0 || line line mgr get line count index out bound line fold handler dummy fold handler 0 first invalid fold level line mgr get first invalid fold level first invalid fold level 1 || line first invalid fold level line mgr get fold level line debug f o l d d e b u g log log log d e b u g invalid fold level from + first invalid fold level + + line fold level 0 change first update fold level first invalid fold level i first invalid fold level i line i++ segment seg segment fold level fold handler get fold level i seg fold level line mgr get fold level i debug f o l d d e b u g log log log d e b u g i + fold level change change update precede fold level necessary i first invalid fold level list precede fold level fold handler get precede fold level i seg fold level precede fold level j i fold level precede fold level j line mgr set fold level j fold level value j first update fold level first update fold level j line mgr set fold level i fold level line line mgr get line count 1 line mgr set first invalid fold level 1 line mgr set first invalid fold level line + 1 change debug f o l d d e b u g log log log d e b u g fold level change + first update fold level + + line fire fold level change first update fold level line fold level get fold at line an first element start line second element end line fold contain specify line number line line number since j edit 4 0pre3 get fold at line line start end fold start line start line fold level get fold level line line++ get fold level line fold level line++ line get line count end line 1 start line fold level get fold level line get fold level start fold level start 0 start end line get fold level end fold level end++ end get line count end get line length end 0 end start end start end get fold handler current buffer s fold handler since j edit 4 2pre1 nonnull fold handler get fold handler fold handler set fold handler set buffer s fold handler fold handler fold handler since j edit 4 2pre2 set fold handler nonnull fold handler fold handler fold handler old fold handler fold handler fold handler equal old fold handler fold handler fold handler line mgr set first invalid fold level 0 fire fold handler change undo undo undoe most recent edit text area text area since j edit 4 0pre1 undo text area text area undo mgr editable u i get look feel provide feedback lock undo progress fire begin undo selection s undo mgr undo s || s length 0 u i get look feel provide feedback text area set caret position s s length 1 get end text area set selection s fire end undo fire transaction complete undo progress unlock redo redoe most recently undo edit text area text area since j edit 2 7pre2 redo text area text area undo mgr editable u i get look feel provide feedback lock undo progress fire begin redo selection s undo mgr redo s || s length 0 u i get look feel provide feedback text area set caret position s s length 1 get end text area set selection s fire end redo fire transaction complete undo progress unlock transaction progress an undo compound edit currently progress then eventually link buffer buffer listener transaction complete j edit buffer buffer event get fire since j edit 4 0pre6 transaction progress transaction || undo progress || inside compound edit || loading begin compound edit start compound edit all edit from now on until link end compound edit are call merge into one use make complex operation undoable one step nest call link begin compound edit behave expect require same number link end compound edit call end edit end compound edit begin compound edit lock undo mgr begin compound edit unlock end compound edit end compound edit all edit perform since link begin compound edit wa call now undo one step calling link undo text area begin compound edit end compound edit lock undo mgr end compound edit inside compound edit fire transaction complete unlock inside compound edit compound edit currently active since j edit 3 1pre1 inside compound edit undo mgr inside compound edit undo progress an undo redo currently being perform since j edit 4 3pre3 undo progress undo progress get undo an identifie undo operation which current content change belong use buffer listener dur content change content insert content remove find out which content change belong same undo operation same undo all content change belonging same undo operation only identity undo use comparing previously undo using since j edit 4 3pre18 get undo undo mgr get undo buffer event n o r m l p r i o r i t y 0 h i g h p r i o r i t y 1 listener buffer listener listener priority listener buffer listener listener priority listener listener priority priority add buffer listener add buffer change listener listener listener priority listener h i g h p r i o r i t y get event before listener n o r m l p r i o r i t y since j edit 4 3pre3 add buffer listener buffer listener listener priority listener l listener listener priority i 0 i buffer listener size i++ listener l buffer listener get i l priority priority buffer listener add i l buffer listener add l add buffer change listener listener listener since j edit 4 3pre3 add buffer listener buffer listener listener add buffer listener listener n o r m l p r i o r i t y remove buffer listener remove buffer change listener listener listener since j edit 4 3pre3 remove buffer listener buffer listener listener i 0 i buffer listener size i++ buffer listener get i listener listener buffer listener remove i get buffer listener an register buffer change listener since j edit 4 3pre3 buffer listener get buffer listener buffer listener value buffer listener buffer listener size i 0 i value length i++ value i buffer listener get i listener value set undo limit set undo limit undo limit limit since j edit 4 3pre16 set undo limit limit undo mgr undo mgr set limit limit undo an undo operation perform since j edit 4 3pre18 undo undo mgr undo mgr undo redo redo operation perform since j edit 4 3pre18 redo undo mgr undo mgr redo context insensitive buffer highlight sensitive context highlight insensitive context since j edit 4 5pre1 context insensitive context insensitive set context insensitive set buffer insensitive context dur highlight context insensitive context insensitive value context since j edit 4 5pre1 set context insensitive context insensitive context insensitive context insensitive member edit mode buffer mode mode syntax highlight context insensitive highlight line we t ke context previou line context insensitive undo undo mgr token marker token marker event firing fire fold level change fire fold level change start end i 0 i buffer listener size i++ buffer listener listener get listener i listener fold level change start end throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire content insert fire content insert start line offset num line length i 0 i buffer listener size i++ buffer listener listener get listener i listener content insert start line offset num line length throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire content remove fire content remove start line offset num line length i 0 i buffer listener size i++ buffer listener listener get listener i listener content remove start line offset num line length throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire pre content insert fire pre content insert start line offset num line length i 0 i buffer listener size i++ buffer listener listener get listener i listener pre content insert start line offset num line length throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire pre content remove fire pre content remove start line offset num line length i 0 i buffer listener size i++ buffer listener listener get listener i listener pre content remove start line offset num line length throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire begin undo fire begin undo fire end undo fire end undo fire begin redo fire begin redo fire end redo fire end redo fire transaction complete fire transaction complete i 0 i buffer listener size i++ buffer listener listener get listener i listener transaction complete throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire fold handler change fire fold handler change i 0 i buffer listener size i++ buffer listener listener get listener i listener fold handler change throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t fire buffer load fire buffer load i 0 i buffer listener size i++ buffer listener listener get listener i listener buffer load throwable t log log log e r r o r sending buffer event + listener + log log log e r r o r t read only read only read only set read only set read only read only read only read only load text load text segment seg end offset seg seg segment 1024 0 0 end offset end offset end offset add 1 lock `reload command content mgr remove change length get length fire pre content remove 0 0 get line count 1 length content mgr remove 0 length line mgr content remove 0 0 get line count 1 length position mgr content remove 0 length fire content remove 0 0 get line count 1 length fire pre content insert 0 0 end offset get size 1 seg count 1 theoretically segment could seg offset 0 segment buffer nev doe content mgr set content seg seg count line mgr content insert end offset position mgr content insert 0 seg count fire content insert 0 0 end offset get size 1 seg count 1 unlock invalidate fold level invalidate fold level line mgr set first invalid fold level 0 parse buffer local property parse buffer local property max read 10000 line count get line count last line math min 9 line count 1 max math min max read get line end offset last line 1 parse buffer local property get segment 0 max first line last 10 line make sure overlap first 10 first line math max last line + 1 line count 10 first line line count first line start offset get line start offset first line length get line end offset line count 1 first line start offset + 1 length max read first line start offset + length max read length max read parse buffer local property get segment first line start offset length mark token token marker line context mark token segment seg token marker line context prev context token handler token handler token marker line context context token marker mark token prev context token handler seg context use store property value prop value prop value value value value pointer value value value value value then value cache from mode global so when change property value must reset value debug purpose value member list listener buffer listener reentrant read lock lock content content mgr line line mgr position position mgr nonnull fold handler fold handler undo progress dirty read only read only override transaction loading io map prop value property property lock field read instead elastic tabstop property when efficiency matter synchronization text area property change elastic tabstop on column block column block get listener buffer listener get listener index buffer listener get index listener content insert content insert offset length end offset transaction start line line mgr get line offset offset num line end offset get size loading fire pre content insert start line offset num line length line mgr content insert start line offset num line length end offset position mgr content insert offset length set dirty loading fire content insert start line offset num line length undo progress inside compound edit fire transaction complete transaction parse buffer local property suppres warning fallthrough parse buffer local property sequence prop builder buf builder name escape length prop length i 0 i length i++ prop at i escape escape buf append name encoding mustn t set way must equal encoding use load save name equal e n o d i n g use low level property setting so we buffer local property same value change t affect buffer local property property put name prop value buf name buf set length 0 escape escape buf append name buf buf set length 0 \\ escape buf append \\ escape escape n escape buf append escape r escape buf append \r escape t escape buf append escape buf append escape get indent rule list indent rule get indent rule line mode name token marker line context ctx get line context line ctx ctx rule mode name ctx rule get mode name mode name mode name token marker get rule set get mode name mode provider instance get mode mode name get indent rule update column block update column block start line end line start column node parent parent start line 0 end line 0 start line end line current line start line col block width 0 vector column block line column block line vector column block line current line end line column block parent column block column block parent ik start line parent column block get start line current line end line ik++ segment seg segment actual start start column parent column block get line empty column block line line parent column block get line element at ik current line line get line illegal argument actual start line get column end index +1 get line text current line actual start seg tab po get tab stop position seg tab po 0 column block line add column block line current line actual start actual start+tab po tab po col block width col block width tab po tab po 0 column block line empty || column block line empty current line end line column block block column block column block line element at 0 get line start column+col block width column block line element at column block line size 1 get line start column+col block width block set line column block line block set parent parent block set width col block width block set tab size dirty status block populate tab size parent add child block col block width 0 column block line vector column block line update column block block get start line block get end line start column+block get column width +1 block current line++ illegal argument get tab stop position get tab stop position segment seg i 0 i seg count i++ seg i+seg offset i 5 column block lock indent using elastic tabstop indent using elastic tabstop column block lock column block column block 0 get line count 1 update column block 0 line mgr get line count 1 0 column block get column block column block get column block column block 