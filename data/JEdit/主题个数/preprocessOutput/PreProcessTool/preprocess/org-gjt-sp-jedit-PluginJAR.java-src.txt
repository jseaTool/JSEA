plugin j r control j r loading unloading tab size 4 indent size 4 no tab collapse fold 1 1999 2004 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s importsimport event queue io buffer input stream io buffer output stream io closeable io data input stream io data output stream io io input stream io found io output stream io i o io input stream io reader reflect modifier net u r l list collection collection enumeration hash map hash set link hash set link list list map property set tokeniz regex matcher regex pattern zip zip entry zip zip utility browser v f s browser buffer dummy fold handler buffer fold handler gui dockable window factory gui dockable window io charset encoding msg plugin update msg property change log standard utility i o utility edit bus e b handler load unload plugin p h3 j r content h3 when loading plugin j edit look following resource name action xml defining plugin action only one such p plugin allow link action set syntax name browser action xml defining browser action only one such p plugin allow link action set syntax name dockable xml defining dockable window only one such p plugin allow link dockable window syntax name service xml defining additional service offer plugin such virtual only one such p plugin allow link service syntax extension prop contain name value pair separate an equal sign plugin supply number property property are use define plugin man item plugin option pane well arbitriary setting use plugin link edit plugin information about property use j edit property property syntax since j edit 5 0 name language iso property are localization one those match current language j edit load label miss localization load from other prop those ignore j edit s old than 5 0 cause problem href http sourceforge net app mediawiki index php?title localization j edit s localization wiki plugin actually someth once resident memory must contain whose name end plugin know i plugin core i must extend link edit plugin define few require property otherwise ignore h3 dynamic defer loading h3 unlike prior j edit j edit 4 2 allow plugin add remove resident set at time using link j edit add plugin j r link j edit remove plugin j r plugin j r furthermore plugin core might load until plugin first use link edit plugin start full description j edit get property j edit get plugin j edit get plugin j edit get plugin j r j edit get plugin j r j edit add plugin j r j edit remove plugin j r plugin j r action set dockable window option pane plugin j r service plugin j r 24110 2015 10 19 16 23 13 vampire0 since j edit 4 2pre1 plugin j r instance variable path cache path j r loader loader zip zip property property map property localization property list contain jar resource list jar resource action set action action set browser action edit plugin plugin u r l dockable u r i u r l service u r i activate list jar path these plugin require plugin set these require me link hash set plugin us me optional dependency set these use me link hash set plugin require these plugin set we require these link hash set these plugin are an optional dependency me i ll use them they are available no worry they aren t set we use these link hash set load jar path activate dependent necessary load plugin it dependent plugin necessary since j edit 4 3pre7 plugin j r load path load dependent plugin j r jar j edit get plugin j r path jar jar get plugin jar j edit add plugin j r path jar j edit get plugin j r path jar edit plugin plugin jar get plugin plugin no plugin maybe library jar name plugin get name load dependent set plugin load list get dependency set name jar name plugin load list jar path find plugin jar name jar path log log log w r n i n g plugin j r unable load dependency + jar name+ plugin instal load jar path load extra jar are part plugin collection jar path jar get jar jar path jar path plugin j r jar j edit get plugin j r jar path jar j edit add plugin j r jar path jar check dependency jar activate plugin necessary j edit property change check all other instal plugin them use me reload those so classloader work together plugin j r instal plugin j edit get plugin j r plugin j r instal instal plugin instal || instal equal jar edit plugin ep instal get plugin ep instal classname ep get name plugin depend dep get plugin depend instal classname plugin depend dep dep plugin equal dep what name equal dep name reload path ep get plugin j r get path j edit remove plugin j r ep get plugin j r load reload path jar parse jar path jar parse list plugin l s s n m e jar plugin l s s n m e full path each list since j edit 5 3pre1 collection parse jar path jar dir misc utility get parent path path tokeniz st tokeniz jar collection jar path link list st ha token jar path misc utility construct path dir st next token jar path add jar path jar path parse jar name path jar parse list plugin l s s n m e jar plugin l s s n m e them collection since j edit 5 3pre1 collection parse jar name jar tokeniz st tokeniz jar collection jar path link list st ha token jar path add st next token jar path get jar get jar list plugin full path them jar full path empty collection plugin since j edit 5 3pre1 collection get jar plugin jar j edit get property plugin + plugin get name + jar jar parse jar path jar collection empty list get get list plugin full path them full path empty collection plugin since j edit 5 3pre1 collection get plugin j edit get property plugin + plugin get name + parse jar path collection empty list get path full path name plugin s j r get path path find plugin unlike get plugin plugin j r yet load given it classname name name j rpath first plugin j r find which contain name found since 4 3pre7 find plugin name edit plugin ep j edit get plugin name ep ep get plugin j r get path j rpath j edit get load plugin j r plugin j r pjar plugin j r j rpath pjar contain name j rpath contain function name name jar contain classname since 4 3pre7 contain name get zip i o ioe runtime ioe enumeration ? zip entry itr zip entry itr ha element entry itr next element entry end name entry substring 0 entry length 6 replace name equal name get cache path full path name plugin s summary summary use store certain information which allow loading plugin s resource core defer until plugin first use plugin using j edit 4 2 plugin p i no extra effort require take advantage summary cache get cache path cache path get dependency set name plugin we wish load an order set j rpath contain plugin need re load correct order set get dependency set name set retval link hash set plugin depend dep get plugin depend name plugin depend plugin depend dep plugin depend optional plugin equal plugin depend what index2 plugin depend index index2 1 log log log e r r o r plugin j r name + ha an invalid dependency + plugin depend dep + miss plugin name plugin depend substring 0 index2 need plugin depend substring index2 + 1 todo check ? set load these first get dependency set plugin name load these first add plugin name load these first add all retval retval load these first retval get point plugin j r get get loader plugin s loader j r loader get loader loader get zip plugin s j r opening necessary since j edit 4 2pre1 zip get zip i o zip log log log d e b u g opening + path zip zip path zip get action set plugin s action set j edit action context link j edit get action context these action are load from action xml link action set since j edit 4 2pre1 action set get action set action get browser action set plugin s action set browser action context link v f s browser get action context these action are load from browser action xml link action set since j edit 4 2pre1 action set get browser action set browser action check dependency all dependency are satisifi otherwise also dependency are satisfy plugin mark check dependency plugin ok name plugin get name plugin depend dep get plugin depend name plugin depend plugin depend dep jdk equal plugin depend what plugin depend optional standard utility compare get property plugin depend 0 plugin depend get property j edit plugin path plugin dep jdk ok equal plugin depend what plugin depend length 11 log log log e r r o r invalid j edit + number + plugin depend ok plugin depend optional standard utility compare j edit get build plugin depend 0 need misc utility build plugin depend need j edit get j edit plugin path plugin dep ok plugin equal plugin depend what index2 plugin depend index index2 1 log log log e r r o r name + ha an invalid dependency + plugin depend dep + miss ok plugin name plugin depend substring 0 index2 need plugin depend substring index2 + 1 curr j edit get property plugin + plugin name + edit plugin edit plugin j edit get plugin plugin name edit plugin plugin depend optional need plugin name j edit plugin path plugin dep plugin no ok standard utility compare curr need 0 plugin depend optional need plugin name curr j edit plugin path plugin dep plugin ok edit plugin edit plugin plugin depend optional plugin name j edit plugin path plugin dep plugin ok plugin j r jar edit plugin get plugin j r plugin depend optional jar these use me add path we use these add jar get path jar these require me add path we require these add jar get path equal plugin depend what plugin depend optional loader load plugin depend e plugin depend j edit plugin path plugin dep ok log log log e r r o r name + ha unknown + dependency + plugin depend dep ok each j r list plugin s jar property need know we need them collection jar path get jar jar path jar path plugin j r jar j edit get plugin j r jar path jar jar path j edit plugin path plugin miss jar ok we require these add jar path jar these require me add path ok plugin ok get require jar require jar plugin require jar plugin since j edit 4 3pre12 set get require jar we require these get plugin depend plugin depend get plugin depend classname illegal argument list plugin depend ret list plugin depend i 0 dep dep j edit get property plugin + classname + depend + i++ optional dep start optional optional dep dep substring optional length optional index dep index index 1 illegal argument wrong dependency what dep substring 0 index dep substring index + 1 plugin depend depend plugin depend depend what what depend depend optional optional depend dep dep plugin equal what depend name index 0 ? substring 0 index ret add depend ret plugin depend ret size get dependency list dependency search plugin property classname classname plugin list classname plugin plugin depend on set get dependency classname illegal argument set ret hash set i 0 dep dep j edit get property plugin + classname + depend + i++ index dep index what dep substring 0 index dep substring index + 1 plugin equal what ret add index 0 ? substring 0 index ret get optional dependency list optional dependency search plugin property classname classname plugin list classname plugin plugin optionally depend on set get optional dependency classname illegal argument set ret hash set i 0 dep dep j edit get property plugin + classname + depend + i++ index dep index what dep substring 0 index dep substring index + 1 optional equal what index index what substring 0 index substring index + 1 plugin equal what ret add index 0 ? substring 0 index ret plugin depend plugin depend dep full e g plugin errorlist list 1 3 what depend type e g jdk plugin classname + e g errorlist list 1 3 name just name e g errorlist list only fill what plugin optional transitive closure plugin need b b need we want tell user need b when they unload dependent set plugin which we wish disable list model set plugin which affect need disabled also transitive closure dependent list list model jar path dependent list model contain jar path list model add jar path plugin j r jar j edit get plugin j r jar path jar log log log w r n i n g plugin j r jar + jar path + doesn t plugin may be partially remove transitive closure jar get dependent plugin list model get dependent plugin an plugin name hard dependency on plugin get dependent plugin these require me these require me size get optionally dependent plugin an plugin name an optional dependency on plugin get optionally dependent plugin these use me these use me size get all dependent plugin an plugin name dependency an optional dependency on plugin combination get dependent plugin get optionally dependent plugin get all dependent plugin dependent these require me size + these use me size arraycopy these require me 0 dependent 0 these require me size arraycopy these use me 0 dependent these require me size these use me size dependent get plugin plugin core j r note plugin ha be activate an instance link edit plugin defer need actual plugin core instance call link activate plugin first plugin yet load since j edit 4 2pre1 edit plugin get plugin plugin activate plugin load plugin core doe nothing plugin core ha already be load might call on startup depend on what property are set link edit plugin start thread safe since j edit 4 2pre1 activate plugin activate recursive call activate plugin edit plugin defer name plugin get name clazz loader load name modifier clazz get modifier modifier modifier || modifier modifier || edit plugin assignable from clazz log log log e r r o r plugin ha property doe extend edit plugin + name plugin plugin edit plugin clazz instance plugin jar throwable t plugin log log log e r r o r starting plugin + name log log log e r r o r t t j edit plugin path plugin start j edit thread || utility event dispatch thread start plugin thread safety start plugin edit bus send async plugin update plugin update t i v t e d activate necessary call after plugin instal since j edit 4 2pre2 activate plugin necessary filename misc utility get name get path j edit unset property plugin blacklist + filename plugin edit plugin defer plugin name plugin get name plugin t specify property ie 4 1 style plugin load them on startup activate j edit get property plugin + name + activate activate 4 1 plugin j edit thread plugin j edit plugin path plugin 42 activate plugin 4 2 plugin at least one property list here load plugin load tokeniz st tokeniz activate st ha token prop st next token value j edit get property prop value log log log d e b u g activating + name + because + prop load load activate plugin deactivate plugin unload plugin core doe nothing plugin core ha be load only call from w t event dispatch thread edit plugin stop since j edit 4 2pre3 deactivate plugin exit activate exit buffer retain reference fold handler question easy way handle fold handler unloading buffer buffer j edit get first buffer buffer buffer get fold handler get get loader loader buffer set fold handler dummy fold handler buffer buffer get next plugin plugin edit plugin plugin e b plugin || plugin get get annotation e b handler edit bus remove from bus plugin plugin stop throwable t log log log e r r o r + stopping plugin log log log e r r o r t plugin edit plugin defer plugin get name edit bus send plugin update plugin update d e t i v t e d exit exit 4 1 style plugin activate j edit get property plugin + plugin get name + activate activate plugin j edit plugin path plugin 42 activate get dockable u r i location plugin s dockable xml since j edit 4 2pre1 u r l get dockable u r i dockable u r i get service u r i location plugin s service xml since j edit 4 2pre1 u r l get service u r i service u r i override plugin path path + + plugin get name member get plugin cache plugin cache entry get plugin cache plugin j r plugin jar cache path plugin get cache path jar cache path data input stream din plugin cache entry cache plugin cache entry cache plugin plugin cache mod time plugin get last modify din data input stream buffer input stream input stream jar cache path cache read din cache outdat cache found fnf i o io log log log e r r o r plugin j r io i o utility close quietly closeable din set plugin cache set plugin cache plugin j r plugin plugin cache entry cache jar cache path plugin get cache path jar cache path log log log d e b u g plugin j r writing + jar cache path data output stream dout dout data output stream buffer output stream output stream jar cache path cache dout dout close i o io log log log e r r o r plugin j r io i o utility close quietly closeable dout jar cache path delete get plugin cache entry cache entry an instal load plugin there no need use plugin load path path plugin jar cache entry i o j edit cannot generate cache since j edit 5 3pre1 plugin j r plugin cache entry get plugin cache entry path i o plugin j r plugin j r plugin j r path plugin j r plugin cache entry plugin cache entry plugin j r get plugin cache plugin j r plugin cache entry plugin cache entry plugin j r generate cache i o utility close quietly plugin j r get zip plugin cache entry happen when some reason two plugin are instal e g when x s l t jar xslt jar are both j e d i t h o m e jar on linux log log log w r n i n g plugin j r couldn t load plugin +plugin j r get path + most likely other plugin cache entry plugin j r constructor create plugin j r which necessarily load load plugin j r path get path jar cache dir j edit get j r cache directory jar cache dir cache path misc utility construct path jar cache dir get name + summary loader j r loader action action set init init plugin cache entry cache get plugin cache cache load cache cache loader activate cache generate cache cache set plugin cache cache loader activate i o io log log log e r r o r cannot load + plugin + path log log log e r r o r io io j edit plugin path plugin load uninit uninit uninit exit deactivate plugin exit exit path we require these plugin j r jar j edit get plugin j r path jar jar these require me remove path path we use these plugin j r jar j edit get plugin j r path jar jar these use me remove path loader deactivate bean shell reset action j edit remove action set action browser action v f s browser get action context remove action set browser action dockable window factory get instance unload dockable window service unload service j edit remove plugin prop property localization property collection property value localization property value property value value j edit remove plugin localization prop value zip zip close zip i o io log log log e r r o r io remove plugin cache get get get resource get resource resource member action present core action present core log log log w r n i n g get path + ha an action xml no plugin core action set label m i s s i n g p l u g i n o r e l s s load cache load cache plugin cache entry cache check plugin same name already load cache plugin check plugin same name already load loading cache plugin cache cache property edit plugin other plugin j edit get plugin cache plugin other plugin j edit remove plugin j r other plugin get plugin j r cache resource cache resource must before loading cache property cache localization property localization property cache localization property current language j edit get current language property property localization property get current language property j edit add plugin localization prop property before dockable are initialize cache cache property property cache cache property j edit add plugin prop cache cache property cache action u r i cache cache action name action action set cache cache action name cache cache action toggle flag cache action u r i cache browser action u r i cache cache browser action name browser action action set cache cache browser action name cache cache browser action toggle flag cache browser action u r i label j edit get property plugin + cache plugin + name browser action set label j edit get property action set plugin label v f s browser get action context add action set browser action cache dockable u r i cache cache dockable name cache cache dockable action flag cache cache dockable movable flag dockable u r i cache dockable u r i dockable window factory get instance cache dockable window cache cache dockable name cache cache dockable action flag cache cache dockable movable flag action size 0 j edit add action set action cache service u r i cache cache service service u r i cache service u r i i 0 i cache cache service length i++ service descriptor d cache cache service i service register service d cache plugin label j edit get property plugin + cache plugin + name action set label j edit get property action set plugin label plugin edit plugin defer cache plugin action size 0 action present core generate cache plugin cache entry generate cache i o property property localization property hash map property list link list list resource link list zip zip get zip list plugin link list plugin cache entry cache plugin cache entry cache mod time last modify enumeration ? zip entry entry zip entry pattern language pattern pattern compile \\w+ property entry ha element zip entry entry entry next element name entry get name lname name lower action xml equal lname cache action u r i loader get resource name browser action xml equal lname cache browser action u r i loader get resource name dockable xml equal lname dockable u r i loader get resource name cache dockable u r i dockable u r i service xml equal lname service u r i loader get resource name cache service u r i service u r i lname end prop input stream loader get resource stream name property load i o utility close quietly closeable name end name misc utility name name end plugin plugin add name add name matcher matcher language pattern matcher lname matcher match language name matcher group 1 property prop property input stream loader get resource stream name charset encoding utf8 charset encoding u t f 8 reader utf8in utf8 get text reader prop load utf8in localization property put language name prop i o utility close quietly closeable resource add name cache cache property property cache localization property localization property must before loading cache property cache localization property localization property cache localization property current language j edit get current language property property localization property get current language property j edit add plugin localization prop property j edit add plugin prop property cache size resource cache resource resource resource size label name plugin label j edit get property plugin + name + name j edit get property plugin + name + label || log log log w r n i n g ignore + name cache plugin name check plugin same name already load loading name cache cache property edit plugin other plugin j edit get plugin name other plugin j edit remove plugin j r other plugin get plugin j r other plugin get plugin j r uninit plugin edit plugin defer name label label being load j edit get plugin j r get path being load log log log d e b u g plugin j r loading action dockable service + because plugin really being load cache cache action u r i action action set cache action u r i action load cache cache action name action get cacheable action name cache cache action toggle flag cache cache action name length i 0 i cache cache action name length i++ cache cache action toggle flag i j edit get property cache cache action name i + toggle cache browser action u r i browser action action set cache browser action u r i browser action load v f s browser get action context add action set browser action cache cache browser action name browser action get cacheable action name cache cache browser action toggle flag cache cache browser action name length i 0 i cache cache browser action name length i++ cache cache browser action toggle flag i j edit get property cache cache browser action name i + toggle dockable u r i dockable window factory get instance load dockable window dockable u r i cache action size 0 label action set label j edit get property action set plugin label action present core j edit add action set action service u r i service load service service u r i cache cache loading clazz property cache property j edit get plugin clazz other j edit get property plugin +clazz+ cache property get property plugin +clazz+ other compare 0 start plugin start plugin plugin start throwable t plugin log log log e r r o r plugin j r starting plugin + plugin get name log log log e r r o r plugin j r t t j edit plugin path plugin start plugin e b plugin || plugin get get annotation e b handler j edit get property plugin + plugin get name + activate old plugin expect j edit 4 1 style behavior where property change wa sent after plugin be start e b component plugin handle message property change edit bus add bus plugin buffer retain reference fold handler question easy way handle fold handler loading buffer buffer j edit get first buffer buffer fold handler handler fold handler get fold handler buffer get property before load handler handler buffer get fold handler buffer set fold handler handler buffer buffer get next start plugin start plugin event queue runnable override run activate start plugin plugin plugin plugin edit plugin plugin get name remove action set dockable etc so user doesn t plugin uninit we want property hang around j edit add plugin prop property remove plugin cache remove plugin cache cache path cache path delete plugin cache entry use dockable window service handle cache since j edit 4 2pre1 plugin cache entry m g i 0x b7 a2 e424 instance variable plugin j r plugin mod time resource u r l action u r i cache action name cache action toggle flag u r l browser action u r i cache browser action name cache browser action toggle flag u r l dockable u r i cache dockable name cache dockable action flag cache dockable movable flag u r l service u r i service descriptor cache service property cache property map property localization property plugin read must keep perfectly sync it very simple format way fast than serialize since serialization call reflection etc read read data input stream din i o cache magic din read cache magic m g i cache build read din cache build equal j edit get build cache mod time din read cache mod time mod time action u r i read u r i din cache action name read din cache action toggle flag read din browser action u r i read u r i din cache browser action name read din cache browser action toggle flag read din dockable u r i read u r i din cache dockable name read din cache dockable action flag read din cache dockable movable flag read din service u r i read u r i din len din read len 0 cache service cache service service descriptor len i 0 i len i++ service descriptor d service descriptor read din read din plugin cache service i d read din resource read din cache property read map din localization property read language map din plugin read din data output stream dout i o dout m g i dout j edit get build dout mod time dout action u r i dout cache action name dout cache action toggle flag dout browser action u r i dout cache browser action name dout cache browser action toggle flag dout dockable u r i dout cache dockable name dout cache dockable action flag dout cache dockable movable flag dout service u r i cache service dout 0 dout cache service length service descriptor cache service cache service dout cache service clazz dout cache service name dout dout resource map dout cache property language dout localization property dout plugin member read read data input stream din i o len din read len 0 str len i 0 i len i++ str i din read str read u r i u r l read u r i data input stream din i o str read din str u r l str read read data input stream din i o len din read len 0 str len i 0 i len i++ str i read din str read read data input stream din i o len din read len 0 bool len i 0 i len i++ bool i din read bool read map property read map data input stream din i o property value property count din read i 0 i count i++ key read din value read din value value value set property key value value read language map map property read language map data input stream din i o language count din read language count 0 collection empty map map property language hash map property language count i 0 i language count i++ read din property prop read map din language put prop language data output stream dout obj i o obj dout 0 str obj dout str length dout str data output stream dout str i o str dout 0 dout str length s str dout s data output stream dout bool i o bool dout 0 dout bool length bool bool dout bool map map data output stream dout property property i o dout property size set map entry set property entry set map entry entry set dout entry get key dout entry get value language language data output stream dout map property language i o dout language size map entry property entry language entry set dout entry get key map dout entry get value 