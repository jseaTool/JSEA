undo buffer undo tab size 4 indent size 4 no tab collapse fold 1 2001 2005 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s buffer importsimport log textarea selection internal j edit s document model use directly improve performance none check out bound access nor are they thread safe buffer through which these must call through such protection undo 22171 2012 09 06 15 12 05 ezust since j edit 4 0pre1 undo undo constructor undo j edit buffer buffer buffer buffer set limit set limit limit limit limit clear clear undo first undo last redo first undo count 0 undo undo undo last undo selection undo inside compound edit internal unbalance begin end compound edit undo last revise undo undo count selection s undo last undo redo first undo last undo last undo last prev undo last undo first s redo redo redo first redo selection redo inside compound edit internal unbalance begin end compound edit redo first revise undo undo count++ selection s redo first redo undo last redo first undo first undo first undo last redo first redo first next s begin compound edit begin compound edit compound edit count 0 compound edit compound edit revise undo compound edit count++ end compound edit end compound edit compound edit count 0 log log log w r n i n g unbalance begin end compound edit compound edit count 1 compound edit first nothing between begin end call compound edit first compound edit last add edit compound edit first add edit compound edit compound edit compound edit count inside compound edit inside compound edit compound edit count 0 get undo get undo undo content insert content insert offset length text clear dirty edit merge get merge edit clear dirty merge insert redo first insert in insert merge in offset offset in str text concat in str in offset + in str length offset in str in str concat text insert in insert offset text clear dirty redo clear dirty get last edit undo clear dirty in compound edit compound edit add in revise undo add edit in content remove content remove offset length text clear dirty edit merge get merge edit clear dirty merge remove redo first remove rem remove merge rem offset offset str rem str concat text kill ring get instance change rem str str rem str str offset + length rem offset str text concat rem str kill ring get instance change rem str str rem offset offset rem str str use intern here are create j edit buffer remove via undo mgr content remove get text remove rem remove offset text intern clear dirty redo clear dirty get last edit undo clear dirty rem compound edit compound edit add rem revise undo add edit rem kill ring get instance add rem str reset clear dirty reset clear dirty redo clear dirty get last edit redo first compound edit undo clear dirty compound edit redo first first undo clear dirty redo first member instance variable j edit buffer buffer queue undo last most recent first old edit undo first edit undo last queue redo first most recent last old edit redo first limit undo count compound edit count compound edit compound edit edit undo clear dirty redo clear dirty undo add edit add edit edit edit undo first undo first undo last edit undo last next edit edit prev undo last undo last edit redo first undo count++ undo count limit undo count undo first undo last undo first undo last undo first next prev undo first undo first next get merge edit edit get merge edit compound edit ? compound edit last get last edit get last edit edit get last edit undo last compound edit compound edit undo last last undo last revise undo revise unique undo undo operation being create result buffer content change being use undo redo content change belong same undo operation same undo call whenev buffer content change cause undo operation create i e whenev content change include same undo operation previou an undo redo perform revise undo undo get replace from remove insert replace edit remove edit then an insert edit replace get replace from remove insert edit last element edit element last element remove element insert t fold undo clear dirty remove edit because s identity significant last element undo clear dirty || element undo clear dirty element guarantee an compound insert edit redo clear dirty an normal insert normal remove compound remove insert edit compound replace edit all possible edit operation redo clear dirty cannot become equal element because redo clear dirty set after ha be save first change make which could an normal insert normal remove compound replace edit compound remove insert edit first change at all compound edit last element compound edit first remove insert sequence compound edit nev compact above statement redo clear dirty nev following remove insert element user no option save after first remove insert sequence because g u i block search replace all operation element redo clear dirty last element redo clear dirty remove rem remove last element insert in insert element rem offset in offset replace rem offset rem str in str get compress replace from replace replace compress replace edit one many replace edit compress via offset compress replace get compress replace from replace replace edit last element edit element element replace compress replace rep pack next replace into compress replace last element compress replace rep compress replace last element rep add replace element create compress replace last element replace rep compress replace replace last element rep add replace element inner edit edit edit prev next undo selection active after performing operation no selection active 0 length selection point caret location set after operation p note undo doe receive actual selection when record operation s because operation are record buffer ha no selection which are keep text area instance so selection s are simply guess contain insert text selection undo undo mgr redo link undo p note redo alway caret location only because actual selection unknown we guess from remove insert operation usually after an action selection become empty so such guess p selection redo undo mgr insert insert edit insert constructor insert offset str offset offset str str undo override selection undo undo mgr mgr buffer remove offset str length mgr undo clear dirty mgr buffer set dirty selection selection range offset offset redo override selection redo undo mgr mgr buffer insert offset str mgr redo clear dirty mgr buffer set dirty caret offset + str length selection selection range caret caret offset str remove remove edit remove constructor remove offset str offset offset str str undo override selection undo undo mgr mgr buffer insert offset str mgr undo clear dirty mgr buffer set dirty selection selection range offset offset + str length redo override selection redo undo mgr mgr buffer remove offset str length mgr redo clear dirty mgr buffer set dirty selection selection range offset offset offset str replace replace edit replace constructor replace offset str remove str insert offset offset str remove str remove str insert str insert undo override selection undo undo mgr mgr buffer remove offset str insert length mgr buffer insert offset str remove mgr undo clear dirty selection selection range offset offset + str remove length redo override selection redo undo mgr mgr buffer remove offset str remove length mgr buffer insert offset str insert mgr redo clear dirty mgr buffer set dirty caret offset + str insert length selection selection range caret caret offset str remove str insert compress replace compress replace replace compress replace constructor compress replace replace r1 r1 offset r1 str remove r1 str insert offset 4 offset add r1 offset add compress replace add replace rep str insert equal rep str insert str remove equal rep str remove offset add rep offset undo override selection undo undo mgr selection s i offset get size 1 i 0 i offset offset get i s undo mgr s redo override selection redo undo mgr selection s i 0 i offset get size i++ offset offset get i s redo mgr s offset compound edit compound edit edit undo override selection undo undo mgr selection ret val edit edit last edit ret val edit undo mgr edit edit prev ret val redo override selection redo undo mgr selection ret val edit edit first edit ret val edit redo mgr edit edit next ret val add add edit edit first first last edit edit prev last last next edit last edit add add undo mgr edit edit add edit compact sequence remove insert into replace edit save memory large search replace operation last prev edit rep mgr get replace from remove insert last prev last rep exchange last element rep compress sequence replace replace into compress replace last prev edit rep mgr get compress replace from replace replace last prev last rep exchange last element rep compress sequence compress replace replace into compress replace last prev edit rep mgr get compress replace from replace replace last prev last rep exchange last element rep exchange last element exchange last element edit edit remove last first last first last last prev next last last prev exchange current last first || first last first last edit edit prev last prev last prev next edit last edit edit first last 