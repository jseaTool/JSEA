generate edit line stream 3 0 bsh an stream where stream assume contain only s i i character like unicode escape processing stream flag hexval io i o 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 b b 11 12 d d 13 e e 14 f f 15 io i o nev come here bufpo 1 bufsize available token begin bufline bufcolumn column 0 line 1 prev r prev l f io reader input stream next buf buffer max next ind 0 next ind 1 buf 0 expand buff wrap around newbuff bufsize + 2048 newbufline bufsize + 2048 newbufcolumn bufsize + 2048 wrap around arraycopy buffer token begin newbuff 0 bufsize token begin arraycopy buffer 0 newbuff bufsize token begin bufpo buffer newbuff arraycopy bufline token begin newbufline 0 bufsize token begin arraycopy bufline 0 newbufline bufsize token begin bufpo bufline newbufline arraycopy bufcolumn token begin newbufcolumn 0 bufsize token begin arraycopy bufcolumn 0 newbufcolumn bufsize token begin bufpo bufcolumn newbufcolumn bufpo + bufsize token begin arraycopy buffer token begin newbuff 0 bufsize token begin buffer newbuff arraycopy bufline token begin newbufline 0 bufsize token begin bufline newbufline arraycopy bufcolumn token begin newbufcolumn 0 bufsize token begin bufcolumn newbufcolumn bufpo token begin throwable t t get message available bufsize + 2048 token begin 0 fill buff io i o i max next ind 4096 max next ind next ind 0 i input stream read next buf max next ind 4096 max next ind 1 input stream close io i o max next ind + i io i o e bufpo 0 bufpo backup 0 bufline bufpo line bufcolumn bufpo column e read io i o ++next ind max next ind fill buff next buf next ind begin token io i o buf 0 buf ++bufpo bufsize bufpo 0 token begin bufpo buffer bufpo token begin 0 bufpo 1 read adjust buff size available bufsize token begin 2048 bufpo 0 available token begin expand buff available token begin available bufsize token begin available 2048 expand buff available token begin update line column column++ prev l f prev l f line + column 1 prev r prev r prev l f line + column 1 \r prev r prev l f column column + 8 column 07 bufline bufpo line bufcolumn bufpo column read io i o buf 0 buf ++bufpo bufsize bufpo 0 buffer bufpo ++bufpo available adjust buff size buffer bufpo read \\ update line column back slash cnt 1 read all backslash ++bufpo available adjust buff size buffer bufpo read \\ update line column found non backslash u back slash cnt 1 1 bufpo 0 bufpo bufsize 1 backup back slash cnt \\ io i o e back slash cnt 1 backup back slash cnt \\ update line column back slash cnt++ here we see an odd number backslash s follow u read u ++column buffer bufpo hexval 12 | hexval read 8 | hexval read 4 | hexval read column + 4 io i o e invalid escape character at line + line + column + column + back slash cnt 1 backup back slash cnt 1 \\ update line column deprecate get end column get column bufcolumn bufpo deprecate get end line get line bufline bufpo get end column bufcolumn bufpo get end line bufline bufpo get begin column bufcolumn token begin get begin line bufline token begin backup amount buf + amount bufpo amount 0 bufpo + bufsize stream io reader dstream startline startcolumn buffersize input stream dstream line startline column startcolumn 1 available bufsize buffersize buffer buffersize bufline buffersize bufcolumn buffersize next buf 4096 stream io reader dstream startline startcolumn dstream startline startcolumn 4096 stream io reader dstream dstream 1 1 4096 re init io reader dstream startline startcolumn buffersize input stream dstream line startline column startcolumn 1 buffer || buffersize buffer length available bufsize buffersize buffer buffersize bufline buffersize bufcolumn buffersize next buf 4096 prev l f prev r token begin buf max next ind 0 next ind bufpo 1 re init io reader dstream startline startcolumn re init dstream startline startcolumn 4096 re init io reader dstream re init dstream 1 1 4096 stream io input stream dstream startline startcolumn buffersize io input stream reader dstream startline startcolumn 4096 stream io input stream dstream startline startcolumn dstream startline startcolumn 4096 stream io input stream dstream dstream 1 1 4096 re init io input stream dstream startline startcolumn buffersize re init io input stream reader dstream startline startcolumn 4096 re init io input stream dstream startline startcolumn re init dstream startline startcolumn 4096 re init io input stream dstream re init dstream 1 1 4096 get image bufpo token begin buffer token begin bufpo token begin + 1 buffer token begin bufsize token begin + buffer 0 bufpo + 1 get suffix len ret len bufpo + 1 len arraycopy buffer bufpo len + 1 ret 0 len arraycopy buffer bufsize len bufpo 1 ret 0 len bufpo 1 arraycopy buffer 0 ret len bufpo 1 bufpo + 1 ret next buf buffer bufline bufcolumn adjust line column number start token b r adjust begin line column line col start token begin len bufpo token begin len bufpo token begin + buf + 1 len bufsize token begin + bufpo + 1 + buf i 0 j 0 k 0 next col diff 0 column diff 0 i len bufline j start % bufsize bufline k ++start % bufsize bufline j line next col diff column diff + bufcolumn k bufcolumn j bufcolumn j col + column diff column diff next col diff i++ i len bufline j line++ bufcolumn j col + column diff i++ len bufline j start % bufsize bufline ++start % bufsize bufline j line++ bufline j line line bufline j column bufcolumn j 