edit server j edit server tab size 4 indent size 4 no tab collapse fold 1 1999 2003 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s importsimport bsh name space event io net random io v f s log inter process communication p edit server protocol very simple i j edit setting dir i server an s i i contain two line first being port number second being authorization key p connect port on local machine sending authorization key four network order follow length bean shell script two network order follow script u t f8 encoding after sock close bean shell script execute j edit p snippet execute w t thread none usual bean shell variable view buffer text area edit pane are set so script ha figure thing out itself p most script call link handle client course complicate stuff too edit server 23981 2015 08 10 14 56 24 edit server thread edit server constructor edit server port j edit server daemon + port + set daemon port port on unix set permission port rw so on unice which give everyone read access user home dir people t your port hence send arbitriary bean shell your way nasty operate unix port create v f s set permission port 0600 bind port on localhost accept 2 simultaneou connection attempt before reject connection socket server socket 0 2 inet address get name auth key random next m x v l u e port socket get local port writer out writer port out b out value port out out value auth key out out close ok log log log d e b u g j edit server start on port + socket get local port log log log d e b u g authorization key + auth key i o io on some window connection localhost fail network running avoid confuse newbie weird message log occur starting server n o t i e e r r o r log log log n o t i e io run run abort socket client client socket accept stop script kiddie from opening edit server port just leaving open s client set so timeout 1000 log log log m e s s g e client + connect data input stream data input stream client get input stream handle client client abort e abort log log log e r r o r e abort handle client restore ignore unles no view are open parent client s parent directory list entry are ignore convinience since j edit 3 2pre7 handle client restore parent handle client restore parent handle client restore ignore unles no view are open view open view? plain view open plain view? parent client s parent directory list entry are ignore convenience buffer since j edit 4 2pre1 buffer handle client restore view plain view parent we deal huge range possible border here j edit get first view coming out background mode no view open no buffer open empty ha buffer ha buffer restore restore j edit get property restore ha buffer || j edit get property restore cli view view perspective load perspective restore buffer buffer j edit open view parent view buffer buffer j edit get first buffer j edit view buffer buffer view set buffer buffer buffer plain view no background mode opening view buffer buffer j edit open parent buffer buffer j edit get first buffer j edit view buffer buffer view no background mode opening view buffer buffer j edit open parent buffer buffer j edit get first buffer j edit view j edit get active view buffer buffer no background mode reuse view view view j edit get active view buffer buffer j edit open view parent hack fix bringing window front at least on window frame front doesn t cut remove window check s other o s too j edit get property server front view set state frame i o n i f i e d un iconify using j d k 1 3 p i view set state frame n o r m l view request focus view front some platform e g window only set alway on top work view alway on top view set alway on top view set alway on top buffer o k o k ok get port get port socket get local port stop server stop server abort socket close i o io port delete member instance variable port server socket socket auth key ok abort handle client handle client socket client data input stream key read key auth key log log log e r r o r client + wrong + authorization key get + key + expect + auth key + close client close reset timeout client set so timeout 0 log log log d e b u g client + authenticate + successfully script read u t f log log log d e b u g script utility runnable run name space n name space bean shell get name space edit server namespace n set variable socket client bean shell eval n script bsh eval e log log log e r r o r e bean shell get name space set variable socket bsh eval e log log log e r r o r e 