text area painter paint text area tab size 4 indent size 4 no tab encoding u t f 8 collapse fold 1 1999 2013 shlomy reinstein matthieu casanova kazutoshi satoda alan ezust dale anson g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s textarea importsimport text j component event mouse event font buffer indent fold handler buffer j edit buffer syntax chunk syntax token handler syntax syntax style syntax token debug log text area painter component responsible display text current buffer only call plugin are those add remove text area extension add extension text area extension add extension text area extension remove extension text area extension text area extension text area text area painter 24095 2015 09 25 21 31 41 text area painter j component tab expand layer low possible layer add extension text area extension since j edit 4 0pre4 l o w e s t l y e r m i n v l u e below selection layer j diff plugin use add extension text area extension since j edit 4 0pre4 b k g r o u n d l y e r 60 line highlight collapse fold highlight layer add extension text area extension since j edit 4 0pre7 l i n e b k g r o u n d l y e r 50 below selection layer add extension text area extension since j edit 4 0pre4 b e l o w s e l e t i o n l y e r 40 selection layer most extension above layer some eg j diff want below selection add extension text area extension since j edit 4 0pre4 s e l e t i o n l y e r 30 wrap guide layer most extension above layer since j edit 4 0pre4 w r p g u e l y e r 20 below most extension layer add extension text area extension since j edit 4 0pre4 b e l o w m o s t e x t e n s i o n s l y e r 10 extension layer above wrap guide below structure highlight since j edit 4 0pre4 d e f u l t l y e r 0 block caret layer most extension below layer since j edit 4 2pre1 b l o k r e t l y e r 50 bracket highlight layer most extension below layer since j edit 4 0pre4 b r k e t h i g h l i g h t l y e r 100 text layer most extension below layer since j edit 4 2pre1 t e x t l y e r 200 caret layer most extension below layer since j edit 4 2pre1 r e t l y e r 300 high possible layer since j edit 4 0pre4 h i g h e s t l y e r m x v l u e set bound bad idea override we need get component event before first repaint override set bound x y width height some reason height alway off one when bound change at all hence +1 on height check +1 everyth get reset every time which other problem x get x y get y width get width height get height || height get height + 1 set bound x y width height text area recalculate visible line text area get buffer loading text area recalculate last physical line text area property change text area update max horizontal scroll width text area scroll bar initialize add notify override add notify add notify hide cursor get toolkit create custom cursor get graphic configuration create compatible image 16 16 transparency b i t m s k point 0 0 hide set cursor change mouse cursor cursor hide cursor t e x t u r s o r cursor cursor disappear anymore typing until link reset cursor call cursor cursor since j edit 4 4pre1 set cursor cursor cursor cursor cursor hide cursor || cursor get type cursor t e x t u r s o r set cursor cursor set cursor reset cursor s value since j edit 4 4pre1 reset cursor cursor show cursor show cursor cursor show cursor cursor set cursor cursor get predefin cursor cursor t e x t u r s o r hide cursor hide cursor cursor hide cursor cursor set cursor hide cursor get focus traversal key enable make tab key work 1 4 since j edit 3 2pre4 override get focus traversal key enable getter setter get style syntax style use paint colorize text entry i n i use paint token i n i an syntax style syntax token syntax style get style style set style set syntax style use paint colorize text entry i n i use paint token i n i style syntax style syntax token set style syntax style style style style style token n u l l syntax style get foreground get font text area chunk cache reset repaint get caret color caret color color get caret color caret color set caret color set caret color caret color caret color set caret color color caret color caret color caret color text area get buffer text area invalidate line text area get caret line get selection color selection color color get selection color selection color set selection color set selection color selection color selection color set selection color color selection color selection color selection color text area repaint get multiple selection color multiple selection color since j edit 4 2pre1 color get multiple selection color multiple selection color set multiple selection color set multiple selection color multiple selection color multiple selection color since j edit 4 2pre1 set multiple selection color color multiple selection color multiple selection color multiple selection color text area repaint get line highlight color line highlight color color get line highlight color line highlight color set line highlight color set line highlight color line highlight color line highlight color set line highlight color color line highlight color line highlight color line highlight color text area get buffer text area invalidate line text area get caret line line highlight enable line highlight enable otherwise line highlight enable line highlight set line highlight enable enable disable current line highlighting line highlight current line highlight enable otherwise set line highlight enable line highlight line highlight line highlight text area repaint get selection fg color selection foreground color one set since j edit 4 4 1 color get selection fg color selection fg color set selection fg color set selection foreground color selection fg color selection foreground color since j edit 4 4 1 set selection fg color color selection fg color selection fg color selection fg color selection fg color enable text area repaint selection fg color enable selection foreground color enable i e specific color use selection foreground instead syntax highlight color since j edit 4 4 1 selection fg color enable selection fg set selection fg color enable enable disable selection foreground color selection fg selection foreground enable otherwise since j edit 4 4 1 set selection fg color enable selection fg selection fg selection fg text area repaint get structure highlight color structure highlight color since j edit 4 2pre3 color get structure highlight color structure highlight color set structure highlight color set structure highlight color structure highlight color bracket highlight color since j edit 4 2pre3 set structure highlight color color structure highlight color structure highlight color structure highlight color text area invalidate structure match structure highlight enable structure highlighting enable otherwise since j edit 4 2pre3 structure highlight enable structure highlight set structure highlight enable enable disable structure highlighting structure highlight structure highlighting enable otherwise since j edit 4 2pre3 set structure highlight enable structure highlight structure highlight structure highlight text area invalidate structure match block caret enable caret draw block otherwise block caret enable block caret set block caret enable set caret draw block otherwise block caret caret draw block otherwise set block caret enable block caret block caret block caret extension mgr remove extension caret extension block caret add extension b l o k r e t l y e r caret extension add extension r e t l y e r caret extension text area get buffer text area invalidate line text area get caret line thick caret enable caret draw thick line otherwise since j edit 4 3pre15 thick caret enable thick caret set thick caret enable set caret draw thick line thick caret caret draw block otherwise since j edit 4 3pre15 set thick caret enable thick caret thick caret thick caret text area get buffer text area invalidate line text area get caret line get e o l marker eol marker set e o l marker emc eol marker emc get e o l marker color e o l marker color color get e o l marker color eol marker color set e o l marker color set e o l marker color eol marker color e o l marker color set e o l marker color color eol marker color eol marker color eol marker color repaint get e o l marker paint e o l marker are draw otherwise get e o l marker paint eol marker set e o l marker paint set e o l marker are draw eol marker e o l marker draw otherwise set e o l marker paint eol marker eol marker eol marker repaint get wrap guide color wrap guide color color get wrap guide color wrap guide color set wrap guide color set wrap guide color wrap guide color wrap guide color set wrap guide color color wrap guide color wrap guide color wrap guide color repaint wrap guide paint wrap guide draw otherwise since j edit 4 0pre4 wrap guide paint wrap guide set wrap guide paint set wrap guide draw wrap guide wrap guide draw otherwise set wrap guide paint wrap guide wrap guide wrap guide repaint get fold line style fold line style first element style line fold level great than 3 remain element are fold level 1 3 syntax style get fold line style fold line style set fold line style set fold line style first element style line fold level great than 3 remain element are fold level 1 3 fold line style fold line style set fold line style syntax style fold line style fold line style fold line style text area chunk cache reset repaint set anti alias enable j edit 4 3 subpixel antialia mode support since j edit 4 2pre4 set anti alias anti alias value anti alias value update rendering hint get anti alias anti alias value currently use text area since 4 3pre4 anti alias get anti alias anti alias set fractional font metric enable set fractional font metric enable ha no effect when running on 1 1 since j edit 3 2pre6 set fractional font metric enable frac font metric frac font metric frac font metric update rendering hint fractional font metric enable fractional font metric are enable since j edit 3 2pre6 fractional font metric enable frac font metric get font render context font render context since j edit 4 0pre4 font render context get font render context font render context add extension add text area extension which perform custom painting tool tip handling extension extension since j edit 4 0pre4 add extension text area extension extension extension mgr add extension d e f u l t l y e r extension repaint add extension add text area extension which perform custom painting tool tip handling layer layer add extension note than extension share same layer extension extension since j edit 4 0pre4 add extension layer text area extension extension extension mgr add extension layer extension repaint remove extension remove text area extension no longer ask perform custom painting tool tip handling extension extension since j edit 4 0pre4 remove extension text area extension extension extension mgr remove extension extension repaint get extension an register text area extension debug purpose since j edit 4 1pre5 text area extension get extension extension mgr get extension get tool tip text tool tip display at specify location evt mouse event override get tool tip text mouse event evt text area get buffer loading extension mgr get tool tip text evt get x evt get y get font metric font metric use component font metric get font metric fm get line height line height given font metric plus add line spacing get line height fm get height + extra line spacing get font height font height given font metric get font height fm get height get line extra spacing number pixel from start line start text extra line spacing get line extra spacing extra line spacing set line extra spacing set extra spacing between line pixel set line extra spacing spacing extra line spacing spacing set font set font component override update cache font metric recalculate which line are visible font font override set font font font set font font fm get font metric font text area recalculate visible line text area get buffer text area get buffer loading text area recalculate last physical line text area property change get width width given pixel using text area s current font since j edit 4 2final get width str text area width 0 text area width str length get font get bound str get font render context get width get rendering hint rendering hint use graphics2 d anti alias text since j edit 4 5pre1 rendering hint get rendering hint rendering hint update repaint text gfx graphic context override update graphic gfx paint gfx paint repaint text gfx graphic context override paint graphic gfx gfx graphics2 d graphics2 d gfx graphics2 d gfx gfx set rendering hint rendering hint font render context gfx get font render context rectangle clip rect gfx get clip bound line height get line height height get font height line height 0 || text area get buffer loading gfx set color get background gfx fill rect clip rect x clip rect y clip rect width clip rect height prepare time nano time because clip rect s height usually an multiple font height we subtract 1 from otherwise one too many line alway paint first line clip rect y line height last line clip rect y + clip rect height 1 line height gfx set color get background gfx set font get font prepare time nano time prepare time line time nano time num line last line first line + 1 y first line line height gfx fill rect 0 y get width num line line height extension mgr paint screen line range text area gfx first line last line y line height line time nano time line time debug p i n t t i m e r num line 1 log log log d e b u g repaint + num line + line take + prepare time + + line time + n text area update max horizontal scroll width next tab stop tab expand next tab stop after specify point x x co ordinate tab offset ignore next tab stop after i x i next tab stop x tab offset ntab x text area tab size ntab + 1 text area tab size get prefer size painter s prefer size override dimension get prefer size dimension dim dimension foo 80 i 0 i foo length i++ foo i dim width get width foo dim height get line height 25 dim get minimum size painter s minimum size override dimension get minimum size get prefer size member instance variable since they are access inner we want fast text area text area syntax style style color caret color color selection color color multiple selection color color line highlight color color structure highlight color color eol marker color eol marker color wrap guide color syntax style fold line style block caret thick caret line highlight structure highlight eol marker wrap guide anti alias anti alias frac font metric rendering hint rendering hint selection fg color selection fg color use little possible font metric fm extra line spacing text area painter constructor create painter create instance directly text area painter text area text area enable event w t event f o u s e v e n t m s k | w t event k e y e v e n t m s k | w t event m o u s e e v e n t m s k text area text area anti alias anti alias 0 extension mgr extension eol marker ?? set autoscroll set opaque set request focus enable set buffer set cursor cursor get predefin cursor cursor t e x t u r s o r font render context font render context add extension l i n e b k g r o u n d l y e r paint line background add extension s e l e t i o n l y e r paint selection add extension w r p g u e l y e r paint wrap guide add extension b r k e t h i g h l i g h t l y e r structure matcher highlight text area add extension t e x t l y e r paint text add extension t e x t l y e r paint selection text caret extension paint caret extra line spacing 0 member instance variable extension extension mgr paint caret caret extension font render context font render context cursor hide cursor cursor update rendering hint update rendering hint map rendering hint key hint hash map rendering hint key hint put rendering hint k e y f r t i o n l m e t r i s frac font metric ? rendering hint v l u e f r t i o n l m e t r i s o n rendering hint v l u e f r t i o n l m e t r i s o f f hint put rendering hint k e y t e x t n t i l i s i n g anti alias render hint anti alias val 0 hint put rendering hint k e y n t i l i s i n g rendering hint v l u e n t i l i s o f f font render context font render context anti alias val 0 frac font metric subpixel antialiasing mode anti alias val 1 font render hint frac font metric ? rendering hint v l u e f r t i o n l m e t r i s o n rendering hint v l u e f r t i o n l m e t r i s o f f font render context font render context anti alias render hint font render hint standard antialia hint put rendering hint k e y r e n d e r i n g rendering hint v l u e r e n d e r q u l i t y hint put rendering hint k e y n t i l i s i n g rendering hint v l u e n t i l i s o n hint put rendering hint k e y t e x t n t i l i s i n g rendering hint v l u e t e x t n t i l i s o n font render context font render context anti alias val 0 frac font metric rendering hint rendering hint hint inner paint line background paint line background text area extension paint line highlight paint line highlight caret start end line highlight enable || caret start || caret end count text area get selection count count 1 selection s text area get selection 0 s get start line s get end line count 0 paint valid line override paint valid line graphics2 d gfx screen line physical line start end y minimise access$ text area text area text area painter text area j edit buffer buffer text area get buffer paint line highlight collapse fold highlight collapse fold physical line buffer get line count 1 buffer fold start physical line text area display line visible physical line + 1 syntax style fold line style collapse fold level buffer get fold level physical line + 1 buffer get fold handler indent fold handler level math max 1 level buffer get indent size level 3 level 0 fold line style text area painter fold line style level caret text area get caret position paint line highlight paint line highlight caret start end color bg color paint line highlight bg color line highlight color collapse fold bg color fold line style get background color bg color bg color get background bg color get background paint line highlight || collapse fold gfx set color bg color gfx fill rect 0 y get width get line height paint token background chunk cache line info line info text area chunk cache get line info screen line line info chunk base line y + get line height fm get leading + 1 fm get descent chunk paint chunk background line info chunk gfx text area get horizontal offset base line get line height paint selection paint selection text area extension paint valid line override paint valid line graphics2 d gfx screen line physical line start end y text area get selection count 0 gfx set color text area multiple selection enable ? get multiple selection color get selection color iterator selection it text area get selection iterator it ha next selection s it next paint selection gfx screen line physical line y s paint selection paint selection graphics2 d gfx screen line physical line y selection s selection start end text area selection get selection start end screen line physical line s selection start end x1 selection start end 0 x2 selection start end 1 gfx fill rect x1 y x2 x1 get line height paint selection text paint selection text text area extension all screen line same physical line use same indentation indent indent found paint valid line override paint valid line graphics2 d gfx screen line physical line start end y text area get selection count 0 selection fg color enable || get selection fg color iterator selection it text area get selection iterator it ha next selection s it next paint selection gfx screen line physical line y s paint selection paint selection graphics2 d gfx screen line physical line y selection s physical line s get start line || physical line s get end line x indent text area get horizontal offset base line y + get line height fm get leading +1 fm get descent token handler token handler token handler text area get buffer mark token physical line token handler token token token handler get token line start text area get line start offset physical line start offset end offset s selection rect selection rect r selection rect s start offset r get start text area get buffer physical line end offset r get end text area get buffer physical line start offset s get start line start ? s get start line start end offset s get end soft wrap screen line start text area get screen line start offset screen line screen line end text area get screen line end offset screen line screen line start start offset start offset screen line start screen line end end offset end offset screen line end indent found token start line start token token e n d next token start + token length sub syntax style style style token next start offset reach selection start token start end offset get past selection style gfx set font style get font gfx set color get selection fg color str start start offset token start str start start offset x next x x style sub token start start offset str start token start str end end offset next ? next end offset sub text area get text str start str end str start gfx draw sub x base line x next x x style sub str start str end sub x next x x style token start next token start next token token next token start screen line start x indent next x x syntax style style s start offset end offset s s text area get text start offset end offset start offset s equal horz offset text area get horizontal offset x next tab stop x horz offset end offset + horz offset indent found s equal indent found indent x font font style ? style get font get font x + font get bound s get font render context get width x paint wrap guide paint wrap guide text area extension override paint screen line range graphics2 d gfx first line last line physical line start end y line height text area wrap margin 0 text area wrap width wrap guide paint gfx set color get wrap guide color x text area get horizontal offset + text area wrap margin gfx draw line x y x y + last line first line + 1 line height override get tool tip text x y text area wrap margin 0 text area wrap width wrap guide paint wrap guide po text area wrap margin + text area get horizontal offset math ab x wrap guide po 5 value text area get buffer get property max line len paint text paint text text area extension override paint valid line graphics2 d gfx screen line physical line start end y chunk cache line info line info text area chunk cache get line info screen line font font get font color color get foreground gfx set font font gfx set color color x text area get horizontal offset original x x base line y + get line height fm get leading +1 fm get descent line info chunk x + chunk paint chunk list line info chunk gfx text area get horizontal offset base line debug d i s b l e g l y p h v e t o r j edit buffer buffer text area get buffer line info last subregion gfx set font font gfx set color eol marker color gfx draw math max x text area get horizontal offset + text area wrap margin + text area width base line x + text area width physical line buffer get line count 1 buffer fold start physical line text area display line visible physical line + 1 level buffer get fold level physical line + 1 buffer get fold handler indent fold handler level math max 1 level buffer get indent size level 3 level 0 syntax style fold line style text area painter fold line style level font font fold line style get font gfx set font font gfx set color fold line style get foreground color next line next screen line screen line + 1 next screen line text area get visible line next line text area chunk cache get line info next screen line physical line next line text area display get next visible line physical line next line 1 next line text area get line count count next line physical line 1 str + count + line width get width str gfx draw str x base line x + width eol marker gfx set font font gfx set color eol marker color gfx draw eol marker x base line x + text area width line info width x original x paint caret paint caret text area extension override paint valid line graphics2 d gfx screen line physical line start end y text area caret visible caret text area get caret position caret start || caret end offset caret text area get line start offset physical line text area offset x y physical line offset text area offset x y caret x text area offset x y x line height get line height height math min line height get font height offset math max line height height 0 gfx set color caret color text area overwrite enable thick caret gfx fill rect caret x y + line height 4 text area width 3 gfx draw line caret x y + line height 1 caret x + text area width y + line height 1 block caret gfx draw rect caret x y + offset text area width 1 height 1 thick caret gfx fill rect caret x y + offset 3 height 1 gfx draw line caret x y + offset caret x y + offset + height 1 