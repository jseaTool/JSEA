text area transfer handler drag drop support tab size 4 indent size 4 no tab collapse fold 1 2004 g n u 2 w i t h o u t n y w r r n t y m e r h n t b i l i t y f i t n e s s f o r p r t i u l r p u r p o s e g n u g n u 59 330 m 02111 1307 u s textarea importsimport bufferio io task bufferset buffer set browser v f s browser io v f s io v f s io v f s runnable queue log thread utility datatransf data flavor datatransf selection datatransf transferable io net u r i list text area transfer handler 22943 2013 04 22 11 44 40 thomasmey text area transfer handler transfer handler i assume there only one drag operation at time j edit text area drag source compound edit same text area insert po insert offset unfortunately doe work data flavor internally change into another data flavor which doe match intent data flavor anymore so below we are iterate data flavor text u r ilist data flavor text u r ilist data flavor data flavor text uri list representationclas found e runtime cannot create data flavor happen e create transferable override transferable create transferable j component log log log d e b u g create transferable j edit text area text area j edit text area text area get selection count 0 drag source text area text area selection text area get source action override get source action j component o p y o r m o v e data override data j component transferable t log log log d e b u g data log log log d e b u g data t data flavor support +text u r ilist data flavor+ +t data flavor support text u r ilist data flavor + t get transfer data flavor value t data flavor support data flavor list flavor value t data flavor uri list data flavor data flavor data flavor t get transfer data flavor data flavor data flavor data flavor uri list data flavor uri list data flavor data flavor uri list data flavor t data flavor support uri list data flavor value u r i list t uri list data flavor value text t e log log log e r r o r e value g u i utility get view front g u i utility get view request focus request focus value j component transferable t log log log d e b u g list edit pane edit pane edit pane g u i utility get component parent edit pane view view edit pane get view buffer buffer p p i list flavor guarantee list so suppres warning statement we know what we re suppres warning uncheck list data list t get transfer data data flavor list flavor browse directory buffer set buffer set j edit get buffer set data directory browse directory v f s browser browse directory view get path browse directory buffer buffer j edit open edit pane get path buffer buffer buffer buffer set add buffer edit pane buffer buffer edit pane set buffer buffer view front view request focus edit pane request focus u r i list u r i list j component transferable t data flavor uri list data flavor str t get transfer data uri list data flavor log log log d e b u g u r i list \ +str+ \ edit pane edit pane edit pane g u i utility get component parent edit pane view view edit pane get view j edit text area text area j edit text area drag source found component str split browse directory i 0 i component length i++ str0 component i gnome commander add 0 at end name discard len str0 length len 0 str0 at len 1 0 str0 str0 substring 0 len 1 str0 length 0 u r i uri u r i str0 handle u r i decoding equal uri get scheme uri get path directory browse directory v f s browser browse directory view get path browse directory runnable queue i n s t n e run after io task drag u r l loader text area uri get path found log log log d e b u g i know how handle u r i +uri+ ignore last component because every u r i list terminate last one i component length 1 log log log d e b u g odd there an empty line uri list which last line found text text j component transferable t str t get transfer data data flavor flavor str str trim log log log d e b u g \ +str+ \ j edit text area text area j edit text area drag source found component str split str0 component only examine u r l come from outside j edit v f s vf v f s get v f s path str0 vf v f s || str start str str replace replace \r trim str0 start str0 str0 substring 7 thread utility run background drag u r l loader text area str0 found found drag source text area get buffer drag source get buffer compound edit text area get buffer begin compound edit same text area text area drag source caret text area get caret position selection s text area get selection at offset caret user drop into same selection where they start nothing s same text area user drop into selection replace selection start po s start text area set select text s str text area set selection selection range start po start pos+str length otherwise just insert text same text area insert po caret insert offset 0 selection selection text area get selection selection selection selection selection end insert po + insert offset insert offset selection end selection start text area get buffer insert caret str text area set selection selection range caret caret+str length text area scroll caret export override export j component transferable t action log log log d e b u g export j edit text area text area j edit text area happen data example drop into selection action n o n e log log log d e b u g export impossible t log log log d e b u g transferrable text area select none t data flavor support data flavor flavor log log log d e b u g same text area action m o v e text area set select text insert po + insert offset str t get transfer data data flavor flavor text area get buffer insert insert po str text area set selection selection range insert po insert pos+str length e log log log d e b u g export same text area log log log d e b u g e action m o v e text area set select text text area select none compound edit compound edit text area get buffer end compound edit drag source uri list uri list data flavor flavor text equal flavor get primary type uri list equal flavor get sub type flavor get representation override transfer support support drag source support set drop action o p y support override j component data flavor flavor j edit text area text area j edit text area correctly handle text flavor + list flavor + text area read only an all flag value data flavor flavor flavor flavor equal data flavor list flavor || uri list flavor value flavor equal data flavor flavor text area editable value log log log d e b u g + value value text area selection text area selection selection j edit text area text area text area selection j edit text area text area text area get select text text area text area drag u r l loader drag u r l loader io task j edit text area text area url drag u r l loader j edit text area text area url text area text area url url run edit pane edit pane edit pane get text area j edit open edit pane url 