std xml reader java nano xml java $ revision 1 4 $ $ date 2002 01 04 21 03 28 $ $ name r e l e a s e 2 2 1 $ file is part of nano xml 2 java copyright c 2000 2002 marc de scheemaeck all right reserve software is provide a is without any express or imply warranty in no event will the author be hold liable any damage arise from the use of software permission is grant to anyone to use software any purpose include commercial application and to alter it and redistribute it freely subject to the following restriction 1 the origin of software must not be misrepresent you must not claim that you write the original software you use software in a product an acknowledgment in the product documentation would be appreciate but is not require 2 alter source version must be plainly mark a such and must not be misrepresent a being the original software 3 notice may not be remove or alter from any source distribution net n3 nanoxml java io input stream java io input stream reader java io i o exception java io file java io file input stream java io file not found exception java io line number reader java io pushback reader java io pushback input stream java io reader java io string reader java io unsupport encoding exception java net malform u r l exception java net u r l java util stack std xml reader read the data to be parse author marc de scheemaeck version $ name r e l e a s e 2 2 1 $ $ revision 1 4 $ std xml reader i xml reader a stack reader author marc de scheemaeck version $ name r e l e a s e 2 2 1 $ $ revision 1 4 $ stack reader pushback reader pb reader line number reader line reader u r l system id string id the stack of reader stack reader the current push back reader stack reader current reader create a reader using a string a input param str the string contain the xml data i xml reader string reader string str std xml reader string reader str create a reader using a file a input param filename the name of the file contain the xml data java io file not found exception the file could not be found java io i o exception an i o error occur i xml reader file reader string filename file not found exception i o exception std xml reader r std xml reader file input stream filename r set system id filename i 0 i r reader size i++ stack reader sr stack reader r reader element at i sr system id r current reader system id r initializ the reader from a system and id param id the id which may be null param system id the non null system id malform u r l exception the system id doe not contain a valid u r l file not found exception the system id refer to a local file which doe not exist i o exception an error occur opening the stream std xml reader string id string system id malform u r l exception file not found exception i o exception u r l system ida u r l null system ida u r l u r l system id malform u r l exception e system id file + system id system ida u r l u r l system id malform u r l exception e2 e current reader stack reader reader stack reader reader open stream id system ida u r l to string current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 initializ the xml reader param reader the input the xml data std xml reader reader reader current reader stack reader reader stack current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader id current reader system id u r l file malform u r l exception e nev happen clean up the object when it s destroy finalize throwable current reader line reader null current reader pb reader null current reader system id null current reader id null current reader null reader clear super finalize scan the encoding from an lt ?xml ? gt tag param str the first tag in the xml data the encoding or null no encoding ha be specify string get encoding string str str start with ?xml null index 5 index str length string buffer key string buffer index str length str at index index++ index str length str at index a str at index z key append str at index index++ index str length str at index index++ index str length || str at index index str length str at index \ str at index index++ index str length delimit str at index index++ index2 str index of delimit index index2 0 key to string equal encoding str substring index index2 index index2 + 1 null convert a stream to a reader detecting the encoding param stream the input the xml data param read buffer where to put character that have be read java io i o exception an i o error occur reader stream2read input stream stream string buffer read i o exception pushback input stream pbstream pushback input stream stream b pbstream read b 0x00 0x f e 0x f f pbstream unread b input stream reader pbstream u t f 16 0x e f i 0 i 2 i++ pbstream read input stream reader pbstream u t f 8 0x3 c b pbstream read read append b 0 b 0x3 e read append b b pbstream read b 0 read append b string encoding get encoding read to string encoding null input stream reader pbstream u t f 8 read set length 0 input stream reader pbstream encoding unsupport encoding exception e input stream reader pbstream u t f 8 read append b input stream reader pbstream u t f 8 initializ the xml reader param stream the input the xml data java io i o exception an i o error occur std xml reader input stream stream i o exception pushback input stream pbstream pushback input stream stream string buffer read string buffer reader reader stream2read stream read current reader stack reader reader stack current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader id current reader system id u r l file malform u r l exception e nev happen start stream string reader read to string read a character the character java io i o exception no character could be read read i o exception ch current reader pb reader read ch 0 reader empty i o exception unexpect e o f current reader pb reader close current reader stack reader reader pop ch current reader pb reader read ch true the current stream ha no more character left to be read java io i o exception an i o error occur at e o f of current stream i o exception ch current reader pb reader read ch 0 true current reader pb reader unread ch false true there are no more character left to be read java io i o exception an i o error occur at e o f i o exception ch current reader pb reader read ch 0 reader empty true current reader pb reader close current reader stack reader reader pop ch current reader pb reader read current reader pb reader unread ch false push the last character read back to the stream param ch the character to push back java io i o exception an i o error occur unread ch i o exception current reader pb reader unread ch open a stream from a and system id param id the id which may be null param system id the system id which is nev null java net malform u r l exception the system id doe not contain a valid u r l java io file not found exception the system id refer to a local file which doe not exist java io i o exception an error occur opening the stream reader open stream string id string system id malform u r l exception file not found exception i o exception u r l url u r l current reader system id system id url get ref null string ref url get ref url get file length 0 url u r l url get protocol url get host url get port url get file url u r l jar + url + + ref url std xml reader get resource ref current reader id id current reader system id url string buffer read string buffer reader reader stream2read url open stream read read length 0 reader string read str read to string pushback reader pbread pushback reader reader read str length i read str length 1 i 0 i pbread unread read str at i pbread start a stream from a java reader the stream is use temporary to read data from that stream is exhaust control to the parent stream param reader the non null reader to read the data from start stream reader reader start stream reader false start a stream from a java reader the stream is use temporary to read data from that stream is exhaust control to the parent stream param reader the non null reader to read the data from param is internal entity true the reader is produce by resolving an internal entity start stream reader reader is internal entity stack reader old reader current reader reader push current reader current reader stack reader is internal entity current reader line reader null current reader pb reader pushback reader reader 2 current reader line reader line number reader reader current reader pb reader pushback reader current reader line reader 2 current reader system id old reader system id current reader id old reader id the current level of the stream on the stack of stream get stream level reader size the line number of the data in the current stream get line nr current reader line reader null stack reader sr stack reader reader peek sr line reader null 0 sr line reader get line number + 1 current reader line reader get line number + 1 set the system id of the current stream param system id the system id java net malform u r l exception the system id doe not contain a valid u r l set system id string system id malform u r l exception current reader system id u r l current reader system id system id set the id of the current stream param id the id set id string id current reader id id the current system id string get system id current reader system id to string the current id string get id current reader id 