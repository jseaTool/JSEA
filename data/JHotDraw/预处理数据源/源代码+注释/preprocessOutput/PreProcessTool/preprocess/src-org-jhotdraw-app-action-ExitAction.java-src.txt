exit action java 1 0 04 january 2005 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org org jhotdraw app action org jhotdraw gui org jhotdraw gui event org jhotdraw util java awt java awt event java util javax swing java io org jhotdraw app application org jhotdraw app project exit the application after letting the user save or close unsav project author wern randelshof version 1 0 04 january 2005 create exit action application action string id exit component old focus owner project unsav project create a instance exit action application app super app resource bundle util label resource bundle util get l a f bundle org jhotdraw app label label configure action id action perform action event evt application app get application app is enable app set enable false unsav project count 0 project document to be review null project p app project p ha unsav change p is enable document to be review p unsav project count++ unsav project count 0 document to be review null silently abort no project can be review app set enable true unsav project count 0 exit 1 unsav project document to be review old focus owner swing utility get window ancestor unsav project get component get focus owner unsav project set enable false j option pane pane j option pane html + u i manager get string option pane cs + b you want to save change to document + before exiting? b p + you don t save your change will be lost j option pane w a r n i n g m e s s a g e object option save cancel don t save pane set option option pane set initial value option 0 pane put client property quaqua option pane destructive option integer 2 j sheet show sheet pane unsav project get component sheet listener option select sheet event evt object value evt get value value null || value equal cancel unsav project set enable true app set enable true value equal don t save exit unsav project set enable true value equal save save change j option pane pane j option pane html + u i manager get option pane cs + b you have +unsav project count+ document with unsav change + you want to + review these change before quitting? b p + you don t review your document + all your change will be lost j option pane q u e s t i o n m e s s a g e object option review change cancel discard change pane set option option pane set initial value option 0 pane put client property quaqua option pane destructive option integer 2 j dialog dialog pane create dialog app get component null dialog set visible true object value pane get value value null || value equal cancel app set enable true value equal discard change exit app set enable true value equal review change unsav project document to be review review change save change unsav project get file null j file chooser file chooser unsav project get save chooser option file chooser show save dialog j sheet show save sheet file chooser unsav project get component sheet listener option select sheet event evt evt get option j file chooser a p p r o v e o p t i o n file file evt get file chooser get select file save to file file unsav project set enable true old focus owner null old focus owner request focus get application set enable true save to file unsav project get file review change unsav project is enable old focus owner swing utility get window ancestor unsav project get component get focus owner unsav project set enable false j option pane pane j option pane html + u i manager get string option pane cs + b you want to save change to document + before exiting? b p + you don t save your change will be lost j option pane w a r n i n g m e s s a g e object option save cancel don t save pane set option option pane set initial value option 0 pane put client property quaqua option pane destructive option integer 2 j sheet show sheet pane unsav project get component sheet listener option select sheet event evt object value evt get value value null || value equal cancel unsav project set enable true get application set enable true value equal don t save get application dispose unsav project review next value equal save save change and review next get application set enable true system out println review silently abort save change and review next unsav project get file null j file chooser file chooser unsav project get save chooser option file chooser show save dialog j sheet show save sheet file chooser unsav project get component sheet listener option select sheet event evt evt get option j file chooser a p p r o v e o p t i o n file file evt get file chooser get select file save to file and review next file unsav project set enable true old focus owner null old focus owner request focus get application set enable true save to file and review next unsav project get file review next unsav project count 0 project document to be review null project p get application project p ha unsav change p is enable document to be review p unsav project count++ unsav project count 0 exit document to be review null unsav project document to be review review change get application set enable true system out println exit silently abort save to file file file unsav project execute worker object construct unsav project write file null i o exception e e finish object value file save unsav project file value save to file and review next file file unsav project execute worker object construct unsav project write file null i o exception e e finish object value file save and review next unsav project file value file save project unsav project file file object value value null unsav project set file file exit j sheet show message sheet unsav project get component html + u i manager get string option pane cs + b couldn t save to the file \ +file+ \ p + reason +value j option pane e r r o r m e s s a g e unsav project set enable true old focus owner null old focus owner request focus get application set enable true file save and review next project unsav project file file object value value null unsav project set file file get application dispose unsav project review next j sheet show message sheet unsav project get component html + u i manager get string option pane cs + b couldn t save to the file \ +file+ \ p + reason +value j option pane e r r o r m e s s a g e unsav project set enable true old focus owner null old focus owner request focus get application set enable true exit get application stop system exit 0 