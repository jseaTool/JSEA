std xml parser java nano xml java $ revision 1 5 $ $ date 2002 03 24 11 37 00 $ $ name r e l e a s e 2 2 1 $ file is part of nano xml 2 java copyright c 2000 2002 marc de scheemaeck all right reserve software is provide a is without any express or imply warranty in no event will the author be hold liable any damage arise from the use of software permission is grant to anyone to use software any purpose include commercial application and to alter it and redistribute it freely subject to the following restriction 1 the origin of software must not be misrepresent you must not claim that you write the original software you use software in a product an acknowledgment in the product documentation would be appreciate but is not require 2 alter source version must be plainly mark a such and must not be misrepresent a being the original software 3 notice may not be remove or alter from any source distribution net n3 nanoxml java io i o exception java io array reader java io reader java util enumeration java util property java util vector std xml parser is the core parser of nano xml author marc de scheemaeck version $ name r e l e a s e 2 2 1 $ $ revision 1 5 $ std xml parser i xml parser the builder which create the logical structure of the xml data i xml builder builder the reader from which the parser retrieve it data i xml reader reader the entity resolv i xml entity resolv entity resolv the validator that will process entity reference and validate the xml data i xml validator validator create a parser std xml parser builder null validator null reader null entity resolv xml entity resolv clean up the object when it s destroy finalize throwable builder null reader null entity resolv null validator null super finalize set the builder which create the logical structure of the xml data param builder the non null builder set builder i xml builder builder builder builder the builder which create the logical structure of the xml data the builder i xml builder get builder builder set the validator that validate the xml data param validator the non null validator set validator i xml validator validator validator validator the validator that validate the xml data the validator i xml validator get validator validator set the entity resolv param resolv the non null resolv set resolv i xml entity resolv resolv entity resolv resolv the entity resolv the non null resolv i xml entity resolv get resolv entity resolv set the reader from which the parser retrieve it data param reader the reader set reader i xml reader reader reader reader the reader from which the parser retrieve it data the reader i xml reader get reader reader pars the data and let the builder create the logical data structure the logical structure build by the builder net n3 nanoxml xml exception an error occur reading or parse the data object parse xml exception builder start building reader get system id reader get line nr scan data builder get result xml exception e e exception e xml exception error xml exception e error init cause e error xml exception e scan the xml data element java lang exception someth go wrong scan data exception reader at e o f builder get result null string str xml util read reader ch str at 0 ch xml util process entity str reader entity resolv ch scan some tag false don t allow c d a t a null no namespace property \r skip whitespace xml util error invalid input reader get system id reader get line nr ` + ch + 0x + integer to hex string ch + scan an xml tag param allow c d a t a true c d a t a section are allow at point param namespace the namespace u r i or null param namespace list of define namespace java lang exception someth go wrong scan some tag allow c d a t a string namespace property namespace exception string str xml util read reader ch str at 0 ch xml util error unexpect entity reader get system id reader get line nr str ch ? process p i process special tag allow c d a t a reader unread ch process element namespace namespace process a processing instruction java lang exception someth go wrong process p i exception xml util skip whitespace reader null string target xml util scan identifier reader xml util skip whitespace reader null reader reader p i reader reader target equal ignore xml builder processing instruction target reader reader close process a tag that start with a bang lt gt param allow c d a t a true c d a t a section are allow at point java lang exception someth go wrong process special tag allow c d a t a exception string str xml util read reader ch str at 0 ch xml util error unexpect entity reader get system id reader get line nr str ch allow c d a t a process c d a t a xml util error unexpect c d a t a reader get system id reader get line nr d process doc type xml util skip comment reader process a c d a t a section java lang exception someth go wrong process c d a t a exception xml util check literal reader c d a t a xml util error expect input reader get system id reader get line nr c d a t a validator p c data add reader get system id reader get line nr reader reader c d a t a reader reader builder add p c data reader reader get system id reader get line nr reader close process a document type declaration java lang exception an error occur reading or parse the data process doc type exception xml util check literal reader o c t y p e xml util error expect input reader get system id reader get line nr d o c t y p e xml util skip whitespace reader null string system id null string buffer id string buffer string root element xml util scan identifier reader xml util skip whitespace reader null ch reader read ch p system id xml util scan id id reader xml util skip whitespace reader null ch reader read ch s system id xml util scan system id reader xml util skip whitespace reader null ch reader read ch validator parse d t d id to string reader entity resolv false xml util skip whitespace reader null ch reader read ch xml util error expect input reader get system id reader get line nr ` b e g i n p a t c h w randelshof don t read d t d false system id null reader reader reader open stream id to string system id reader start stream reader reader set system id system id reader set id id to string validator parse d t d id to string reader entity resolv true e n d p a t c h w randelshof don t read d t d process a regular element param namespace the namespace u r i or null param namespace list of define namespace java lang exception someth go wrong process element string namespace property namespace exception string full name xml util scan identifier reader string name full name xml util skip whitespace reader null string prefix null colon index name index of colon index 0 prefix name substring 0 colon index name name substring colon index + 1 vector attr name vector vector attr value vector vector attr type vector validator element start full name reader get system id reader get line nr ch ch reader read ch || ch reader unread ch process attribute attr name attr value attr type xml util skip whitespace reader null property extra attribute property validator element attribute process full name extra attribute reader get system id reader get line nr enumeration enm extra attribute key enm ha more element string key string enm next element string value extra attribute get property key attr name add element key attr value add element value attr type add element c d a t a i 0 i attr name size i++ string key string attr name element at i string value string attr value element at i string type string attr type element at i key equal xmln namespace value key start with xmln namespace put key substring 6 value prefix null builder start element name prefix namespace reader get system id reader get line nr builder start element name prefix namespace get property prefix reader get system id reader get line nr i 0 i attr name size i++ string key string attr name element at i key start with xmln string value string attr value element at i string type string attr type element at i colon index key index of colon index 0 string att prefix key substring 0 colon index key key substring colon index + 1 builder add attribute key att prefix namespace get property att prefix value type builder add attribute key null null value type prefix null builder element attribute process name prefix namespace builder element attribute process name prefix namespace get property prefix ch reader read xml util error expect input reader get system id reader get line nr ` validator element end name reader get system id reader get line nr prefix null builder end element name prefix namespace builder end element name prefix namespace get property prefix string buffer buffer string buffer 16 buffer set length 0 string str xml util skip whitespace reader buffer str xml util read reader str at 0 str at 1 xml util process entity str reader entity resolv str at 0 str xml util read reader \0 str at 0 xml util skip whitespace reader null str xml util scan identifier reader str equal full name xml util error wrong closing tag reader get system id reader get line nr name str xml util skip whitespace reader null reader read xml util error closing tag not empty reader get system id reader get line nr validator element end full name reader get system id reader get line nr prefix null builder end element name prefix namespace builder end element name prefix namespace get property prefix ^ reader unread str at 0 scan some tag true c d a t a allow namespace property namespace clone ^ str at 0 ch xml util process literal str buffer append ch reader unread str at 0 validator p c data add reader get system id reader get line nr reader r content reader reader entity resolv buffer to string builder add p c data r reader get system id reader get line nr r close process an attribute of an element param attr name contain the name of the attribute param attr value contain the value of the attribute param attr type contain the type of the attribute java lang exception someth go wrong process attribute vector attr name vector attr value vector attr type exception string key xml util scan identifier reader xml util skip whitespace reader null xml util read reader equal xml util error expect input reader get system id reader get line nr ` xml util skip whitespace reader null string value xml util scan string reader entity resolv attr name add element key attr value add element value attr type add element c d a t a validator attribute add key value reader get system id reader get line nr 