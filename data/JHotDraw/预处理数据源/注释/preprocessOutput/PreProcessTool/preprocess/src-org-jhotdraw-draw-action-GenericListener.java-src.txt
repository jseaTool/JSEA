generic listener java 1 1 2003 11 03 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org the generic listener create anonymou listener at runtime p usage pre demo j panel root j panel border layout j label label j label my button action action event e label set text button action my mouse enter mouse event e label set text mouse enter +e to string demo j button button j button button with dynamic listener listener will be generate at run time i e at run time an action listener will be code generate and then load only one of these is actually create even many call to generic listener create action listener are make action listener action listener action listener generic listener create action listener action perform my button action button add action listener action listener here s another dynamically generate listener one is a little different because the listener method argument actually specifie one of many listener method in the previou example action perform name the one and only action listener method mouse listener mouse listener mouse listener generic listener create mouse listener mouse enter my mouse enter button add mouse listener mouse listener pre author wern randelshof version 1 1 2003 11 03 support parameterles target method add br 1 0 2003 11 02 create a convenient version of code create listener method target object target method code version look up the listener and target method so you don t have to search a target method with the same parameter type a the listener method method target method get target method target target method name listener method get parameter type nothing found? search a target method with no parameter target method null target method get target method target target method name 0 still nothing found? we give up target method null runtime exception no such method +target method name+ in +target get create listener method target target method an instance of a that the that contain the declaration code listener method code in code listener method code will apply code target target method code to the incoming event object create method listener method object target method target method the implementation of the create method us the dynamic proxy a p i introduce in j d k 1 3 create an instance of the invok and override the invoke method to handle the invoke the target method on the target invocation handler handler invok object invoke object proxy method method object arg throwable send all method except the target method to the superclass handling listener method equal method target method get parameter type length 0 special treatment parameterles target method target method invoke target object 0 regular treatment target method have the same argument list a the listener method target method invoke target arg super invoke proxy method arg cl listener method get declare loader cl cl get loader proxy proxy instance cl cl handler implementation of the invocation handler which handle the basic object method invok invocation handler object invoke object proxy method method object arg throwable method get declare object string method name method get name method name equal hash code proxy hash code proxy method name equal equal proxy equal proxy arg 0 method name equal to string proxy to string proxy although listener method are suppose to be we allow any type here and produce null 0 false a appropriate null value of method get type integer proxy hash code object proxy integer system identity hash code proxy proxy equal object proxy object other proxy other ? t r u e f a l s e string proxy to string object proxy proxy get get name + + integer to hex string proxy hash code character 0 character 0 0 0 object null value of rt rt is primitive null rt null rt f a l s e rt 0 will convert to any other kind of number 0 helper method e z version of create method get listener method listener string listener method name given the argument to create find out which listener is desire method m listener get method method result null i 0 i m length i++ listener method name equal m i get name result null runtime exception ambiguou method +m i + v +result result m i result null runtime exception no such method +listen method name+ in +listen result method get target method object target string target method name parameter type method m target get get method method result null each method i 0 i m length i++ target method name equal m i get name each method p m i get parameter type p length parameter type length each method j 0 j p length j++ p j is assignable from parameter type j each method result null runtime exception ambiguou method +m i + v +result result m i result null runtime exception no such method +target method name+ in +target get result null null method result raise to result result null result result result method raise to method m c m get declare modifier is m get modifier modifier is c get modifier m yes search a version which m override sc c get superclass sc null method sm raise to m sc sm null sm c get i 0 i length i++ method im raise to m i im null im no version of m here null method raise to method m c method sm c get method m get name m get parameter type raise to sm no such method exception ee null generic listener 