j sheet java 2 0 2006 07 02 copyright c 2005 2006 wern randelshof staldenmattweg 2 immensee c h 6405 switzerland all right reserve software is the confidential and proprietary information of wern randelshof confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with wern randelshof j sheet is a document modal dialog which is display below the title bar of a j frame p a j sheet block input on it owner window it is visible p unlike application modal dialog the show method of a j sheet doe immediately when the j sheet ha become visible application need to use a sheet listener to get the value of a j sheet p require java 1 4 p caveat we are using an unsupport a p i call to make the j sheet translucent a p i may go away in future version of the macintosh runtime java in such a we hopefully just end up with a non opaque sheet author wern randelshof version 1 4 2006 07 02 rewrite independent use of the quaqua look and feel br 1 3 2006 04 15 request focus show window title of parent window when display sheet a a regular dialog window br 1 2 2006 02 18 set window decoration style to n o n e get sheet border from u i manager br 1 1 2005 10 15 bring sheet to front when showing an option pane or a filechoos method show message sheet with a sheet listener add br 1 0 1 2005 10 08 clear value br 1 0 september 25 2005 create event listener list handler is use to handle movement of the owner the owner move we have to change the location of the sheet a well is non null we put the owner to the specify location when the sheet is hide we need to keep track of the old owner position in order to avoid processing duplicate owner move event focus owner on the owner window before the sheet is show is set to true when the listener the j sheet are instal on the parent component is set to true the j sheet us a transition effect when show and when hide create a j sheet create a j sheet we move the sheet when the user move the owner so that it will alway stay center below the title bar of the owner the user ha move the owner we forget the shift back location and don t shift the owner back to the place it wa when we open the sheet owner movement handler component adapter component move component event evt window owner get owner point location owner get location location equal old location set location location x + owner get width get width 2 location y + owner get inset top shift back location null old location location is show a sheet u i manager get sheet show a sheet install the sheet on the owner method is invoke just before the j sheet is show install sheet is instal window owner get owner owner null determine the location the sheet and it owner the sheet will be visible in we have to shift the owner to fully display the dialog we remember the shift back position point owner loc owner get location point sheet loc is show a sheet owner j frame sheet loc point owner loc x + owner get width get width 2 owner loc y + owner get inset top + j frame owner get root pane get content pane get y owner j dialog sheet loc point owner loc x + owner get width get width 2 owner loc y + owner get inset top + j dialog owner get root pane get content pane get y sheet loc point owner loc x + owner get width get width 2 owner loc y + owner get inset top sheet loc x 0 owner set location owner loc x sheet loc x owner loc y sheet loc x 0 shift back location owner loc old location owner get location shift back location null old location owner loc sheet loc point owner loc x + owner get width get width 2 owner loc y + owner get height get height 2 set location sheet loc old focus owner owner get focus owner owner set focusable window state false owner set enable false j frame owner set resizable false u i manager get sheet show a sheet owner add component listener owner movement handler owner frame set title frame owner get title is instal true uninstall the sheet on the owner method is invoke immediately after the j sheet is hide uninstall sheet is instal window owner get owner owner null owner set focusable window state true owner set enable true j frame owner set resizable true owner remove component listener owner movement handler shift back location null owner set location shift back location old focus owner null owner to front old focus owner request focus is instal false add notify super add notify u i manager get sheet show a sheet method invoke ch randelshof quaqua quaqua utility set window alpha window integer t y p e object 240 null quaqua utility set window alpha 240 is set to true the j sheet us a transition effect when show and when hide set animate value old value is animate is animate value fire property change animate old value value true the j sheet us a transition effect when show and when hide is animate is animate dispose super dispose uninstall sheet hide0 super hide show0 super show hide is animate is show a sheet get content pane set visible false rectangle start bound get bound parent width get parent get width rectangle end bound rectangle parent width start bound width ? start bound x + start bound width parent width 2 start bound x start bound y math min start bound width parent width 0 timer timer timer 20 null timer add action listener action listener start time end time action perform action event evt now system current time milli start time 0 start time now end time start time + 200 now end time timer stop hide0 set bound start bound get content pane set visible true uninstall sheet ratio now start time end time start time set bound start bound x 1f ratio + end bound x ratio start bound y 1f ratio + end bound y ratio start bound width 1f ratio + end bound width ratio start bound height 1f ratio + end bound height ratio timer set repeat true timer set initial delay 5 timer start hide0 uninstall sheet show is animate is show a sheet install sheet get content pane set visible false start time system current time milli end time start time + 300 rectangle end bound get bound parent width get parent get width rectangle start bound rectangle parent width end bound width ? end bound x + end bound width parent width 2 end bound x end bound y math min end bound width parent width 0 set bound start bound show0 timer timer timer 20 null timer add action listener action listener start time end time action perform action event evt now system current time milli start time 0 start time now end time start time + 200 now end time timer stop set bound end bound get content pane set visible true request focus reinsert window get parent to front ratio now start time end time start time set bound start bound x 1f ratio + end bound x ratio start bound y 1f ratio + end bound y ratio start bound width 1f ratio + end bound width ratio start bound height 1f ratio + end bound height ratio timer set repeat true timer set initial delay 5 timer start install sheet show0 add a sheet listener add sheet listener sheet listener l listener list add sheet listener l remove a sheet listener remove sheet listener sheet listener l listener list remove sheet listener l notify all listener that have register interest notification on event type the event instance is lazily create using the parameter pass into the fire method fire option select j option pane pane object value pane get value option value null option j option pane c l o s e d o p t i o n pane get option null value integer option integer value value option j option pane c l o s e d o p t i o n option j option pane c l o s e d o p t i o n object option pane get option i 0 n option length i n i++ option i equal value option i option j option pane c l o s e d o p t i o n value null fire option select pane option value pane get input value notify all listener that have register interest notification on event type the event instance is lazily create using the parameter pass into the fire method fire option select j option pane pane option object value object input value sheet event sheet event null guarantee to a non null array object listener listener list get listener list process the listener last to first notify those that are interest in event i listener length 2 i 0 i 2 listener i sheet listener lazily create the event sheet event null sheet event sheet event pane option value input value sheet listener listener i+1 option select sheet event notify all listener that have register interest notification on event type the event instance is lazily create using the parameter pass into the fire method fire option select j file chooser pane option sheet event sheet event null guarantee to a non null array object listener listener list get listener list process the listener last to first notify those that are interest in event i listener length 2 i 0 i 2 listener i sheet listener lazily create the event sheet event null sheet event sheet event pane option null sheet listener listener i+1 option select sheet event display an option pane a a sheet on it parent window param pane the option pane param parent component the parent of the option pane param listener the listener sheet event show sheet j option pane pane component parent component sheet listener listener j sheet sheet create sheet pane parent component style from message type pane get message type sheet add sheet listener listener sheet show bring up a sheet with the option i yes i i no i and i cancel i param parent component determine the code frame code in which the sheet is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display ??? param listener the listener sheet event show confirm sheet component parent component object message sheet listener listener show confirm sheet parent component message j option pane y e s n o c a n c e l o p t i o n listener bring up a sheet where the number of choice is determine by the code option type code parameter param parent component determine the code frame code in which the sheet is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param option type an designate the option available on the dialog code y e s n o o p t i o n code or code y e s n o c a n c e l o p t i o n code ??? param listener the listener sheet event show confirm sheet component parent component object message option type sheet listener listener show confirm sheet parent component message option type j option pane q u e s t i o n m e s s a g e listener bring up a sheet where the number of choice is determine by the code option type code parameter where the code message type code parameter determine the icon to display the code message type code parameter is primarily use to supply a icon from the look and feel param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param option type an integer designate the option available on the dialog code y e s n o o p t i o n code or code y e s n o c a n c e l o p t i o n code param message type an integer designate the kind of message is primarily use to determine the icon from the pluggable look and feel code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code ??? param listener the listener sheet event show confirm sheet component parent component object message option type message type sheet listener listener show confirm sheet parent component message option type message type null listener bring up a sheet with a specify icon where the number of choice is determine by the code option type code parameter the code message type code parameter is primarily use to supply a icon from the look and feel param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the object to display param option type an designate the option available on the dialog code y e s n o o p t i o n code or code y e s n o c a n c e l o p t i o n code param message type an designate the kind of message is primarily use to determine the icon from the pluggable look and feel code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code param icon the icon to display in the dialog ??? param listener the listener sheet event show confirm sheet component parent component object message option type message type icon icon sheet listener listener show option sheet parent component message option type message type icon null null listener show a question message sheet request input from the user parent to code parent component code param parent component the parent code component code the dialog ??? param listener the listener sheet event show input sheet component parent component object message sheet listener listener show input sheet parent component message j option pane q u e s t i o n m e s s a g e listener show a question message sheet request input from the user and parent to code parent component code the input value will be initialize to code initial selection value code param parent component the parent code component code the dialog param message the code object code to display param initial selection value the value use to initialize the input field ??? param listener the listener sheet event show input sheet component parent component object message object initial selection value sheet listener listener show input sheet parent component message j option pane q u e s t i o n m e s s a g e null null initial selection value listener show a sheet request input from the user parent to code parent component code and message type code message type code param parent component the parent code component code the dialog param message the code object code to display param message type the type of message that is to be display code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code ??? param listener the listener sheet event show input sheet component parent component object message message type sheet listener listener show input sheet parent component message message type null null null listener prompt the user input in a sheet where the initial selection possible selection and all other option can be specify the user will able to choose from code selection value code where code null code implie the user can input whatever they wish usually by mean of a code j text field code code initial selection value code is the initial value to prompt the user with it is up to the u i to decide how best to represent the code selection value code but usually a code j combo box code code j list code or code j text field code will be use param parent component the parent code component code the dialog param message the code object code to display param message type the type of message to be display code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code param icon the code icon code image to display param selection value an array of code object code s that give the possible selection param initial selection value the value use to initialize the input field ??? param listener the listener sheet event show input sheet component parent component object message message type icon icon object selection value object initial selection value sheet listener listener j option pane pane j option pane message message type j option pane o k c a n c e l o p t i o n icon null null pane set want input true pane set selection value selection value pane set initial selection value initial selection value pane set component orientation parent component null ? j option pane get root frame parent component get component orientation style style from message type message type j sheet sheet create sheet pane parent component style pane select initial value sheet add window listener window adapter window close window event evt sheet dispose sheet add sheet listener listener sheet show sheet to front bring up an information message sheet param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display show message sheet component parent component object message show message sheet parent component message j option pane i n f o r m a t i o n m e s s a g e bring up an information message sheet param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param listener listener is notify when the sheet is dismiss show message sheet component parent component object message sheet listener listener show message sheet parent component message j option pane i n f o r m a t i o n m e s s a g e listener bring up a sheet that display a message using a icon determine by the code message type code parameter param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param message type the type of message to be display code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code show message sheet component parent component object message message type show message sheet parent component message message type null null bring up a sheet that display a message using a icon determine by the code message type code parameter param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param message type the type of message to be display code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code param listener listener is notify when the sheet is dismiss show message sheet component parent component object message message type sheet listener listener show message sheet parent component message message type null listener bring up a sheet display a message specify all parameter param parent component determine the code frame code in which the sheet is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param message type the type of message to be display code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code param icon an icon to display in the sheet that help the user identify the kind of message that is being display param listener listener is notify when the sheet is dismiss show message sheet component parent component object message message type icon icon sheet listener listener show option sheet parent component message j option pane d e f a u l t o p t i o n message type icon null null listener bring up a sheet with a specify icon where the initial choice is determine by the code initial value code parameter and the number of choice is determine by the code option type code parameter p code option type code is code y e s n o o p t i o n code or code y e s n o c a n c e l o p t i o n code and the code option code parameter is code null code then the option are supply by the look and feel p the code message type code parameter is primarily use to supply a icon from the look and feel param parent component determine the code frame code in which the dialog is display code null code or the code parent component code ha no code frame code the sheet is display a a dialog param message the code object code to display param option type an integer designate the option available on the dialog code y e s n o o p t i o n code or code y e s n o c a n c e l o p t i o n code param message type an integer designate the kind of message is primarily use to determine the icon from the pluggable look and feel code j option pane e r r o r m e s s a g e code code j option pane i n f o r m a t i o n m e s s a g e code code j option pane w a r n i n g m e s s a g e code code j option pane q u e s t i o n m e s s a g e code or code j option pane p l a i n m e s s a g e code param icon the icon to display in the dialog param option an array of object indicate the possible choice the user can make the object are component they are render properly non code string code object are render using their code to string code method parameter is code null code the option are determine by the look and feel param initial value the object that represent the selection the dialog only meaningful code option code is use can be code null code ??? param listener the listener sheet event show option sheet component parent component object message option type message type icon icon object option object initial value sheet listener listener j option pane pane j option pane message message type option type icon option initial value pane set initial value initial value pane set component orientation parent component null ? j option pane get root frame parent component get component orientation style style from message type message type j sheet sheet create sheet pane parent component style pane select initial value sheet add sheet listener listener sheet show sheet to front style from message type message type message type j option pane e r r o r m e s s a g e j root pane e r r o r d i a l o g j option pane q u e s t i o n m e s s a g e j root pane q u e s t i o n d i a l o g j option pane w a r n i n g m e s s a g e j root pane w a r n i n g d i a l o g j option pane i n f o r m a t i o n m e s s a g e j root pane i n f o r m a t i o n d i a l o g j option pane p l a i n m e s s a g e j root pane p l a i n d i a l o g j sheet create sheet j option pane pane component parent component style window window get window component parent component j sheet sheet window frame sheet j sheet frame window sheet j sheet dialog window container content pane sheet get content pane content pane set layout border layout content pane add pane border layout c e n t e r sheet set resizable false sheet add window listener window adapter get focus false count window closing window event we pane set value null window close window event we pane get value j option pane u n i n i t i a l i z e d v a l u e sheet fire option select pane window gain focus window event we once window get focus set initial focus get focus ugly dirty hack j option pane select initial value is so we call directly into the u i may cause mayhem because we override the encapsulation pane select initial value option pane u i ui pane get u i ui null ui select initial value pane get focus true sheet add component listener component adapter component show component event ce reset value to ensure closing work properly pane set value j option pane u n i n i t i a l i z e d v a l u e pane add property change listener property change listener property change property change event event let the close operation handle the closing the user close the window without select a button value null in that otherwise close the sheet sheet is visible event get source pane event get property name equal j option pane v a l u e p r o p e r t y event get value null event get value j option pane u n i n i t i a l i z e d v a l u e sheet set visible false sheet fire option select pane sheet pack sheet the specify component s toplevel code frame code or code dialog code param parent component the code component code to check a code frame code or code dialog code the code frame code or code dialog code that contain the component or the frame the component is code null code or doe not have a valid code frame code or code dialog code parent window get window component component parent component parent component null j option pane get root frame parent component frame || parent component dialog window parent component get window component parent component get parent display a save file file chooser sheet note that the text that appear in the approve button is determine by the l f param parent the parent component of the dialog can be code null code ??? param listener the listener sheet event show save sheet j file chooser chooser component parent sheet listener listener chooser set dialog type j file chooser s a v e d i a l o g show sheet chooser parent null listener display an open file file chooser sheet note that the text that appear in the approve button is determine by the l f param parent the parent component of the dialog can be code null code ??? param listener the listener sheet event show open sheet j file chooser chooser component parent sheet listener listener chooser set dialog type j file chooser o p e n d i a l o g show sheet chooser parent null listener display a custom file chooser sheet with a custom approve button param parent the parent component of the dialog can be code null code param approve button text the text of the code approve button code ??? param listener the listener sheet event show sheet j file chooser chooser component parent string approve button text sheet listener listener approve button text null chooser set approve button text approve button text chooser set dialog type j file chooser c u s t o m d i a l o g begin create dialog frame frame parent frame ? frame parent frame swing utility get ancestor of frame parent string title chooser get u i get dialog title chooser chooser get accessible context set accessible description title j sheet sheet j sheet frame sheet add sheet listener listener container content pane sheet get content pane content pane set layout border layout content pane add chooser border layout c e n t e r end create dialog action listener action listener action listener action perform action event evt option evt get action command equal approve selection option j file chooser a p p r o v e o p t i o n option j file chooser c a n c e l o p t i o n sheet hide sheet fire option select chooser option chooser remove action listener chooser add action listener action listener sheet add window listener window adapter window closing window event e sheet fire option select chooser j file chooser c a n c e l o p t i o n chooser remove action listener action listener chooser rescan current directory sheet pack sheet show sheet to front 