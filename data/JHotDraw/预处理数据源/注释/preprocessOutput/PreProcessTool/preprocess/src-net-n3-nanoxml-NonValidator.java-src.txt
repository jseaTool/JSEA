non validator java nano xml java $ revision 1 4 $ $ date 2002 02 03 21 19 38 $ $ name r e l e a s e 2 2 1 $ file is part of nano xml 2 java copyright c 2000 2002 marc de scheemaeck all right reserve software is provide a is without any express or imply warranty in no event will the author be hold liable any damage arise from the use of software permission is grant to anyone to use software any purpose include commercial application and to alter it and redistribute it freely subject to the following restriction 1 the origin of software must not be misrepresent you must not claim that you write the original software you use software in a product an acknowledgment in the product documentation would be appreciate but is not require 2 alter source version must be plainly mark a such and must not be misrepresent a being the original software 3 notice may not be remove or alter from any source distribution non validator is a concrete implementation of i xml validator which process the d t d and handle entity definition it doe not any validation itself author marc de scheemaeck version $ name r e l e a s e 2 2 1 $ $ revision 1 4 $ the parameter entity resolv contain the value attribute the different element type the stack of element to be process create the quot validator quot clean up the object when it s destroy set the parameter entity resolv param resolv the entity resolv the parameter entity resolv the entity resolv pars the d t d the validator object is responsible reading the full d t d param id the id which may be null param reader the reader to read the d t d from param entity resolv the entity resolv param external true the d t d is external java lang exception someth go wrong end internal d t d xml util error invalid input reader get system id reader get line nr str ch reader read external reader get stream level orig level reader unread ch end external d t d ch || ch || ch || ch \r reader unread ch process an element in the d t d param reader the reader to read data from param entity resolv the entity resolv java lang exception someth go wrong process element i xml reader reader i xml entity resolv entity resolv exception string str xml util read reader % ch str at 0 ch xml util skip tag reader str xml util read reader % ch str at 0 ch xml util skip comment reader process conditional section reader entity resolv e process entity reader entity resolv a process att list reader entity resolv xml util skip tag reader process a conditional section param reader the reader to read data from param entity resolv the entity resolv java lang exception someth go wrong process conditional section i xml reader reader i xml entity resolv entity resolv exception xml util skip whitespace reader null string str xml util read reader % ch str at 0 ch i xml util skip tag reader str xml util read reader % ch str at 0 ch g process ignore section reader entity resolv n xml util skip tag reader xml util check literal reader c l u d e xml util skip tag reader xml util skip whitespace reader null str xml util read reader % ch str at 0 ch xml util skip tag reader reader subread c d a t a reader reader string buffer buf string buffer 1024 ch2 subread read ch2 0 buf append ch2 subread close reader start stream string reader buf to string process an ignore section param reader the reader to read data from param entity resolv the entity resolv java lang exception someth go wrong process ignore section i xml reader reader i xml entity resolv entity resolv exception xml util check literal reader n o r e xml util skip tag reader xml util skip whitespace reader null string str xml util read reader % ch str at 0 ch xml util skip tag reader reader subread c d a t a reader reader subread close process an a t t l i s t element param reader the reader to read data from param entity resolv the entity resolv java lang exception someth go wrong process att list i xml reader reader i xml entity resolv entity resolv exception xml util check literal reader t t l i s t xml util skip tag reader xml util skip whitespace reader null string str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 reader unread ch string element name xml util scan identifier reader xml util skip whitespace reader null str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 property prop property ch reader unread ch string att name xml util scan identifier reader xml util skip whitespace reader null str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 ch ch str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 reader unread ch xml util scan identifier reader xml util skip whitespace reader null str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 ch str xml util scan identifier reader xml util skip whitespace reader null str equal f i x e d xml util skip whitespace reader null str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 reader unread ch string value xml util scan string reader % parameter entity resolv prop put att name value xml util skip whitespace reader null str xml util read reader % ch str at 0 ch % xml util process entity str reader parameter entity resolv str xml util read reader % ch str at 0 prop is empty attribute value put element name prop process an e n t i t y element param reader the reader to read data from param entity resolv the entity resolv java lang exception someth go wrong process entity i xml reader reader i xml entity resolv entity resolv exception xml util check literal reader n t i t y xml util skip tag reader xml util skip whitespace reader null ch xml util read reader \0 ch % xml util skip whitespace reader null entity resolv parameter entity resolv reader unread ch string key xml util scan identifier reader xml util skip whitespace reader null ch xml util read reader % string system id null string id null ch p xml util check literal reader u b l i c xml util skip tag reader xml util skip whitespace reader null id xml util scan string reader % parameter entity resolv xml util skip whitespace reader null system id xml util scan string reader % parameter entity resolv xml util skip whitespace reader null xml util read reader % s xml util check literal reader y s t e m xml util skip tag reader xml util skip whitespace reader null system id xml util scan string reader % parameter entity resolv xml util skip whitespace reader null xml util read reader % \ reader unread ch string value xml util scan string reader % parameter entity resolv entity resolv add internal entity key value xml util skip whitespace reader null xml util read reader % xml util skip tag reader system id null entity resolv add external entity key id system id indicate that an element ha be start param name the name of the element param system id the system id of the xml data of the element param line nr the line number in the xml data of the element element start string name string system id line nr property attrib property attribute value get name attrib null attrib property attrib property attrib clone current element push attrib indicate that the current element ha end param name the name of the element param system id the system id of the xml data of the element param line nr the line number in the xml data of the element element end string name string system id line nr nothing to method is call when the attribute of an xml element have be process there are attribute with a value which have not be specify yet they have to be put into i extra attribute i param name the name of the element param extra attribute where to put extra attribute param system id the system id of the xml data of the element param line nr the line number in the xml data of the element element attribute process string name property extra attribute string system id line nr property prop property current element pop enumeration enm prop key enm ha more element string key string enm next element extra attribute put key prop get key indicate that an attribute ha be add to the current element param key the name of the attribute param value the value of the attribute param system id the system id of the xml data of the element param line nr the line number in the xml data of the element attribute add string key string value string system id line nr property prop property current element peek prop contain key key prop remove key indicate that a p c d a t a element ha be encounter param system id the system id of the xml data of the element param line nr the line number in the xml data of the element p c data add string system id line nr nothing to 