delegation selection tool java 2 0 2006 02 21 copyright c 1996 2006 by the original author of jhotdraw and all it contributor jhotdraw org all right reserve software is the confidential and proprietary information of jhotdraw org confidential information you shall not disclose such confidential information and shall use it only in accordance with the term of the license agreement you enter into with jhotdraw org ??? a selection tool which recogniz click and popup menu trigger a click or popup trigger is encounter a hook method is call which handle the event method can be overriden in subclasse to provide customize behaviour p by tool delegate mouse event to a specific tool the figure which ha be click provide a specialize tool author wern randelshof version 2 0 2006 01 18 change to support precision coordinate popup timer add support radio button menu item add br 1 0 2003 12 01 derive from jhotdraw 5 4b1 a set of action which is apply to the drawing a set of action which is apply to a selection of figure we use timer to show a popup menu when the user press the mouse key a second without move the mouse when the popup menu is visible we not track mouse movement create a instance create a instance mouse listener method mouse press event the popup trigger ha be activate then the appropriate hook method is call x x x when we want to support multiple view we have to implement set view drawing view e get source evt is popup trigger handle popup menu evt super mouse press evt popup timer javax swing timer 1000 action listener action perform action event aevt handle popup menu evt popup timer null popup timer set repeat false popup timer start mouse listener method mouse release event the popup trigger ha be activate then the appropriate hook method is call mouse release mouse event evt popup timer null popup timer stop popup timer null super mouse release evt evt is popup trigger handle popup menu evt mouse drag mouse event evt popup timer null popup timer stop popup timer null popup menu null || popup menu is visible super mouse drag evt mouse click mouse event evt super mouse click evt evt get click count 2 handle click evt hook method which can be overriden by subclass to provide specialise behaviour in the event of a popup trigger handle popup menu mouse event evt point p point evt get x evt get y figure figure get view find figure p figure null || drawing action size 0 show popup menu figure p evt get component popup menu null show popup menu figure figure point p component c j popup menu menu j popup menu popup menu menu j menu submenu null string submenu name null link list action popup action link list action figure null link list action figure action link list action figure get action view to drawing p popup action size 0 figure action size 0 popup action add null popup action add all figure action popup action size 0 selection action size 0 popup action add null popup action add all selection action popup action size 0 drawing action size 0 popup action add null popup action add all drawing action hash map object button group button group hash map object button group action a popup action a null a get value action s u b m e n u k e y null submenu name null || submenu name equal a get value action s u b m e n u k e y submenu name string a get value action s u b m e n u k e y submenu j menu submenu name menu add submenu submenu name null submenu null a null submenu null submenu add separator menu add separator button button a get value action b u t t o n g r o u p k e y null button group bg button group get a get value action b u t t o n g r o u p k e y bg null bg button group button group put a get value action b u t t o n g r o u p k e y bg button j radio button menu item a bg add button button set select a get value action s e l e c t e d k e y t r u e a get value action s e l e c t e d k e y null button j check box menu item a button set select a get value action s e l e c t e d k e y t r u e button j menu item a submenu null submenu add button menu add button menu show c p x p y hook method which can be overriden by subclass to provide specialise behaviour in the event of a click handle click mouse event evt drawing view v get view point po point evt get x evt get y handle handle v find handle po handle null handle track click po evt get modifier ex point2 d p view to drawing po figure out figure get view find figure po figure figure out figure figure null tool figure tool figure get tool p figure tool null figure get drawing find figure inside p figure null figure tool figure get tool p figure tool null set tracker figure tool figure tool mouse press evt out figure handle mouse click p evt get view v clear selection v add to selection out figure v clear selection v add to selection out figure v set handle detail level v get handle detail level 1 ? 0 1 v set handle detail level v get handle detail level + 1 