std xml builder java nano xml java $ revision 1 3 $ $ date 2002 01 04 21 03 28 $ $ name r e l e a s e 2 2 1 $ file is part of nano xml 2 java copyright c 2000 2002 marc de scheemaeck all right reserve software is provide a is without any express or imply warranty in no event will the author be hold liable any damage arise from the use of software permission is grant to anyone to use software any purpose include commercial application and to alter it and redistribute it freely subject to the following restriction 1 the origin of software must not be misrepresent you must not claim that you write the original software you use software in a product an acknowledgment in the product documentation would be appreciate but is not require 2 alter source version must be plainly mark a such and must not be misrepresent a being the original software 3 notice may not be remove or alter from any source distribution std xml builder is a concrete implementation of i xml builder which create a tree of i xml element from an xml data source see net n3 nanoxml xml element author marc de scheemaeck version $ name r e l e a s e 2 2 1 $ $ revision 1 3 $ stack contain the current element and it parent the root element of the parse xml tree prototype element create the tree create the builder create the builder param prototype the prototype to use when building the tree clean up the object when it s destroy method is call before the parser start processing it input param system id the system id of the xml data source param line nr the line on which the parse start method is call when a processing instruction is encounter p is with target xml are handle by the parser param target the p i target param reader to read the data from the p i nothing to method is call when a xml element is encounter see end element param name the name of the element param n prefix the prefix use to identify the namespace no namespace ha be specify parameter is null param n u r i the u r i associate with the namespace no namespace ha be specify or no u r i is associate with n prefix parameter is null param system id the system id of the xml data source param line nr the line in the source where the element start start element string name string n prefix string n u r i string system id line nr string full name name n prefix null full name n prefix + + name i xml element elt prototype create element full name n u r i system id line nr stack empty root elt i xml element top i xml element stack peek top add child elt stack push elt method is call when the attribute of an xml element have be process see start element see add attribute param name the name of the element param n prefix the prefix use to identify the namespace no namespace ha be specify parameter is null param n u r i the u r i associate with the namespace no namespace ha be specify or no u r i is associate with n prefix parameter is null element attribute process string name string n prefix string n u r i nothing to method is call when the end of an xml elemnt is encounter see start element param name the name of the element param n prefix the prefix use to identify the namespace no namespace ha be specify parameter is null param n u r i the u r i associate with the namespace no namespace ha be specify or no u r i is associate with n prefix parameter is null end element string name string n prefix string n u r i i xml element elt i xml element stack pop elt get child count 1 i xml element child elt get child at index 0 child get name null elt set content child get content elt remove child at index 0 method is call when a attribute of an xml element is encounter param key the key name of the attribute param n prefix the prefix use to identify the namespace no namespace ha be specify parameter is null param n u r i the u r i associate with the namespace no namespace ha be specify or no u r i is associate with n prefix parameter is null param value the value of the attribute param type the type of the attribute no type is know c d a t a is java lang exception an exception occur processing the event add attribute string key string n prefix string n u r i string value string type exception string full name key n prefix null full name n prefix + + key i xml element top i xml element stack peek top ha attribute full name xml parse exception top get system id top get line nr duplicate attribute + key n prefix null top set attribute full name n u r i value top set attribute full name value method is call when a p c d a t a element is encounter a java reader is supply from which you can read the data the reader will only read the data of the element you don t need to check boundary you don t read the full element the rest of the data is skip you also don t have to care about entity they are resolve by the parser param reader the java reader from which you can retrieve the data param system id the system id of the xml data source param line nr the line in the source where the element start add p c data reader reader string system id line nr buf size 2048 size read 0 string buffer str string buffer buf size buf buf size size read buf size buf size 2 str ensure capacity buf size size size reader read buf i o exception e size 0 str append buf 0 size size read + size i xml element elt prototype create element null system id line nr elt set content str to string stack empty i xml element top i xml element stack peek top add child elt the result of the building process method is call just before the i parse i method of i xml parser see net n3 nanoxml i xml parser parse the result of the building process object get result root 