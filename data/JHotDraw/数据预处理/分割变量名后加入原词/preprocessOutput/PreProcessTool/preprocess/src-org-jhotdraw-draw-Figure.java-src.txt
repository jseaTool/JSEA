Figure figure java 3 3 0 0 2006 2006 01 01 20 20 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org package org org jhotdraw jhotdraw draw draw import org org jhotdraw jhotdraw util util import java beans bean import java awt awt import java awt awt geom geom import java awt awt event event import java util util import javax javax swing swing import javax javax swing swing undo undo import javax javax swing swing event event import java io io import org org jhotdraw jhotdraw geom geom import org org jhotdraw jhotdraw xml xml DOMStorable dom storable The the interface of of a a graphical graphical figure figure p p A a Figure figure knows know its it display display box box and and can can draw draw itself itself A a figure figure can can be be composed compose of of several several figures figure To to interact interact and and manipulate manipulate with with a a figure figure it it can can provide provide Handles handle and and Connectors connector p p A a figure figure has ha a a set set of of handles handle to to manipulate manipulate its it shape shape or or attributes attribute A a figure figure has ha one one or or more more connectors connector that that define define how how to to locate locate a a connection connection point point p p Figures figure can can have have an an open open ended end set set of of attributes attribute An an attribute attribute is is identified identify by by an an AttributeKey attribute key p p Default implementations for the the Figure figure interface are are provided provide by by AbstractFigure figure author author Werner wern Randelshofer randelshof version 3 3 0 0 2006 2006 01 01 20 20 Reworked rework for J2SE j2 s e 1 1 5 5 public interface Figure figure extends Cloneable cloneable Serializable serializable DOMStorable dom storable DRAWING d r a w i n g Draws draw the the figure figure and and its it decorator decorator figure figure param g g The the Graphics2D graphics2 d to to draw draw to to public void draw draw Graphics2D graphics2 d g g Gets get the the layer layer of of the the figure figure The the layer layer is is used use to to determine determine the the z z ordering ordering of of a a figure figure inside inside of of a a drawing drawing Figures figure with with a a higher high layer layer number number are are drawn draw after after figures figure with with a a lower lower number number The the z z order order of of figures figure within within the the same same layer layer is is determined determine by by the the sequence sequence the the figures figure were be added add to to a a drawing drawing Figures figure added add later late to to a a drawn draw after after figures figure which which have have been be added add before before If a a figure figure changes change its it layer layer it it must must fire fire a a code FigureListener figure listener figureChanged figure change code event event to to its it figure figure listeners listener FIXME f i x m e Replace replace int value value by by a a Layer layer object public int getLayer get layer A a Figure figure is is only only drawn draw by by a a Drawing drawing and and by by CompositeFigure composite figure if it it is is visible visible Layouter layout s s should should ignore ignore invisible invisible figures figure too too public boolean isVisible is visible Changes change the the visible visible state state of of the the Figure figure p p The the Figure figure fires fire code FigureListener figure listener figureChanged figure change code and and code UndoableEditListener undoable edit listener undoableEditHappened undoable edit happen code if this operation operation changed change its it visible visible state state li ul public void setVisible set visible boolean newValue value BOUNDS b o u n d s Sets set the the logical logical bounds bound of of the the figure figure and and of of its it decorator decorator figure figure p p This is is used use by by Tool tool s s which which create create a a new Figure figure and and by by Tool tool s s which which connect connect a a Figure figure to to another another Figure figure p p This is is a a basic basic operation operation which which does doe not not fire fire events event param start start the the start start point point of of the the bounds bound param end end the the end end point point of of the the bounds bound see see getBounds get bound public void basicSetBounds basic set bound Point2D point2 d Double start start Point2D point2 d Double end end Returns the the start start point point of of the the bounds bound see see basicSetBounds basic set bound public Point2D point2 d Double getStartPoint get start point Returns the the end end point point of of the the bounds bound see see basicSetBounds basic set bound public Point2D point2 d Double getEndPoint get end point Returns the the logical logical bounds bound of of the the figure figure as a a a Rectangle rectangle The the logical logical bounds bound are are used use by by some some Handle handle objects for adjusting adjust the the figure figure public Rectangle2D rectangle2 d Double getBounds get bound Returns the the drawing drawing bounding bound box box of of the the figure figure and and of of its it decorator decorator figure figure This takes take line line width width line line caps cap and and other other decorations decoration into into account account Note note getDrawBounds get draw bound must must include include the the logical logical bounds bound of of the the figure figure public Rectangle2D rectangle2 d Double getDrawBounds get draw bound The the preferred prefer size size is is used use by by Layouter layout to to determine determine the the preferred prefer size size of of a a Figure figure For most most Figure figure s s this is is the the same same as a the the dimensions dimension returned by by getBounds get bound public Dimension2DDouble dimension2 d getPreferredSize get prefer size Gets get data data which which can can be be used use to to restore restore the the shape shape of of the the figure figure after after a a basicTransform basic transform has ha been be applied apply to to it it see see basicTransform basic transform AffineTransform affine transform public Object getRestoreData get restore data Restores restore the the shape shape of of the the figure figure to to a a previously previously stored store state state public void restoreTo restore to Object restoreData restore data Transforms transform the the shape shape of of the the Figure figure Transformations transformation using using double precision precision arithmethics arithmethic are are inherently inherently lossy lossy operations operation Therefore therefore it it is is recommended recommend to to use use getRestoreData get restore data restoreTo restore to to to provide provide lossless lossles undo undo redo redo functionality functionality After after the the transform transform has ha finished finish the the bounds bound of of the the decorator decorator figure figure are are changed change to to match match the the transformed transform bounds bound of of the the figure figure p p This is is a a basic basic operation operation which which does doe not not fire fire events event param tx tx The the transformation transformation public void basicTransform basic transform AffineTransform affine transform tx tx ATTRIBUTES a t t r i b u t e s Sets set an an attribute attribute of of the the figure figure AttributeKey attribute key name name and and semantics semantics are are defined define by by the the class implementing implement the the Figure figure interface p p On on an an attribute attribute change change the the Figure figure fires fire code FigureListener figure listener figureAttributeChanged figure attribute change code code UndoableEditListener undoable edit listener undoableEditHappened undoable edit happen code If the the shape shape is is affected affect by by an an attribute attribute change change code FigureListener figure listener figureChanged figure change code is is fired fire too too public void setAttribute set attribute AttributeKey attribute key key key Object value value Sets set an an attribute attribute of of the the figure figure without without firing firing events event AttributeKey attribute key name name and and semantics semantics are are defined define by by the the class implementing implement the the Figure figure interface p p Use use code AttributeKey attribute key set set code for typesafe typesafe access access to to this method see see AttributeKey attribute key set set public void basicSetAttribute basic set attribute AttributeKey attribute key key key Object value value Gets get an an attribute attribute from from the the Figure figure p p Use use code AttributeKey attribute key get get code for typesafe typesafe access access to to this method see see AttributeKey attribute key get get return Returns the the attribute attribute value value If the the Figure figure does doe not not have have an an attribute attribute with with the the specified specify key key returns key key getDefaultValue get value public Object getAttribute get attribute AttributeKey attribute key key key Returns a a view view to to all all attributes attribute of of this figure figure By by convention convention an an unmodifiable unmodifiable map map is is returned public Map map AttributeKey attribute key Object getAttributes get attribute EDITING e d i t i n g Returns true if the the user user can can manipulate manipulate this figure figure If this operation operation returns false Tool tool s s should should not not interact interact with with this figure figure public boolean isInteractive is interactive Checks check if a a point point is is contained contain by by the the figure figure p p This is is used use for hit hit testing testing by by Tool tool s s boolean contains contain Point2D point2 d Double p p Creates create handles handle used use to to manipulate manipulate the the figure figure param detailLevel detail level The the detail detail level level of of the the handles handle Usually usually this is is 0 0 for bounding bound box box handles handle and and 1 1 for point point handles handle return a a Collection collection of of handles handle see see Handle handle public Collection collection Handle handle createHandles create handle int detailLevel detail level Returns a a cursor cursor for the the specified specify location location public Cursor cursor getCursor get cursor Point2D point2 d Double p p Returns a a collection collection of of Action action s s for the the specified specify location location p p The the collection collection may may contain contain null entries entry These these entries entry are are used use interpreted interpret as a separators separator in in the the popup popup menu menu p p Actions action can can use use the the property property Figure figure ACTION a c t i o n SUBMENU s u b m e n u to to specify specify a a submenu submenu public Collection collection Action action getActions get action Point2D point2 d Double p p Returns a a specialized specialize tool tool for the the specified specify location location p p Returns null if no no specialized specialize tool tool is is available available public Tool tool getTool get tool Point2D point2 d Double p p Returns a a tooltip tooltip for the the specified specify location location public String getTooltip get tooltip Point2D point2 d Double p p CONNECTING c o n n e c t i n g Checks check if this Figure figure can can be be connected connect public boolean canConnect can connect Gets get a a connector connector for this figure figure at at the the given given location location A a figure figure can can have have different different connectors connector at at different different locations location param p p the the location location of of the the connector connector param prototype prototype The the prototype prototype used use to to create create a a connection connection or or null if unknown unknown This allows allow for specific specific connectors connector for different different connection connection figures figure public Connector connector findConnector find connector Point2D point2 d Double p p ConnectionFigure connection figure prototype prototype Gets get a a compatible compatible connector connector If the the provided provide connector connector is is part part of of this figure figure return the the connector connector If the the provided provide connector connector is is part part of of another another figure figure return a a connector connector with with the the same same semantics semantics for this figure figure Return null if no no compatible compatible connector connector is is available available public Connector connector findCompatibleConnector find compatible connector Connector connector c c boolean isStartConnector is start connector Sets set whether wheth the the connectors connector should should be be visible visible for the the specified specify courting courting connector connector Connectors connector can can be be optionally optionally visible visible public void setConnectorsVisible set connector visible boolean isVisible is visible ConnectionFigure connection figure courtingConnection courting connection Returns true if this figure figure draws draw its it connectors connector public boolean isConnectorsVisible is connector visible COMPOSITE c o m p o s i t e FIGURES f i g u r e s Checks check whether wheth the the given given figure figure is is contained contain in in this figure figure A a figure figure includes include itself itself public boolean includes include Figure figure figure figure Returns the the figure figure that that contains contain the the given given point point public Figure figure findFigureInside find figure inside Point2D point2 d Double p p Returns a a decompositon decompositon of of a a figure figure into into its it parts part A a figure figure is is considered consider as a a a part part of of itself itself public Collection collection Figure figure getDecomposition get decomposition CLONING c l o n i n g Returns a a clone clone of of the the figure figure Object clone clone After after cloning cloning a a collection collection of of figures figure the the ConnectionFigures connection figure contained contain in in this collection collection still still connect connect to to the the original original figures figure instead instead of of to to the the clones clone Using using This operation operation and and providing provide a a map map which which maps map from from the the original original collection collection of of figures figure to to the the new collection collection connections connection can can be be remapped remapp to to the the new figures figure public void remap remap Map map Figure figure Figure figure oldToNew old to EVENT e v e n t HANDLING h a n d l i n g Informs inform a a figure figure that that it it has ha been be added add to to the the specified specify drawing drawing The the figure figure must must inform inform all all FigureListeners figure listener that that it it has ha been be added add public void addNotify add notify Drawing drawing d d Informs inform a a figure figure that that it it has ha been be removed remove from from the the specified specify drawing drawing The the figure figure must must inform inform all all FigureListeners figure listener that that it it has ha been be removed remove public void removeNotify remove notify Drawing drawing d d Informs inform that that a a Figure figure is is about about to to change change its it shape shape p p code willChange will change code and and code changed change code are are typically typically used use as a pairs pair before before and and after after invoking one one or or multiple multiple basic basic methods on on the the Figure figure public void willChange will change Informs inform that that a a Figure figure changed change its it shape shape This fires fire a a code FigureListener figure listener figureChanged figure change code event event for the the current current display display bounds bound of of the the figure figure see see willChange will change public void changed change Informs inform that that a a Figure figure has ha invalidated invalidate its it display display area area and and needs need to to be be drawn draw Fires fire a a code FigureListener figure listener areaInvalidated area invalidate code event event public void invalidate invalidate Fires fire a a code FigureListener figure listener figureRequestRemove figure request remove code event event public void requestRemove request remove Handles handle a a drop drop param p p The the location location of of the the mouse mouse event event param droppedFigures drop figure The the dropped drop figures figure param view view The the drawing drawing view view which which is is the the source source of of the the mouse mouse event event return Returns true if the the figures figure should should snap snap back back to to the the location location they they were be dragged drag from from public boolean handleDrop handle drop Point2D point2 d Double p p Collection collection Figure figure droppedFigures drop figure DrawingView drawing view view view Handles handle a a mouse mouse click click param p p The the location location of of the the mouse mouse event event param evt evt The the mouse mouse event event param view view The the drawing drawing view view which which is is the the source source of of the the mouse mouse event event return Returns true if the the figure figure consumed consume the the mouse mouse click click public boolean handleMouseClick handle mouse click Point2D point2 d Double p p MouseEvent mouse event evt evt DrawingView drawing view view view Adds add a a listener listener for FigureEvent figure event s s public void addFigureListener add figure listener FigureListener figure listener l l Removes remove a a listener listener for FigureEvent figure event s s public void removeFigureListener remove figure listener FigureListener figure listener l l Adds add a a listener listener for UndoableEdit undoable edit events event public void addUndoableEditListener add undoable edit listener UndoableEditListener undoable edit listener l l Removes remove a a listener listener for UndoableEdit undoable edit events event public void removeUndoableEditListener remove undoable edit listener UndoableEditListener undoable edit listener l l Sets set a a decorator decorator figure figure Set set this to to null if no no decorator decorator is is desired desire The the decorator decorator will will use use the the same same logical logical bounds bound as a this figure figure It it will will be be drawn draw when when the the figure figure is is drawn draw public void setDecorator set decorator Figure figure newValue value Gets get the the decorator decorator figure figure public Figure figure getDecorator get decorator 