ContentReader content reader java NanoXML nano xml Java $Revision $ revision 1 1 4 4 $ $ $Date $ date 2002 2002 01 01 04 04 21 21 03 03 28 28 $ $ $Name $ name RELEASE r e l e a s e 2 2 2 2 1 1 $ $ This file is is part part of of NanoXML nano xml 2 2 for Java Copyright copyright C c 2000 2000 2002 2002 Marc marc De de Scheemaecker scheemaeck All all Rights right Reserved reserve This software software is is provided provide as a is is without without any any express express or or implied imply warranty warranty In in no no event event will will the the authors author be be held hold liable liable for any any damages damage arising arise from from the the use use of of this software software Permission permission is is granted grant to to anyone anyone to to use use this software software for any any purpose purpose including include commercial commercial applications application and and to to alter alter it it and and redistribute redistribute it it freely freely subject subject to to the the following following restrictions restriction 1 1 The the origin origin of of this software software must must not not be be misrepresented misrepresent you you must must not not claim claim that that you you wrote write the the original original software software If you you use use this software software in in a a product product an an acknowledgment acknowledgment in in the the product product documentation documentation would would be be appreciated appreciate but but is is not not required require 2 2 Altered alter source source versions must must be be plainly plainly marked mark as a such such and and must must not not be be misrepresented misrepresent as a being being the the original original software software 3 3 This notice notice may may not not be be removed remove or or altered alter from from any any source source distribution distribution package net net n3 n3 nanoxml nanoxml import java io io Reader reader import java io io IOException i o This reader reader reads read data data from from another another reader reader until until a a new element element has ha been be encountered encounter author author Marc marc De de Scheemaecker scheemaeck version $Name $ name RELEASE r e l e a s e 2 2 2 2 1 1 $ $ $Revision $ revision 1 1 4 4 $ $ class ContentReader content reader extends Reader reader The the encapsulated encapsulate reader reader private IXMLReader i xml reader reader reader Buffer buffer private String buffer buffer Pointer pointer into into the the buffer buffer private int bufferIndex buffer index The the entity entity resolver resolv private IXMLEntityResolver i xml entity resolv resolver resolv Creates create the the reader reader param reader reader the the encapsulated encapsulate reader reader param resolver resolv the the entity entity resolver resolv param buffer buffer data data that that has ha already already been be read read from from code reader reader code ContentReader content reader IXMLReader i xml reader reader reader IXMLEntityResolver i xml entity resolv resolver resolv String buffer buffer this reader reader reader reader this resolver resolv resolver resolv this buffer buffer buffer buffer this bufferIndex buffer index 0 0 Cleans clean up up the the object when when it it s s destroyed destroy protected void finalize finalize throws Throwable throwable this reader reader null this resolver resolv null this buffer buffer null super finalize finalize Reads read a a block block of of data data param outputBuffer output buffer where where to to put put the the read read data data param offset offset first first position position in in buffer buffer to to put put the the data data param size size maximum maximum number number of of chars to to read read return the the number number of of chars read read or or 1 1 if at at EOF e o f throws java io io IOException i o if an an error occurred occur reading reading the the data data public int read read char outputBuffer output buffer int offset offset int size size throws IOException i o try int charsRead read 0 0 int bufferLength buffer length this buffer buffer length length if offset offset + + size size outputBuffer output buffer length length size size outputBuffer output buffer length length offset offset while charsRead read size size String str str char ch ch if this bufferIndex buffer index bufferLength buffer length str str XMLUtil xml util read read this reader reader ch ch str str charAt at 0 0 else ch ch this buffer buffer charAt at this bufferIndex buffer index this bufferIndex++ buffer index++ outputBuffer output buffer charsRead read ch ch charsRead++ read++ continue don t t interprete interprete chars in in the the buffer buffer if ch ch this reader reader unread unread ch ch break if ch ch str str length length 1 1 if str str charAt at 1 1 ch ch XMLUtil xml util processCharLiteral process literal str str else XMLUtil xml util processEntity process entity str str this reader reader this resolver resolv continue outputBuffer output buffer charsRead read ch ch charsRead++ read++ if charsRead read 0 0 charsRead read 1 1 return charsRead read catch XMLParseException xml parse e e throw new IOException i o e e getMessage get message Skips skip remaining remain data data and and closes close the the stream stream throws java io io IOException i o if an an error occurred occur reading reading the the data data public void close close throws IOException i o try int bufferLength buffer length this buffer buffer length length for String str str char ch ch if this bufferIndex buffer index bufferLength buffer length str str XMLUtil xml util read read this reader reader ch ch str str charAt at 0 0 else ch ch this buffer buffer charAt at this bufferIndex buffer index this bufferIndex++ buffer index++ continue don t t interprete interprete chars in in the the buffer buffer if ch ch this reader reader unread unread ch ch break if ch ch str str length length 1 1 if str str charAt at 1 1 XMLUtil xml util processEntity process entity str str this reader reader this resolver resolv catch XMLParseException xml parse e e throw new IOException i o e e getMessage get message 