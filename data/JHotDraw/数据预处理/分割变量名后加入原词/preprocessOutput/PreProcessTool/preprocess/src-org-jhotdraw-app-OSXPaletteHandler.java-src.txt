FloatingPaletteHandler floating palette handler java 1 1 1 1 2006 2006 06 06 11 11 Copyright copyright c c 2005 2005 2006 2006 Werner wern Randelshofer randelshof Staldenmattweg staldenmattweg 2 2 Immensee immensee CH c h 6405 6405 Switzerland switzerland All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of Werner wern Randelshofer randelshof Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with Werner wern Randelshofer randelshof package org org jhotdraw jhotdraw app app import java awt awt import java awt awt event event import java util util prefs pref import javax javax swing swing import java util util Hides hide all all registered register floating floating palettes palette if none none of of the the registered register project project windows window has ha focus focus anymore anymore author author Werner wern Randelshofer randelshof version 1 1 1 1 2006 2006 06 06 11 11 Palettes palette can can now now be be any any subclass subclass of of java awt awt Window window br 1 1 0 0 October october 9 9 2005 2005 Created create public class OSXPaletteHandler o s x palette handler private HashSet hash set Window window palettes palette new HashSet hash set Window window private HashMap hash map Window window Project project windows window new HashMap hash map Window window Project project private static OSXPaletteHandler o s x palette handler instance instance private javax javax swing swing Timer timer timer timer private DefaultOSXApplication o s x application app app private WindowFocusListener window focus listener focusHandler focus handler new WindowFocusListener window focus listener Invoked when when the the Window window is is set set to to be be the the focused focus Window window which which means mean that that the the Window window or or one one of of its it subcomponents subcomponent will will receive receive keyboard keyboard events event public void windowGainedFocus window gain focus WindowEvent window event e e timer timer stop stop if windows window containsKey contain key e e getWindow get window app app setCurrentProject set current project Project project windows window get get e e getWindow get window showPalettes show palette Invoked when when the the Window window is is no no longer longer the the focused focus Window window which which means mean that that keyboard keyboard events event will will no no longer longer be be delivered deliver to to the the Window window or or any any of of its it subcomponents subcomponent public void windowLostFocus window lost focus WindowEvent window event e e timer timer restart restart Creates create a a new instance instance public OSXPaletteHandler o s x palette handler DefaultOSXApplication o s x application app app this app app app app timer timer new javax javax swing swing Timer timer 60 60 new ActionListener action listener public void actionPerformed action perform ActionEvent action event evt evt maybeHidePalettes maybe hide palette timer timer setRepeats set repeat false public void add add Window window window window Project project project project window window addWindowFocusListener add window focus listener focusHandler focus handler windows window put put window window project project public void remove remove Window window window window Project project project project windows window remove remove window window window window removeWindowFocusListener remove window focus listener focusHandler focus handler public void addPalette add palette Window window palette palette palette palette addWindowFocusListener add window focus listener focusHandler focus handler palettes palette add add palette palette public void removePalette remove palette Window window palette palette palettes palette remove remove palette palette palette palette removeWindowFocusListener remove window focus listener focusHandler focus handler public Set set Window window getPalettes get palette return Collections collection unmodifiableSet unmodifiable set palettes palette private void showPalettes show palette for Window window palette palette palettes palette if palette palette isVisible is visible palette palette setVisible set visible true private boolean isFocused is focus Window window w w if w w isFocused is focus return true Window window ownedWindows own window w w getOwnedWindows get own window for int i i 0 0 i i ownedWindows own window length length i++ i++ if isFocused is focus ownedWindows own window i i return true return false private void maybeHidePalettes maybe hide palette boolean hasFocus ha focus false for Window window window window windows window keySet key set if isFocused is focus window window hasFocus ha focus true break if hasFocus ha focus windows window size size 0 0 for Window window palette palette palettes palette if isFocused is focus palette palette hasFocus ha focus true break if hasFocus ha focus for Window window palette palette palettes palette palette palette setVisible set visible false 