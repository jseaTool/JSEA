XMLUtil xml util java NanoXML nano xml Java $Revision $ revision 1 1 5 5 $ $ $Date $ date 2002 2002 02 02 03 03 21 21 19 19 38 38 $ $ $Name $ name RELEASE r e l e a s e 2 2 2 2 1 1 $ $ This file is is part part of of NanoXML nano xml 2 2 for Java Copyright copyright C c 2000 2000 2002 2002 Marc marc De de Scheemaecker scheemaeck All all Rights right Reserved reserve This software software is is provided provide as a is is without without any any express express or or implied imply warranty warranty In in no no event event will will the the authors author be be held hold liable liable for any any damages damage arising arise from from the the use use of of this software software Permission permission is is granted grant to to anyone anyone to to use use this software software for any any purpose purpose including include commercial commercial applications application and and to to alter alter it it and and redistribute redistribute it it freely freely subject subject to to the the following following restrictions restriction 1 1 The the origin origin of of this software software must must not not be be misrepresented misrepresent you you must must not not claim claim that that you you wrote write the the original original software software If you you use use this software software in in a a product product an an acknowledgment acknowledgment in in the the product product documentation documentation would would be be appreciated appreciate but but is is not not required require 2 2 Altered alter source source versions must must be be plainly plainly marked mark as a such such and and must must not not be be misrepresented misrepresent as a being being the the original original software software 3 3 This notice notice may may not not be be removed remove or or altered alter from from any any source source distribution distribution package net net n3 n3 nanoxml nanoxml import java io io IOException i o import java io io Reader reader import java io io CharArrayReader reader Utility utility methods for NanoXML nano xml author author Marc marc De de Scheemaecker scheemaeck version $Name $ name RELEASE r e l e a s e 2 2 2 2 1 1 $ $ $Revision $ revision 1 1 5 5 $ $ class XMLUtil xml util Skips skip the the remainder remainder of of a a comment comment It it is is assumed assume that that lt lt is is already already read read param reader reader the the reader reader throws java io io IOException i o if an an error occurred occur reading reading the the data data static void skipComment skip comment IXMLReader i xml reader reader reader throws IOException i o XMLParseException xml parse if reader reader read read XMLUtil xml util errorExpectedInput expect input reader reader getSystemID get reader reader getLineNr get line nr int dashesRead dash read 0 0 for char ch ch reader reader read read switch ch ch case dashesRead++ dash read++ break case if dashesRead dash read 2 2 return default dashesRead dash read 0 0 Skips skip the the remainder remainder of of the the current current XML xml tag tag param reader reader the the reader reader throws java io io IOException i o if an an error occurred occur reading reading the the data data static void skipTag skip tag IXMLReader i xml reader reader reader throws IOException i o XMLParseException xml parse int level level 1 1 while level level 0 0 char ch ch reader reader read read switch ch ch case ++level ++level break case level level break Scans scan a a public ID param publicID will will contain contain the the public ID param reader reader the the reader reader return the the system ID throws java io io IOException i o if an an error occurred occur reading reading the the data data static String scanPublicID scan StringBuffer buffer publicID IXMLReader i xml reader reader reader throws IOException i o XMLParseException xml parse if XMLUtil xml util checkLiteral check literal reader reader UBLIC u b l i c return null XMLUtil xml util skipWhitespace skip whitespace reader reader null publicID append append XMLUtil xml util scanString scan reader reader \0 \0 null XMLUtil xml util skipWhitespace skip whitespace reader reader null return XMLUtil xml util scanString scan reader reader \0 \0 null Scans scan a a system ID param reader reader the the reader reader return the the system ID throws java io io IOException i o if an an error occurred occur reading reading the the data data static String scanSystemID scan IXMLReader i xml reader reader reader throws IOException i o XMLParseException xml parse if XMLUtil xml util checkLiteral check literal reader reader YSTEM y s t e m return null XMLUtil xml util skipWhitespace skip whitespace reader reader null return XMLUtil xml util scanString scan reader reader \0 \0 null Retrieves retrieve an an identifier identifier from from the the data data param reader reader the the reader reader throws java io io IOException i o if an an error occurred occur reading reading the the data data static String scanIdentifier scan identifier IXMLReader i xml reader reader reader throws IOException i o XMLParseException xml parse StringBuffer buffer result result new StringBuffer buffer for char ch ch reader reader read read if ch ch || || ch ch || || ch ch || || ch ch || || ch ch a a ch ch z z || || ch ch A a ch ch Z z || || ch ch 0 0 ch ch 9 9 || || ch ch \u007E \u007 e result result append append ch ch else reader reader unread unread ch ch break return result result toString to Retrieves retrieve a a delimited delimit string from from the the data data param reader reader the the reader reader param entityChar entity the the escape escape character character amp amp or or % % param entityResolver entity resolv the the entity entity resolver resolv throws java io io IOException i o if an an error occurred occur reading reading the the data data static String scanString scan IXMLReader i xml reader reader reader char entityChar entity IXMLEntityResolver i xml entity resolv entityResolver entity resolv throws IOException i o XMLParseException xml parse StringBuffer buffer result result new StringBuffer buffer int startingLevel starting level reader reader getStreamLevel get stream level char delim delim reader reader read read if delim delim \ \ delim delim XMLUtil xml util errorExpectedInput expect input reader reader getSystemID get reader reader getLineNr get line nr delimited delimit string for String str str XMLUtil xml util read read reader reader entityChar entity char ch ch str str charAt at 0 0 if ch ch entityChar entity if str str charAt at 1 1 result result append append XMLUtil xml util processCharLiteral process literal str str else XMLUtil xml util processEntity process entity str str reader reader entityResolver entity resolv else if ch ch reader reader unread unread ch ch str str XMLUtil xml util read read reader reader if str str charAt at 1 1 result result append append XMLUtil xml util processCharLiteral process literal str str else result result append append str str else if reader reader getStreamLevel get stream level startingLevel starting level if ch ch delim delim break else if ch ch 9 9 || || ch ch 10 10 || || ch ch 13 13 result result append append else result result append append ch ch else result result append append ch ch return result result toString to Processes process an an entity entity param entity entity the the entity entity param reader reader the the reader reader param entityResolver entity resolv the the entity entity resolver resolv throws java io io IOException i o if an an error occurred occur reading reading the the data data static void processEntity process entity String entity entity IXMLReader i xml reader reader reader IXMLEntityResolver i xml entity resolv entityResolver entity resolv throws IOException i o XMLParseException xml parse entity entity entity entity substring substring 1 1 entity entity length length 1 1 Reader reader entityReader entity reader entityResolver entity resolv getEntity get entity reader reader entity entity if entityReader entity reader null XMLUtil xml util errorInvalidEntity invalid entity reader reader getSystemID get reader reader getLineNr get line nr entity entity boolean externalEntity external entity entityResolver entity resolv isExternalEntity is external entity entity entity reader reader startNewStream start stream entityReader entity reader externalEntity external entity Processes process a a character character literal literal param entity entity the the entity entity throws java io io IOException i o if an an error occurred occur reading reading the the data data static char processCharLiteral process literal String entity entity throws IOException i o XMLParseException xml parse if entity entity charAt at 2 2 x x entity entity entity entity substring substring 3 3 entity entity length length 1 1 return char Integer parseInt parse entity entity 16 16 else entity entity entity entity substring substring 2 2 entity entity length length 1 1 return char Integer parseInt parse entity entity 10 10 Skips skip whitespace whitespace from from the the reader reader param reader reader the the reader reader param buffer buffer where where to to put put the the whitespace whitespace null if the the whitespace whitespace does doe not not have have to to be be stored store throws java io io IOException i o if an an error occurred occur reading reading the the data data static void skipWhitespace skip whitespace IXMLReader i xml reader reader reader StringBuffer buffer buffer buffer throws IOException i o char ch ch if buffer buffer null do ch ch reader reader read read while ch ch || || ch ch || || ch ch else for ch ch reader reader read read if ch ch ch ch ch ch break if ch ch buffer buffer append append else buffer buffer append append reader reader unread unread ch ch Reads read a a character character from from the the reader reader param reader reader the the reader reader param entityChar entity the the escape escape character character amp amp or or % % used use to to indicate indicate an an entity entity return the the character character or or an an entity entity expression expression like like e e g g amp amp lt lt throws java io io IOException i o if an an error occurred occur reading reading the the data data static String read read IXMLReader i xml reader reader reader char entityChar entity throws IOException i o XMLParseException xml parse char ch ch reader reader read read StringBuffer buffer buf buf new StringBuffer buffer buf buf append append ch ch if ch ch entityChar entity while ch ch ch ch reader reader read read buf buf append append ch ch return buf buf toString to Reads read a a character character from from the the reader reader disallowing disallow entities entity param reader reader the the reader reader param entityChar entity the the escape escape character character amp amp or or % % used use to to indicate indicate an an entity entity static char readChar read IXMLReader i xml reader reader reader char entityChar entity throws IOException i o XMLParseException xml parse String str str XMLUtil xml util read read reader reader entityChar entity char ch ch str str charAt at 0 0 if ch ch entityChar entity XMLUtil xml util errorUnexpectedEntity unexpect entity reader reader getSystemID get reader reader getLineNr get line nr str str return ch ch Returns true if the the data data starts start with with I i literal literal I i Enough enough chars are are read read to to determine determine this result result param reader reader the the reader reader param literal literal the the literal literal to to check check throws java io io IOException i o if an an error occurred occur reading reading the the data data static boolean checkLiteral check literal IXMLReader i xml reader reader reader String literal literal throws IOException i o XMLParseException xml parse for int i i 0 0 i i literal literal length length i++ i++ if reader reader read read literal literal charAt at i i return false return true Throws an an XMLParseException xml parse to to indicate indicate that that an an expected expect string is is not not encountered encounter param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param expectedString expect the the string that that is is expected expect static void errorExpectedInput expect input String systemID int lineNr line nr String expectedString expect throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr Expected expect + + expectedString expect Throws an an XMLParseException xml parse to to indicate indicate that that an an entity entity could could not not be be resolved resolve param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param entity entity the the name name of of the the entity entity static void errorInvalidEntity invalid entity String systemID int lineNr line nr String entity entity throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr Invalid invalid entity entity ` ` + + entity entity + + Throws an an XMLParseException xml parse to to indicate indicate that that an an entity entity reference reference is is unexpected unexpect at at this point point param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param entity entity the the name name of of the the entity entity static void errorUnexpectedEntity unexpect entity String systemID int lineNr line nr String entity entity throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr No no entity entity reference reference is is expected expect here here + + entity entity + + Throws an an XMLParseException xml parse to to indicate indicate that that a a CDATA c d a t a section section is is unexpected unexpect at at this point point param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source static void errorUnexpectedCDATA unexpect c d a t a String systemID int lineNr line nr throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr No no CDATA c d a t a section section is is expected expect here here Throws an an XMLParseException xml parse to to indicate indicate that that a a string is is not not expected expect at at this point point param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param unexpectedString unexpect the the string that that is is unexpected unexpect static void errorInvalidInput invalid input String systemID int lineNr line nr String unexpectedString unexpect throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr Invalid invalid input input + + unexpectedString unexpect Throws an an XMLParseException xml parse to to indicate indicate that that the the closing closing tag tag of of an an element element does doe not not match match the the opening opening tag tag param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param expectedName expect name the the name name of of the the opening opening tag tag param wrongName wrong name the the name name of of the the closing closing tag tag static void errorWrongClosingTag wrong closing tag String systemID int lineNr line nr String expectedName expect name String wrongName wrong name throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr Closing closing tag tag does doe not not match match opening opening tag tag ` ` + + wrongName wrong name + + ` ` + + expectedName expect name + + Throws an an XMLParseException xml parse to to indicate indicate that that extra extra data data is is encountered encounter in in a a closing closing tag tag param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source static void errorClosingTagNotEmpty closing tag not empty String systemID int lineNr line nr throws XMLParseException xml parse throw new XMLParseException xml parse systemID lineNr line nr Closing closing tag tag must must be be empty empty Throws an an XMLValidationException xml validation to to indicate indicate that that an an element element is is missing miss param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param parentElementName parent element name the the name name of of the the parent parent element element param missingElementName miss element name the the name name of of the the missing miss element element static void errorMissingElement miss element String systemID int lineNr line nr String parentElementName parent element name String missingElementName miss element name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation MISSING m i s s i n g ELEMENT e l e m e n t systemID lineNr line nr missingElementName miss element name attributeName attribute name null attributeValue attribute value null Element element + + parentElementName parent element name + + expects expect to to have have a a + + missingElementName miss element name Throws an an XMLValidationException xml validation to to indicate indicate that that an an element element is is unexpected unexpect param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param parentElementName parent element name the the name name of of the the parent parent element element param unexpectedElementName unexpect element name the the name name of of the the unexpected unexpect element element static void errorUnexpectedElement unexpect element String systemID int lineNr line nr String parentElementName parent element name String unexpectedElementName unexpect element name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation UNEXPECTED u n e x p e c t e d ELEMENT e l e m e n t systemID lineNr line nr unexpectedElementName unexpect element name attributeName attribute name null attributeValue attribute value null Unexpected unexpect + + unexpectedElementName unexpect element name + + in in a a + + parentElementName parent element name Throws an an XMLValidationException xml validation to to indicate indicate that that an an attribute attribute is is missing miss param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param elementName element name the the name name of of the the element element param attributeName attribute name the the name name of of the the missing miss attribute attribute static void errorMissingAttribute miss attribute String systemID int lineNr line nr String elementName element name String attributeName attribute name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation MISSING m i s s i n g ATTRIBUTE a t t r i b u t e systemID lineNr line nr elementName element name attributeName attribute name attributeValue attribute value null Element element + + elementName element name + + expects expect an an attribute attribute named name + + attributeName attribute name Throws an an XMLValidationException xml validation to to indicate indicate that that an an attribute attribute is is unexpected unexpect param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param elementName element name the the name name of of the the element element param attributeName attribute name the the name name of of the the unexpected unexpect attribute attribute static void errorUnexpectedAttribute unexpect attribute String systemID int lineNr line nr String elementName element name String attributeName attribute name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation UNEXPECTED u n e x p e c t e d ATTRIBUTE a t t r i b u t e systemID lineNr line nr elementName element name attributeName attribute name attributeValue attribute value null Element element + + elementName element name + + did not not expect expect an an attribute attribute + + named name + + attributeName attribute name Throws an an XMLValidationException xml validation to to indicate indicate that that an an attribute attribute has ha an an invalid invalid value value param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param elementName element name the the name name of of the the element element param attributeName attribute name the the name name of of the the attribute attribute param attributeValue attribute value the the value value of of that that attribute attribute static void errorInvalidAttributeValue invalid attribute value String systemID int lineNr line nr String elementName element name String attributeName attribute name String attributeValue attribute value throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation ATTRIBUTE a t t r i b u t e WITH w i t h INVALID i n v a l VALUE v a l u e systemID lineNr line nr elementName element name attributeName attribute name attributeValue attribute value Invalid invalid value value for attribute attribute + + attributeName attribute name Throws an an XMLValidationException xml validation to to indicate indicate that that a a PCDATA p c d a t a element element was wa missing miss param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param parentElementName parent element name the the name name of of the the parent parent element element static void errorMissingPCData miss p c data String systemID int lineNr line nr String parentElementName parent element name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation MISSING m i s s i n g PCDATA p c d a t a systemID lineNr line nr elementName element name null attributeName attribute name null attributeValue attribute value null Missing miss PCDATA p c d a t a in in element element + + parentElementName parent element name Throws an an XMLValidationException xml validation to to indicate indicate that that a a PCDATA p c d a t a element element was wa unexpected unexpect param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param parentElementName parent element name the the name name of of the the parent parent element element static void errorUnexpectedPCData unexpect p c data String systemID int lineNr line nr String parentElementName parent element name throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation UNEXPECTED u n e x p e c t e d PCDATA p c d a t a systemID lineNr line nr elementName element name null attributeName attribute name null attributeValue attribute value null Unexpected unexpect PCDATA p c d a t a in in element element + + parentElementName parent element name Throws an an XMLValidationException xml validation param systemID the the system ID of of the the data data source source param lineNr line nr the the line line number number in in the the data data source source param message message the the error message message param elementName element name the the name name of of the the element element param attributeName attribute name the the name name of of the the attribute attribute param attributeValue attribute value the the value value of of that that attribute attribute static void validationError validation String systemID int lineNr line nr String message message String elementName element name String attributeName attribute name String attributeValue attribute value throws XMLValidationException xml validation throw new XMLValidationException xml validation XMLValidationException xml validation MISC m i s c ERROR e r r o r systemID lineNr line nr elementName element name attributeName attribute name attributeValue attribute value message message 