ToolBarPrefsHandler tool bar pref handler java 1 1 1 1 2006 2006 06 06 15 15 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org package org org jhotdraw jhotdraw util util prefs pref import java awt awt import java awt awt event event import java util util prefs pref import javax javax swing swing import javax javax swing swing plaf plaf basic basic import javax javax swing swing event event ToolBarPrefsHandler tool bar pref handler author author Werner wern Randelshofer randelshof version 1 1 1 1 2006 2006 06 06 15 15 Code added add to to work work with with ToolBarUI tool bar u i s s that that don t t extend extend BasicToolBarUI basic tool bar u i br 1 1 0 0 2 2 April april 2004 2004 Created create public class ToolBarPrefsHandler tool bar pref handler implements ComponentListener component listener AncestorListener ancestor listener private JToolBar j tool bar toolbar toolbar private String prefsPrefix pref prefix private Preferences preference prefs pref private boolean firstTimeShown first time show public ToolBarPrefsHandler tool bar pref handler JToolBar j tool bar toolbar toolbar String prefsPrefix pref prefix Preferences preference prefs pref this toolbar toolbar toolbar toolbar this prefsPrefix pref prefix prefsPrefix pref prefix this prefs pref prefs pref String constraint constraint prefs pref get get prefsPrefix+ pref prefix+ constraint constraint BorderLayout border layout NORTH n o r t h int orientation orientation constraint constraint equals equal BorderLayout border layout NORTH n o r t h || || constraint constraint equals equal BorderLayout border layout SOUTH s o u t h ? ? JToolBar j tool bar HORIZONTAL h o r i z o n t a l JToolBar j tool bar VERTICAL v e r t i c a l toolbar toolbar setOrientation set orientation orientation orientation toolbar toolbar getParent get parent add add constraint constraint toolbar toolbar toolbar toolbar setVisible set visible prefs pref getBoolean get prefsPrefix+ pref prefix+ visible visible true if prefs pref getBoolean get prefsPrefix+ pref prefix+ isFloating is floating false makeToolBarFloat make tool bar toolbar toolbar addComponentListener add component listener this toolbar toolbar addAncestorListener add ancestor listener this XXX x x x This does doe not not work work private void makeToolBarFloat make tool bar BasicToolBarUI basic tool bar u i ui ui BasicToolBarUI basic tool bar u i toolbar toolbar getUI get u i Window window window window SwingUtilities swing utility getWindowAncestor get window ancestor toolbar toolbar System out out println Window window Ancestor ancestor +window+ +window+ instanceof Frame frame + + window window instanceof Frame frame ui ui setFloating set floating true new Point point prefs pref getInt get prefsPrefix+ pref prefix+ floatingX floating x 0 0 prefs pref getInt get prefsPrefix+ pref prefix+ floatingY floating y 0 0 window window SwingUtilities swing utility getWindowAncestor get window ancestor toolbar toolbar window window setLocation set location prefs pref getInt get prefsPrefix+ pref prefix+ floatingX floating x 0 0 prefs pref getInt get prefsPrefix+ pref prefix+ floatingY floating y 0 0 window window toFront to front public void componentHidden component hide ComponentEvent component event e e prefs pref putBoolean put prefsPrefix+ pref prefix+ visible visible false public void componentMoved component move ComponentEvent component event e e locationChanged location change private void locationChanged location change FIXME f i x m e use use reflection reflection to to get get hold hold of of method isFloating is floating if toolbar toolbar getUI get u i instanceof BasicToolBarUI basic tool bar u i BasicToolBarUI basic tool bar u i ui ui BasicToolBarUI basic tool bar u i toolbar toolbar getUI get u i boolean floating floating ui ui isFloating is floating prefs pref putBoolean put prefsPrefix+ pref prefix+ isFloating is floating floating floating if floating floating Window window window window SwingUtilities swing utility getWindowAncestor get window ancestor toolbar toolbar prefs pref putInt put prefsPrefix+ pref prefix+ floatingX floating x window window getX get x prefs pref putInt put prefsPrefix+ pref prefix+ floatingY floating y window window getY get y else if toolbar toolbar getParent get parent null int x x toolbar toolbar getX get x int y y toolbar toolbar getY get y Insets inset insets inset toolbar toolbar getParent get parent getInsets get inset String constraint constraint if x x insets inset left left y y insets inset top top constraint constraint toolbar toolbar getOrientation get orientation JToolBar j tool bar HORIZONTAL h o r i z o n t a l ? ? BorderLayout border layout NORTH n o r t h BorderLayout border layout WEST w e s t else constraint constraint toolbar toolbar getOrientation get orientation JToolBar j tool bar HORIZONTAL h o r i z o n t a l ? ? BorderLayout border layout SOUTH s o u t h BorderLayout border layout EAST e a s t prefs pref put put prefsPrefix+ pref prefix+ constraint constraint constraint constraint else if toolbar toolbar getParent get parent null int x x toolbar toolbar getX get x int y y toolbar toolbar getY get y Insets inset insets inset toolbar toolbar getParent get parent getInsets get inset String constraint constraint if x x insets inset left left y y insets inset top top constraint constraint toolbar toolbar getOrientation get orientation JToolBar j tool bar HORIZONTAL h o r i z o n t a l ? ? BorderLayout border layout NORTH n o r t h BorderLayout border layout WEST w e s t else constraint constraint toolbar toolbar getOrientation get orientation JToolBar j tool bar HORIZONTAL h o r i z o n t a l ? ? BorderLayout border layout SOUTH s o u t h BorderLayout border layout EAST e a s t prefs pref put put prefsPrefix+ pref prefix+ constraint constraint constraint constraint public void componentResized component resize ComponentEvent component event e e locationChanged location change public void componentShown component show ComponentEvent component event e e prefs pref putBoolean put prefsPrefix+ pref prefix+ visible visible true public void ancestorAdded ancestor add AncestorEvent ancestor event event event locationChanged location change public void ancestorMoved ancestor move AncestorEvent ancestor event event event if toolbar toolbar getUI get u i instanceof BasicToolBarUI basic tool bar u i if BasicToolBarUI basic tool bar u i toolbar toolbar getUI get u i isFloating is floating locationChanged location change public void ancestorRemoved ancestor remove AncestorEvent ancestor event event event if toolbar toolbar getUI get u i instanceof BasicToolBarUI basic tool bar u i if BasicToolBarUI basic tool bar u i toolbar toolbar getUI get u i isFloating is floating locationChanged location change 