DiamondFigure diamond figure java 1 1 0 0 2006 2006 03 03 27 27 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org ??? ??? package org org jhotdraw jhotdraw draw draw import java awt awt import java awt awt geom geom import java io io import java util util import static org org jhotdraw jhotdraw draw draw AttributeKeys attribute key import org org jhotdraw jhotdraw geom geom Geom geom import org org omg omg CORBA c o r b a MARSHAL m a r s h a l A a diamond diamond with with vertices vertex at at the the midpoints midpoint of of its it enclosing enclosing rectangle rectangle author author Werner wern Randelshofer randelshof version 1 1 0 0 2006 2006 03 03 27 27 Created create public class DiamondFigure diamond figure extends AttributedFigure attribute figure If the the attribute attribute IS i s QUADRATIC q u a d r a t i c is is set set to to true all all sides side of of the the diamond diamond have have the the same same length length public final static AttributeKey attribute key Boolean IS i s QUADRATIC q u a d r a t i c new AttributeKey attribute key Boolean isQuadratic is quadratic false The the bounds bound of of the the diamond diamond figure figure private Rectangle2D rectangle2 d Double rectangle rectangle Creates create a a new instance instance public DiamondFigure diamond figure this 0 0 0 0 0 0 0 0 public DiamondFigure diamond figure double x x double y y double width width double height height rectangle rectangle new Rectangle2D rectangle2 d Double x x y y width width height height setFillColor set fill color Color color white white setStrokeColor set stroke color Color color black black DRAWING d r a w i n g protected void drawFill draw fill Graphics2D graphics2 d g g Rectangle2D rectangle2 d Double r r Rectangle2D rectangle2 d Double rectangle rectangle clone clone if isQuadratic is quadratic double side side Math math max max r r width width r r height height r r x x side side r r width width 2 2 r r y y side side r r height height 2 2 r r width width r r height height side side double grow grow AttributeKeys attribute key getPerpendicularFillGrowth get perpendicular fill growth this double growx growx growy growy if grow grow 0d 0d growx growx growy growy 0d 0d else double w w r r width width 2d 2d double h h r r height height 2d 2d double lineLength line length Math math sqrt sqrt w w w w + + h h h h double scale scale grow grow lineLength line length double yb yb scale scale w w double xa xa scale scale h h growx growx yb yb yb yb xa xa + + xa xa growy growy xa xa xa xa yb yb + + yb yb Geom geom grow grow r r growx growx growy growy GeneralPath general path diamond diamond new GeneralPath general path diamond diamond moveTo move to float r r x x + + r r width width 2 2 float r r y y diamond diamond lineTo line to float r r x x + + r r width width float r r y y + + r r height height 2 2 diamond diamond lineTo line to float r r x x + + r r width width 2 2 float r r y y + + r r height height diamond diamond lineTo line to float r r x x float r r y y + + r r height height 2 2 diamond diamond closePath close path g g fill fill diamond diamond protected void drawStroke draw stroke Graphics2D graphics2 d g g Rectangle2D rectangle2 d Double r r Rectangle2D rectangle2 d Double rectangle rectangle clone clone if isQuadratic is quadratic double side side Math math max max r r width width r r height height r r x x side side r r width width 2 2 r r y y side side r r height height 2 2 r r width width r r height height side side double grow grow AttributeKeys attribute key getPerpendicularDrawGrowth get perpendicular draw growth this double growx growx growy growy if grow grow 0d 0d growx growx growy growy 0d 0d else double w w r r width width 2d 2d double h h r r height height 2d 2d double lineLength line length Math math sqrt sqrt w w w w + + h h h h double scale scale grow grow lineLength line length double yb yb scale scale w w double xa xa scale scale h h growx growx yb yb yb yb xa xa + + xa xa growy growy xa xa xa xa yb yb + + yb yb Geom geom grow grow r r growx growx growy growy GeneralPath general path diamond diamond new GeneralPath general path diamond diamond moveTo move to float r r x x + + r r width width 2 2 float r r y y diamond diamond lineTo line to float r r x x + + r r width width float r r y y + + r r height height 2 2 diamond diamond lineTo line to float r r x x + + r r width width 2 2 float r r y y + + r r height height diamond diamond lineTo line to float r r x x float r r y y + + r r height height 2 2 diamond diamond closePath close path g g draw draw diamond diamond SHAPE s h a p e AND a n d BOUNDS b o u n d s public Rectangle2D rectangle2 d Double getBounds get bound Rectangle2D rectangle2 d Double bounds bound Rectangle2D rectangle2 d Double rectangle rectangle clone clone return bounds bound public Rectangle2D rectangle2 d Double getFigureDrawBounds get figure draw bound Rectangle2D rectangle2 d Double r r Rectangle2D rectangle2 d Double rectangle rectangle clone clone if isQuadratic is quadratic double side side Math math max max r r width width r r height height r r x x side side r r width width 2 2 r r y y side side r r height height 2 2 r r width width r r height height side side double grow grow AttributeKeys attribute key getPerpendicularHitGrowth get perpendicular hit growth this double growx growx growy growy if grow grow 0d 0d growx growx growy growy 0d 0d else double w w r r width width 2d 2d double h h r r height height 2d 2d double lineLength line length Math math sqrt sqrt w w w w + + h h h h double scale scale grow grow lineLength line length double yb yb scale scale w w double xa xa scale scale h h growx growx yb yb yb yb xa xa + + xa xa growy growy xa xa xa xa yb yb + + yb yb Geom geom grow grow r r growx growx growy growy return r r Checks check if a a Point2D point2 d Double is is inside inside the the figure figure public boolean contains contain Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r Rectangle2D rectangle2 d Double rectangle rectangle clone clone if isQuadratic is quadratic double side side Math math max max r r width width r r height height r r x x side side r r width width 2 2 r r y y side side r r height height 2 2 r r width width r r height height side side if r r contains contain p p double grow grow AttributeKeys attribute key getPerpendicularFillGrowth get perpendicular fill growth this double growx growx growy growy if grow grow 0d 0d growx growx growy growy 0d 0d else double w w r r width width 2d 2d double h h r r height height 2d 2d double lineLength line length Math math sqrt sqrt w w w w + + h h h h double scale scale grow grow lineLength line length double yb yb scale scale w w double xa xa scale scale h h growx growx yb yb yb yb xa xa + + xa xa growy growy xa xa xa xa yb yb + + yb yb Geom geom grow grow r r growx growx growy growy GeneralPath general path diamond diamond new GeneralPath general path diamond diamond moveTo move to float r r x x + + r r width width 2 2 float r r y y diamond diamond lineTo line to float r r x x + + r r width width float r r y y + + r r height height 2 2 diamond diamond lineTo line to float r r x x + + r r width width 2 2 float r r y y + + r r height height diamond diamond lineTo line to float r r x x float r r y y + + r r height height 2 2 diamond diamond closePath close path return diamond diamond contains contain p p public void basicSetBounds basic set bound Point2D point2 d Double anchor anchor Point2D point2 d Double lead rectangle rectangle x x Math math min min anchor anchor x x lead x x rectangle rectangle y y Math math min min anchor anchor y y lead y y rectangle rectangle width width Math math max max 0 0 1 1 Math math abs ab lead x x anchor anchor x x rectangle rectangle height height Math math max max 0 0 1 1 Math math abs ab lead y y anchor anchor y y Moves move the the Figure figure to to a a new location location param tx tx the the transformation transformation matrix matrix public void basicTransform basic transform AffineTransform affine transform tx tx Point2D point2 d Double anchor anchor getStartPoint get start point Point2D point2 d Double lead getEndPoint get end point basicSetBounds basic set bound Point2D point2 d Double tx tx transform transform anchor anchor anchor anchor Point2D point2 d Double tx tx transform transform lead lead public void restoreTo restore to Object geometry geometry Rectangle2D rectangle2 d Double r r Rectangle2D rectangle2 d Double geometry geometry rectangle rectangle x x r r x x rectangle rectangle y y r r y y rectangle rectangle width width r r width width rectangle rectangle height height r r height height public Object getRestoreData get restore data return rectangle rectangle clone clone ATTRIBUTES a t t r i b u t e s public boolean isQuadratic is quadratic Boolean b b Boolean getAttribute get attribute IS i s QUADRATIC q u a d r a t i c return b b null ? ? false b b booleanValue value public void setQuadratic set quadratic boolean newValue value setAttribute set attribute IS i s QUADRATIC q u a d r a t i c newValue value EDITING e d i t i n g CONNECTING c o n n e c t i n g Returns the the Figures figure connector connector for the the specified specify location location By by default a a ChopDiamondConnector chop diamond connector is is returned see see ChopDiamondConnector chop diamond connector public Connector connector findConnector find connector Point2D point2 d Double p p ConnectionFigure connection figure prototype prototype return new ChopDiamondConnector chop diamond connector this public Connector connector findCompatibleConnector find compatible connector Connector connector c c boolean isStart is start return new ChopDiamondConnector chop diamond connector this COMPOSITE c o m p o s i t e FIGURES f i g u r e s CLONING c l o n i n g public DiamondFigure diamond figure clone clone DiamondFigure diamond figure that that DiamondFigure diamond figure super clone clone that that rectangle rectangle Rectangle2D rectangle2 d Double this rectangle rectangle clone clone return that that EVENT e v e n t HANDLING h a n d l i n g 