DefaultDrawingEditor drawing editor java 3 3 0 0 2006 2006 02 02 13 13 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org ??? ??? package org org jhotdraw jhotdraw draw draw import org org jhotdraw jhotdraw beans bean import java awt awt import java awt awt datatransfer datatransf import java awt awt event event FocusEvent focus event import java awt awt event event FocusListener focus listener import java beans bean import java util util import java io io import static org org jhotdraw jhotdraw draw draw AttributeKeys attribute key DefaultDrawingEditor drawing editor author author Werner wern Randelshofer randelshof version 3 3 0 0 2006 2006 02 02 13 13 Revised revise to to handle handle multiple multiple drawing drawing views view br 1 1 0 0 2003 2003 12 12 01 01 Derived derive from from JHotDraw jhotdraw 5 5 4b1 4b1 public class DefaultDrawingEditor drawing editor extends AbstractBean bean implements DrawingEditor drawing editor ToolListener tool listener private HashMap hash map AttributeKey attribute key Object defaultAttributes attribute new HashMap hash map AttributeKey attribute key Object private Tool tool tool tool private HashSet hash set DrawingView drawing view views view private DrawingView drawing view activeView active view private boolean isEnabled is enable true private DrawingView drawing view focusedView focus view private FocusListener focus listener focusHandler focus handler new FocusListener focus listener public void focusGained focus gain FocusEvent focus event e e setFocusedView set focus view DrawingView drawing view findView find view Container container e e getSource get source public void focusLost focus lost FocusEvent focus event e e if e e isTemporary is temporary setFocusedView set focus view null Creates create a a new instance instance public DefaultDrawingEditor drawing editor setDefaultAttribute set attribute FILL f i l l COLOR c o l o r Color color white white setDefaultAttribute set attribute STROKE s t r o k e COLOR c o l o r Color color black black setDefaultAttribute set attribute TEXT t e x t COLOR c o l o r Color color black black views view new HashSet hash set DrawingView drawing view public void setTool set tool Tool tool t t if t t tool tool return if tool tool null for DrawingView drawing view v v views view v v removeMouseListener remove mouse listener tool tool v v removeMouseMotionListener remove mouse motion listener tool tool v v removeKeyListener remove key listener tool tool tool tool deactivate deactivate this tool tool removeToolListener remove tool listener this tool tool t t if tool tool null tool tool activate activate this for DrawingView drawing view v v views view v v addMouseListener add mouse listener tool tool v v addMouseMotionListener add mouse motion listener tool tool v v addKeyListener add key listener tool tool tool tool addToolListener add tool listener this public void areaInvalidated area invalidate ToolEvent tool event evt evt Rectangle rectangle r r evt evt getInvalidatedArea get invalidate area evt evt getView get view getContainer get container repaint repaint r r x x r r y y r r width width r r height height public void toolStarted tool start ToolEvent tool event evt evt setView set view evt evt getView get view public void setView set view DrawingView drawing view newValue value DrawingView drawing view oldValue old value activeView active view activeView active view newValue value firePropertyChange fire property change view view oldValue old value newValue value for DrawingView drawing view v v views view v v getContainer get container repaint repaint public void toolDone tool ToolEvent tool event evt evt FIXME f i x m e Maybe maybe we we should should do this with with all all views view of of the the editor?? editor?? DrawingView drawing view v v getView get view if v v null Container container c c v v getContainer get container c c invalidate invalidate if c c getParent get parent null c c getParent get parent validate validate public Tool tool getTool get tool return tool tool public DrawingView drawing view getView get view return activeView active view null ? ? activeView active view views view iterator iterator next next private void updateFocusedView update focus view for DrawingView drawing view v v views view if v v getContainer get container hasFocus ha focus setFocusedView set focus view v v return setFocusedView set focus view null private void setFocusedView set focus view DrawingView drawing view newValue value DrawingView drawing view oldValue old value focusedView focus view focusedView focus view newValue value firePropertyChange fire property change focusedView focus view oldValue old value newValue value public DrawingView drawing view getFocusedView get focus view return focusedView focus view public void applyDefaultAttributesTo apply attribute to Figure figure f f for Map map Entry entry AttributeKey attribute key Object entry entry defaultAttributes attribute entrySet entry set f f setAttribute set attribute entry entry getKey get key entry entry getValue get value public Object getDefaultAttribute get attribute AttributeKey attribute key key key return defaultAttributes attribute get get key key public void setDefaultAttribute set attribute AttributeKey attribute key key key Object newValue value Object oldValue old value defaultAttributes attribute put put key key newValue value firePropertyChange fire property change key key getKey get key oldValue old value newValue value public void remove remove DrawingView drawing view view view view view getContainer get container removeFocusListener remove focus listener focusHandler focus handler views view remove remove view view if tool tool null view view removeMouseListener remove mouse listener tool tool view view removeMouseMotionListener remove mouse motion listener tool tool view view removeKeyListener remove key listener tool tool view view removeNotify remove notify this if activeView active view view view view view views view size size 0 0 ? ? views view iterator iterator next next null updateFocusedView update focus view public void add add DrawingView drawing view view view views view add add view view view view addNotify add notify this view view getContainer get container addFocusListener add focus listener focusHandler focus handler if tool tool null view view addMouseListener add mouse listener tool tool view view addMouseMotionListener add mouse motion listener tool tool view view addKeyListener add key listener tool tool updateFocusedView update focus view public void setCursor set cursor Cursor cursor c c public Collection collection DrawingView drawing view getDrawingViews get drawing view return Collections collection unmodifiableCollection unmodifiable collection views view public DrawingView drawing view findView find view Container container c c for DrawingView drawing view v v views view if v v getContainer get container c c return v v return null public void setEnabled set enable boolean newValue value if newValue value isEnabled is enable boolean oldValue old value isEnabled is enable isEnabled is enable newValue value firePropertyChange fire property change enabled enable oldValue old value newValue value public boolean isEnabled is enable return isEnabled is enable 