MDIDesktopPane m d idesktop pane java 1 1 0 0 2006 2006 06 06 17 17 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org package org org jhotdraw jhotdraw gui gui import javax javax swing swing import javax javax swing swing event event import java awt awt import java beans bean import org org jhotdraw jhotdraw app app action action Arrangeable arrangeable An an extension extension of of JDesktopPane j desktop pane that that supports support often often used use MDI m d i functionality functionality This class also also handles handle setting setting scroll scroll bars bar for when when windows window move move too too far far to to the the left left or or bottom bottom providing provide the the MDIDesktopPane m d idesktop pane is is in in a a ScrollPane scroll pane Note note by by dnoyeb dnoyeb I i dont dont know know why why the the container container does doe not not fire fire frame frame close close events event when when the the frames frame are are removed remove from from the the container container with with remove remove as a opposed oppose to to simply simply closed close with with the the x x so so if you you say say removeAll remove all from from container container you you wont wont be be notified notify No no biggie biggie author author Werner wern Randelshofer randelshof Original original version by by Wolfram wolfram Kaiser kaiser adapted adapt from from an an article article in in JavaWorld world C c L l Gilbert gilbert dnoyeb dnoyeb users user sourceforge sourceforge net net version 1 1 0 0 2006 2006 06 06 17 17 public class MDIDesktopPane m d idesktop pane extends JDesktopPane j desktop pane implements Arrangeable arrangeable private static int FRAME f r a m e OFFSET o f f s e t 20 20 private MDIDesktopManager m d idesktop manager manager manager public MDIDesktopPane m d idesktop pane manager manager new MDIDesktopManager m d idesktop manager this setDesktopManager set desktop manager manager manager setDragMode set drag mode JDesktopPane j desktop pane OUTLINE o u t l i n e DRAG d r a g MODE m o d e setAlignmentX set alignment x JComponent j component LEFT l e f t ALIGNMENT a l i g n m e n t public void setArrangement set arrangement Arrangeable arrangeable Arrangement arrangement newValue value Arrangeable arrangeable Arrangement arrangement oldValue old value getArrangement get arrangement switch newValue value case CASCADE c a s c a d e arrangeFramesCascading arrange frame cascade break case HORIZONTAL h o r i z o n t a l arrangeFramesHorizontally arrange frame horizontally break case VERTICAL v e r t i c a l arrangeFramesVertically arrange frame vertically break firePropertyChange fire property change arrangement arrangement oldValue old value newValue value public Arrangeable arrangeable Arrangement arrangement getArrangement get arrangement FIXME f i x m e Check check for the the arrangement arrangement of of the the JInternalFrames j internal frame here here and and return the the true value value return Arrangeable arrangeable Arrangement arrangement CASCADE c a s c a d e Cascade cascade all all internal internal frames frame private void arrangeFramesCascading arrange frame cascade int x x 0 0 int y y 0 0 JInternalFrame j internal frame allFrames all frame getAllFrames get all frame do nothing nothing if no no frames frame to to work work with with if allFrames all frame length length 0 0 return manager manager setNormalSize set normal size int frameHeight frame height getBounds get bound height height 5 5 allFrames all frame length length FRAME f r a m e OFFSET o f f s e t int frameWidth frame width getBounds get bound width width 5 5 allFrames all frame length length FRAME f r a m e OFFSET o f f s e t for int i i allFrames all frame length length 1 1 i i 0 0 i i try allFrames all frame i i setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame i i setBounds set bound x x y y frameWidth frame width frameHeight frame height x x x x + + FRAME f r a m e OFFSET o f f s e t y y y y + + FRAME f r a m e OFFSET o f f s e t checkDesktopSize check desktop size private void tileFramesHorizontally tile frame horizontally Component component allFrames all frame getAllFrames get all frame do nothing nothing if no no frames frame to to work work with with if allFrames all frame length length 0 0 return manager manager setNormalSize set normal size int frameHeight frame height getBounds get bound height height allFrames all frame length length int y y 0 0 for int i i 0 0 i i allFrames all frame length length i++ i++ try JInternalFrame j internal frame allFrames all frame i i setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame i i setBounds set bound 0 0 y y getBounds get bound width width frameHeight frame height y y y y + + frameHeight frame height checkDesktopSize check desktop size public void tileFramesVertically tile frame vertically Component component allFrames all frame getAllFrames get all frame do nothing nothing if no no frames frame to to work work with with if allFrames all frame length length 0 0 return manager manager setNormalSize set normal size int frameWidth frame width getBounds get bound width width allFrames all frame length length int x x 0 0 for int i i 0 0 i i allFrames all frame length length i++ i++ try JInternalFrame j internal frame allFrames all frame i i setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame i i setBounds set bound x x 0 0 frameWidth frame width getBounds get bound height height x x x x + + frameWidth frame width checkDesktopSize check desktop size Arranges arrange the the frames frame as a efficiently efficiently as a possibly possibly with with preference preference for keeping keeping vertical vertical size size maximal maximal br public void arrangeFramesVertically arrange frame vertically Component component allFrames all frame getAllFrames get all frame do nothing nothing if no no frames frame to to work work with with if allFrames all frame length length 0 0 return manager manager setNormalSize set normal size int vertFrames vert frame int Math math floor floor Math math sqrt sqrt allFrames all frame length length int horFrames hor frame int Math math ceil ceil Math math sqrt sqrt allFrames all frame length length first first arrange arrange the the windows window that that have have equal equal size size int frameWidth frame width getBounds get bound width width horFrames hor frame int frameHeight frame height getBounds get bound height height vertFrames vert frame int x x 0 0 int y y 0 0 int frameIdx frame idx 0 0 for int horCnt hor cnt 0 0 horCnt hor cnt horFrames hor frame 1 1 horCnt++ hor cnt++ y y 0 0 for int vertCnt vert cnt 0 0 vertCnt vert cnt vertFrames vert frame vertCnt++ vert cnt++ try JInternalFrame j internal frame allFrames all frame frameIdx frame idx setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame frameIdx frame idx setBounds set bound x x y y frameWidth frame width frameHeight frame height frameIdx++ frame idx++ y y y y + + frameHeight frame height x x x x + + frameWidth frame width the the rest rest of of the the frames frame are are tiled tile down down on on the the last last column column with with equal equal height height frameHeight frame height getBounds get bound height height allFrames all frame length length frameIdx frame idx y y 0 0 for frameIdx frame idx allFrames all frame length length frameIdx++ frame idx++ try JInternalFrame j internal frame allFrames all frame frameIdx frame idx setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame frameIdx frame idx setBounds set bound x x y y frameWidth frame width frameHeight frame height y y y y + + frameHeight frame height checkDesktopSize check desktop size Arranges arrange the the frames frame as a efficiently efficiently as a possibly possibly with with preference preference for keeping keeping horizontal horizontal size size maximal maximal br public void arrangeFramesHorizontally arrange frame horizontally Component component allFrames all frame getAllFrames get all frame do nothing nothing if no no frames frame to to work work with with if allFrames all frame length length 0 0 return manager manager setNormalSize set normal size int vertFrames vert frame int Math math ceil ceil Math math sqrt sqrt allFrames all frame length length int horFrames hor frame int Math math floor floor Math math sqrt sqrt allFrames all frame length length first first arrange arrange the the windows window that that have have equal equal size size int frameWidth frame width getBounds get bound width width horFrames hor frame int frameHeight frame height getBounds get bound height height vertFrames vert frame int x x 0 0 int y y 0 0 int frameIdx frame idx 0 0 for int vertCnt vert cnt 0 0 vertCnt vert cnt vertFrames vert frame 1 1 vertCnt++ vert cnt++ x x 0 0 for int horCnt hor cnt 0 0 horCnt hor cnt horFrames hor frame horCnt++ hor cnt++ try JInternalFrame j internal frame allFrames all frame frameIdx frame idx setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame frameIdx frame idx setBounds set bound x x y y frameWidth frame width frameHeight frame height frameIdx++ frame idx++ x x x x + + frameWidth frame width y y y y + + frameHeight frame height the the rest rest of of the the frames frame are are tiled tile down down on on the the last last column column with with equal equal height height frameWidth frame width getBounds get bound width width allFrames all frame length length frameIdx frame idx x x 0 0 for frameIdx frame idx allFrames all frame length length frameIdx++ frame idx++ try JInternalFrame j internal frame allFrames all frame frameIdx frame idx setMaximum set maximum false catch PropertyVetoException property veto e e e e printStackTrace print stack trace allFrames all frame frameIdx frame idx setBounds set bound x x y y frameWidth frame width frameHeight frame height x x x x + + frameWidth frame width checkDesktopSize check desktop size Sets set all all component component size size properties property maximum maximum minimum minimum preferred prefer to to the the given given dimension dimension public void setAllSize set all size Dimension dimension d d setMinimumSize set minimum size d d setMaximumSize set maximum size d d setPreferredSize set prefer size d d setBounds set bound 0 0 0 0 d d width width d d height height Sets set all all component component size size properties property maximum maximum minimum minimum preferred prefer to to the the given given width width and and height height public void setAllSize set all size int width width int height height setAllSize set all size new Dimension dimension width width height height private void checkDesktopSize check desktop size if getParent get parent null isVisible is visible manager manager resizeDesktop resize desktop Private class used use to to replace replace the the standard standard DesktopManager desktop manager for JDesktopPane j desktop pane Used use to to provide provide scrollbar scrollbar functionality functionality class MDIDesktopManager m d idesktop manager extends DefaultDesktopManager desktop manager private MDIDesktopPane m d idesktop pane desktop desktop public MDIDesktopManager m d idesktop manager MDIDesktopPane m d idesktop pane newDesktop desktop this desktop desktop newDesktop desktop public void endResizingFrame end resize frame JComponent j component f f super endResizingFrame end resize frame f f resizeDesktop resize desktop public void endDraggingFrame end drag frame JComponent j component f f super endDraggingFrame end drag frame f f resizeDesktop resize desktop public void setNormalSize set normal size JScrollPane j scroll pane scrollPane scroll pane getScrollPane get scroll pane Insets inset scrollInsets scroll inset getScrollPaneInsets get scroll pane inset if scrollPane scroll pane null Dimension dimension d d scrollPane scroll pane getVisibleRect get visible rect getSize get size if scrollPane scroll pane getBorder get border null d d setSize set size d d getWidth get width scrollInsets scroll inset left left scrollInsets scroll inset right right d d getHeight get height scrollInsets scroll inset top top scrollInsets scroll inset bottom bottom d d setSize set size d d getWidth get width 20 20 d d getHeight get height 20 20 desktop desktop setAllSize set all size d d scrollPane scroll pane invalidate invalidate scrollPane scroll pane validate validate private Insets inset getScrollPaneInsets get scroll pane inset JScrollPane j scroll pane scrollPane scroll pane getScrollPane get scroll pane if scrollPane scroll pane null || || getScrollPane get scroll pane getBorder get border null return new Insets inset 0 0 0 0 0 0 0 0 else return getScrollPane get scroll pane getBorder get border getBorderInsets get border inset scrollPane scroll pane public JScrollPane j scroll pane getScrollPane get scroll pane if desktop desktop getParent get parent instanceof JViewport j viewport JViewport j viewport viewPort view port JViewport j viewport desktop desktop getParent get parent if viewPort view port getParent get parent instanceof JScrollPane j scroll pane return JScrollPane j scroll pane viewPort view port getParent get parent return null protected void resizeDesktop resize desktop int x x 0 0 int y y 0 0 JScrollPane j scroll pane scrollPane scroll pane getScrollPane get scroll pane Insets inset scrollInsets scroll inset getScrollPaneInsets get scroll pane inset if scrollPane scroll pane null JInternalFrame j internal frame allFrames all frame desktop desktop getAllFrames get all frame for int i i 0 0 i i allFrames all frame length length i++ i++ if allFrames all frame i i getX get x + + allFrames all frame i i getWidth get width x x x x allFrames all frame i i getX get x + + allFrames all frame i i getWidth get width if allFrames all frame i i getY get y + + allFrames all frame i i getHeight get height y y y y allFrames all frame i i getY get y + + allFrames all frame i i getHeight get height Dimension dimension d d scrollPane scroll pane getVisibleRect get visible rect getSize get size if scrollPane scroll pane getBorder get border null d d setSize set size d d getWidth get width scrollInsets scroll inset left left scrollInsets scroll inset right right d d getHeight get height scrollInsets scroll inset top top scrollInsets scroll inset bottom bottom if x x d d getWidth get width x x int d d getWidth get width 20 20 if y y d d getHeight get height y y int d d getHeight get height 20 20 desktop desktop setAllSize set all size x x y y scrollPane scroll pane invalidate invalidate scrollPane scroll pane validate validate 