BoxHandleKit box handle kit java 2 2 0 0 2006 2006 01 01 14 14 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org ??? ??? package org org jhotdraw jhotdraw draw draw import java util util import java awt awt import java awt awt geom geom import java awt awt event event A a set set of of utility utility methods to to create create Handles handle for the the common common locations location on on a a figure figure s s display display box box author author Werner wern Randelshofer randelshof version 2 2 0 0 2006 2006 01 01 14 14 Changed change to to support support double precision precision coordinates coordinate br 1 1 0 0 2003 2003 12 12 01 01 Derived derive from from JHotDraw jhotdraw 5 5 4b1 4b1 public class BoxHandleKit box handle kit Creates create a a new instance instance public BoxHandleKit box handle kit Creates create handles handle for each each lead of of a a figure figure and and adds add them them to to the the provided provide collection collection static public void addLeadHandles add handle Figure figure f f Collection collection Handle handle handles handle handles handle add add southEast south east f f handles handle add add southWest south west f f handles handle add add northEast north east f f handles handle add add northWest north west f f Fills fill the the given given Vector vector with with handles handle at at each each the the north north south south east east and and west west of of the the figure figure static public void addEdgeHandles add edge handle Figure figure f f Collection collection Handle handle handles handle handles handle add add south south f f handles handle add add north north f f handles handle add add east east f f handles handle add add west west f f Fills fill the the given given Vector vector with with handles handle at at each each the the north north south south east east and and west west of of the the figure figure static public void addBoxHandles add box handle Figure figure f f Collection collection Handle handle handles handle addLeadHandles add handle f f handles handle addEdgeHandles add edge handle f f handles handle static public Handle handle south south Figure figure owner owner return new SouthHandle south handle owner owner static public Handle handle southEast south east Figure figure owner owner return new SouthEastHandle south east handle owner owner static public Handle handle southWest south west Figure figure owner owner return new SouthWestHandle south west handle owner owner static public Handle handle north north Figure figure owner owner return new NorthHandle north handle owner owner static public Handle handle northEast north east Figure figure owner owner return new NorthEastHandle north east handle owner owner static public Handle handle northWest north west Figure figure owner owner return new NorthWestHandle north west handle owner owner static public Handle handle east east Figure figure owner owner return new EastHandle east handle owner owner static public Handle handle west west Figure figure owner owner return new WestHandle west handle owner owner private static class ResizeHandle resize handle extends LocatorHandle locator handle private int dx dx dy dy Object geometry geometry ResizeHandle resize handle Figure figure owner owner Locator locator loc loc super owner owner loc loc public void trackStart track start Point point anchor anchor int modifiersEx modifier ex geometry geometry getOwner get owner getRestoreData get restore data Point point location location getLocation get location dx dx anchor anchor x x + + location location x x dy dy anchor anchor y y + + location location y y public void trackStep track step Point point anchor anchor Point point lead int modifiersEx modifier ex Point2D point2 d Double p p view view viewToDrawing view to drawing new Point point lead x x + + dx dx lead y y + + dy dy view view getConstrainer get constrain constrainPoint constrain point p p trackStepNormalized track step normalize p p public void trackEnd track end Point point anchor anchor Point point lead int modifiersEx modifier ex fireUndoableEditHappened fire undoable edit happen new GeometryEdit geometry edit getOwner get owner geometry geometry getOwner get owner getRestoreData get restore data protected void trackStepNormalized track step normalize Point2D point2 d Double p p FIXME f i x m e Replace replace operation operation parameters by by a a Rectangle2D rectangle2 d Double protected void setBounds set bound Point2D point2 d Double anchor anchor Point2D point2 d Double lead Figure figure f f getOwner get owner f f willChange will change Rectangle2D rectangle2 d Double oldBounds old bound f f getBounds get bound Rectangle2D rectangle2 d Double newBounds bound new Rectangle2D rectangle2 d Double Math math min min anchor anchor x x lead x x Math math min min anchor anchor y y lead y y Math math abs ab anchor anchor x x lead x x Math math abs ab anchor anchor y y lead y y double sx sx newBounds bound width width oldBounds old bound width width double sy sy newBounds bound height height oldBounds old bound height height AffineTransform affine transform tx tx new AffineTransform affine transform tx tx translate translate oldBounds old bound x x oldBounds old bound y y if Double isNaN is na n sx sx Double isNaN is na n sy sy sx sx 1d 1d || || sy sy 1d 1d sx sx 0 0 0001 0001 sy sy 0 0 0001 0001 f f basicTransform basic transform tx tx tx tx setToIdentity set to identity tx tx scale scale sx sx sy sy f f basicTransform basic transform tx tx tx tx setToIdentity set to identity tx tx translate translate newBounds bound x x newBounds bound y y f f basicTransform basic transform tx tx f f changed change private static class NorthEastHandle north east handle extends ResizeHandle resize handle NorthEastHandle north east handle Figure figure owner owner super owner owner RelativeLocator relative locator northEast north east protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double r r x x Math math min min r r y y + + r r height height 1 1 p p y y new Point2D point2 d Double Math math max max r r x x p p x x r r y y + + r r height height public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor NE n e RESIZE r e s i z e CURSOR c u r s o r private static class EastHandle east handle extends ResizeHandle resize handle EastHandle east handle Figure figure owner owner super owner owner RelativeLocator relative locator east east protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double r r x x r r y y new Point2D point2 d Double Math math max max r r x x + + 1 1 p p x x r r y y + + r r height height public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor E e RESIZE r e s i z e CURSOR c u r s o r private static class NorthHandle north handle extends ResizeHandle resize handle NorthHandle north handle Figure figure owner owner super owner owner RelativeLocator relative locator north north protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double r r x x Math math min min r r y y + + r r height height 1 1 p p y y new Point2D point2 d Double r r x x + + r r width width r r y y + + r r height height public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor N n RESIZE r e s i z e CURSOR c u r s o r private static class NorthWestHandle north west handle extends ResizeHandle resize handle NorthWestHandle north west handle Figure figure owner owner super owner owner RelativeLocator relative locator northWest north west protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double Math math min min r r x x + + r r width width 1 1 p p x x Math math min min r r y y + + r r height height 1 1 p p y y new Point2D point2 d Double r r x x + + r r width width r r y y + + r r height height public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor NW n w RESIZE r e s i z e CURSOR c u r s o r private static class SouthEastHandle south east handle extends ResizeHandle resize handle SouthEastHandle south east handle Figure figure owner owner super owner owner RelativeLocator relative locator southEast south east protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double r r x x r r y y new Point2D point2 d Double Math math max max r r x x + + 1 1 p p x x Math math max max r r y y + + 1 1 p p y y public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor SE s e RESIZE r e s i z e CURSOR c u r s o r private static class SouthHandle south handle extends ResizeHandle resize handle SouthHandle south handle Figure figure owner owner super owner owner RelativeLocator relative locator south south protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double r r x x r r y y new Point2D point2 d Double r r x x + + r r width width Math math max max r r y y + + 1 1 p p y y public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor S s RESIZE r e s i z e CURSOR c u r s o r private static class SouthWestHandle south west handle extends ResizeHandle resize handle SouthWestHandle south west handle Figure figure owner owner super owner owner RelativeLocator relative locator southWest south west protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double Math math min min r r x x + + r r width width 1 1 p p x x r r y y new Point2D point2 d Double r r x x + + r r width width Math math max max r r y y + + 1 1 p p y y public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor SW s w RESIZE r e s i z e CURSOR c u r s o r private static class WestHandle west handle extends ResizeHandle resize handle WestHandle west handle Figure figure owner owner super owner owner RelativeLocator relative locator west west protected void trackStepNormalized track step normalize Point2D point2 d Double p p Rectangle2D rectangle2 d Double r r getOwner get owner getBounds get bound setBounds set bound new Point2D point2 d Double Math math min min r r x x + + r r width width 1 1 p p x x r r y y new Point2D point2 d Double r r x x + + r r width width r r y y + + r r height height public Cursor cursor getCursor get cursor return Cursor cursor getPredefinedCursor get predefin cursor Cursor cursor W w RESIZE r e s i z e CURSOR c u r s o r 