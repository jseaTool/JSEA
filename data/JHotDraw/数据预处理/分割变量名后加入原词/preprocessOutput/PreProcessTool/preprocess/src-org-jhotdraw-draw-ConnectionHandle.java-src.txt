ConnectionHandle connection handle java 1 1 0 0 20 20 Juni juni 2006 2006 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org package org org jhotdraw jhotdraw draw draw import org org jhotdraw jhotdraw undo undo import org org jhotdraw jhotdraw util util import java awt awt import java awt awt geom geom import org org jhotdraw jhotdraw geom geom A a handle handle to to connect connect figures figure The the connection connection object to to be be created create is is specified specify by by a a prototype prototype author author Werner wern Randelshofer randelshof version 1 1 0 0 20 20 Juni juni 2006 2006 Created create public class ConnectionHandle connection handle extends LocatorHandle locator handle private CompositeEdit composite edit edit edit the the currently currently created create connection connection private ConnectionFigure connection figure currentConnection current connection the the prototype prototype of of the the connection connection to to be be created create private ConnectionFigure connection figure prototype prototype the the current current target target private Figure figure targetFigure target figure Creates create a a new instance instance public ConnectionHandle connection handle Figure figure owner owner Locator locator locator locator ConnectionFigure connection figure prototype prototype super owner owner locator locator this prototype prototype prototype prototype public void draw draw Graphics2D graphics2 d g g drawCircle draw circle g g Color color blue blue Color color blue blue darker dark public void trackStart track start Point point anchor anchor int modifiersEx modifier ex setConnection set connection createConnection create connection ResourceBundleUtil resource bundle util labels label ResourceBundleUtil resource bundle util getLAFBundle get l a f bundle org org jhotdraw jhotdraw draw draw Labels label edit edit new CompositeEdit composite edit labels label getString get createConnection create connection fireUndoableEditHappened fire undoable edit happen edit edit Point2D point2 d Double p p getLocationOnDrawing get location on drawing getConnection get connection setStartPoint set start point p p getConnection get connection setEndPoint set end point p p view view getDrawing get drawing add add getConnection get connection public void trackStep track step Point point anchor anchor Point point lead int modifiersEx modifier ex Point2D point2 d Double p p view view viewToDrawing view to drawing lead Figure figure f f findConnectableFigure find connectable figure p p view view getDrawing get drawing track track the the figure figure containing contain the the mouse mouse if f f getTargetFigure get target figure if getTargetFigure get target figure null getTargetFigure get target figure setConnectorsVisible set connector visible false null setTargetFigure set target figure f f if getTargetFigure get target figure null getTargetFigure get target figure setConnectorsVisible set connector visible true getConnection get connection Connector connector target target findConnectionTarget find connection target p p view view getDrawing get drawing if target target null p p Geom geom center center target target getBounds get bound getConnection get connection setEndPoint set end point p p public void trackEnd track end Point point anchor anchor Point point lead int modifiersEx modifier ex Point2D point2 d Double p p view view viewToDrawing view to drawing lead Connector connector target target findConnectionTarget find connection target p p view view getDrawing get drawing if target target null getConnection get connection setStartConnector set start connector getStartConnector get start connector getConnection get connection setEndConnector set end connector target target getConnection get connection updateConnection update connection else view view getDrawing get drawing remove remove getConnection get connection setUndoActivity set undo activity null edit edit setSignificant set significant false setConnection set connection null if getTargetFigure get target figure null getTargetFigure get target figure setConnectorsVisible set connector visible false null setTargetFigure set target figure null fireUndoableEditHappened fire undoable edit happen edit edit Creates create the the ConnectionFigure connection figure By by default the the figure figure prototype prototype is is cloned clone protected ConnectionFigure connection figure createConnection create connection return ConnectionFigure connection figure prototype prototype clone clone protected void setConnection set connection ConnectionFigure connection figure newConnection connection currentConnection current connection newConnection connection protected ConnectionFigure connection figure getConnection get connection return currentConnection current connection protected Figure figure getTargetFigure get target figure return targetFigure target figure protected void setTargetFigure set target figure Figure figure newTargetFigure target figure targetFigure target figure newTargetFigure target figure private Figure figure findConnectableFigure find connectable figure Point2D point2 d Double p p Drawing drawing drawing drawing for Figure figure figure figure drawing drawing getFiguresFrontToBack get figure front to back if figure figure includes include getConnection get connection figure figure canConnect can connect figure figure contains contain p p return figure figure return null protected Connector connector findConnector find connector Point2D point2 d Double p p Figure figure f f return f f findConnector find connector p p getConnection get connection Finds find a a connection connection end end figure figure protected Connector connector findConnectionTarget find connection target Point2D point2 d Double p p Drawing drawing drawing drawing Figure figure target target findConnectableFigure find connectable figure p p drawing drawing if target target null target target canConnect can connect target target includes include getOwner get owner getConnection get connection canConnect can connect getOwner get owner target target return target target findConnector find connector p p getConnection get connection return null private Connector connector getStartConnector get start connector Point2D point2 d Double p p getLocationOnDrawing get location on drawing return getOwner get owner findConnector find connector p p getConnection get connection 