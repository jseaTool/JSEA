DrawProject draw project java 1 1 1 1 2006 2006 06 06 10 10 Copyright copyright c c 1996 1996 2006 2006 by by the the original original authors author of of JHotDraw jhotdraw and and all all its it contributors contributor JHotDraw jhotdraw org org All all rights right reserved reserve This software software is is the the confidential confidential and and proprietary proprietary information information of of JHotDraw jhotdraw org org Confidential confidential Information information You you shall shall not not disclose disclose such such Confidential confidential Information information and and shall shall use use it it only only in in accordance accordance with with the the terms term of of the the license license agreement agreement you you entered enter into into with with JHotDraw jhotdraw org org package org org jhotdraw jhotdraw samples sample net net import java util util prefs pref import org org jhotdraw jhotdraw gui gui import org org jhotdraw jhotdraw io io import org org jhotdraw jhotdraw undo undo import org org jhotdraw jhotdraw util util import java awt awt import java beans bean import java io io import java lang lang reflect reflect import javax javax swing swing import javax javax swing swing border border import org org jhotdraw jhotdraw app app import org org jhotdraw jhotdraw app app action action import org org jhotdraw jhotdraw draw draw import org org jhotdraw jhotdraw draw draw action action import org org jhotdraw jhotdraw xml xml import org org jhotdraw jhotdraw samples sample pert pert figures figure A a Pert pert drawing drawing project project author author Werner wern Randelshofer randelshof version 1 1 1 1 2006 2006 06 06 10 10 Extended extend to to support support DefaultDrawApplicationModel draw application model br 1 1 0 0 2006 2006 02 02 07 07 Created create public class NetProject net project extends AbstractProject project Each each DrawProject draw project uses us its it own own undo undo redo redo manager manager This allows allow for undoing undoing and and redoing redo actions action per p project project private UndoRedoManager undo redo manager undo undo Depending depend on on the the type type of of an an application application there there may may be be one one editor editor per p project project or or a a single single shared share editor editor for all all projects project private DrawingEditor drawing editor editor editor private GridConstrainer grid constrain visibleConstrainer visible constrain new GridConstrainer grid constrain 10 10 10 10 private GridConstrainer grid constrain invisibleConstrainer invisible constrain new GridConstrainer grid constrain 1 1 1 1 private Preferences preference prefs pref private AbstractButton button toggleGridButton toggle grid button Creates create a a new Project project public NetProject net project Initializes initializ the the project project public void init init super init init initComponents init component JPanel j panel zoomButtonPanel zoom button panel new JPanel j panel new BorderLayout border layout scrollPane scroll pane setLayout set layout new PlacardScrollPaneLayout placard scroll pane layout scrollPane scroll pane setBorder set border new EmptyBorder empty border 0 0 0 0 0 0 0 0 setEditor set editor new DefaultDrawingEditor drawing editor view view setDOMFactory set dom factory new NetFactory net factory undo undo new UndoRedoManager undo redo manager view view setDrawing set drawing new DefaultDrawing drawing view view getDrawing get drawing addUndoableEditListener add undoable edit listener undo undo initActions init action undo undo addPropertyChangeListener add property change listener new PropertyChangeListener property change listener public void propertyChange property change PropertyChangeEvent property change event evt evt setHasUnsavedChanges set ha unsav change undo undo hasSignificantEdits ha significant edit ResourceBundleUtil resource bundle util labels label ResourceBundleUtil resource bundle util getLAFBundle get l a f bundle org org jhotdraw jhotdraw draw draw Labels label JPanel j panel placardPanel placard panel new JPanel j panel new BorderLayout border layout javax javax swing swing AbstractButton button pButton p button pButton p button ToolBarButtonFactory tool bar button factory createZoomButton create zoom button view view pButton p button putClientProperty put client property Quaqua quaqua Button button style style placard placard pButton p button putClientProperty put client property Quaqua quaqua Component component visualMargin visual margin new Insets inset 0 0 0 0 0 0 0 0 pButton p button setFont set font UIManager u i manager getFont get font SmallSystemFont small font placardPanel placard panel add add pButton p button BorderLayout border layout WEST w e s t toggleGridButton toggle grid button pButton p button ToolBarButtonFactory tool bar button factory createToggleGridButton create toggle grid button view view pButton p button putClientProperty put client property Quaqua quaqua Button button style style placard placard pButton p button putClientProperty put client property Quaqua quaqua Component component visualMargin visual margin new Insets inset 0 0 0 0 0 0 0 0 pButton p button setFont set font UIManager u i manager getFont get font SmallSystemFont small font labels label configureToolBarButton configure tool bar button pButton p button alignGridSmall align grid small placardPanel placard panel add add pButton p button BorderLayout border layout EAST e a s t scrollPane scroll pane add add placardPanel placard panel JScrollPane j scroll pane LOWER l o w e r LEFT l e f t CORNER c o r n e r prefs pref Preferences preference userNodeForPackage user node getClass get toggleGridButton toggle grid button setSelected set select prefs pref getBoolean get project project gridVisible grid visible false setScaleFactor set scale factor prefs pref getDouble get project project scaleFactor scale factor 1d 1d view view addPropertyChangeListener add property change listener new PropertyChangeListener property change listener public void propertyChange property change PropertyChangeEvent property change event evt evt String name name evt evt getPropertyName get property name if name name equals equal constrainer constrain prefs pref putBoolean put project project gridVisible grid visible Constrainer constrain evt evt getNewValue get value isVisible is visible firePropertyChange fire property change gridVisible grid visible Constrainer constrain evt evt getOldValue get old value isVisible is visible Constrainer constrain evt evt getNewValue get value isVisible is visible else if name name equals equal scaleFactor scale factor prefs pref putDouble put project project scaleFactor scale factor Double evt evt getNewValue get value firePropertyChange fire property change scaleFactor scale factor evt evt getOldValue get old value evt evt getNewValue get value public DrawingEditor drawing editor getEditor get editor return editor editor public void setEditor set editor DrawingEditor drawing editor newValue value DrawingEditor drawing editor oldValue old value editor editor if oldValue old value null oldValue old value remove remove view view editor editor newValue value if newValue value null newValue value add add view view public void setGridVisible set grid visible boolean newValue value XXX x x x This code is is messy messy We we should should invoke something someth on on view view toggleGridButton toggle grid button setSelected set select newValue value public boolean isGridVisible is grid visible return view view getConstrainer get constrain isVisible is visible public double getScaleFactor get scale factor return view view getScaleFactor get scale factor public void setScaleFactor set scale factor double newValue value view view setScaleFactor set scale factor newValue value Initializes initializ project project specific specific actions action private void initActions init action putAction put action UndoAction undo action ID undo undo getUndoAction get undo action putAction put action RedoAction redo action ID undo undo getRedoAction get redo action protected void setHasUnsavedChanges set ha unsav change boolean newValue value super setHasUnsavedChanges set ha unsav change newValue value undo undo setHasSignificantEdits set ha significant edit newValue value Writes write the the project project to to the the specified specify file public void write write File f f throws IOException i o OutputStream output stream out out null try out out new BufferedOutputStream buffer output stream new FileOutputStream output stream f f NanoXMLLiteDOMOutput nano xml lite dom output domo domo new NanoXMLLiteDOMOutput nano xml lite dom output view view getDOMFactory get dom factory domo domo writeObject write view view getDrawing get drawing domo domo save save out out finally if out out null try out out close close catch IOException i o e e if out out null out out close close Reads read the the project project from from the the specified specify file public void read read File f f throws IOException i o InputStream input stream in in null try in in new BufferedInputStream buffer input stream new FileInputStream input stream f f NanoXMLLiteDOMInput nano xml lite dom input domi domi new NanoXMLLiteDOMInput nano xml lite dom input view view getDOMFactory get dom factory in in final Drawing drawing drawing drawing Drawing drawing domi domi readObject read SwingUtilities swing utility invokeAndWait and wait new Runnable runnable public void run run view view getDrawing get drawing removeUndoableEditListener remove undoable edit listener undo undo view view setDrawing set drawing drawing drawing view view getDrawing get drawing addUndoableEditListener add undoable edit listener undo undo undo undo discardAllEdits discard all edit catch InterruptedException interrupt e e InternalError internal error new InternalError internal e e initCause init cause e e throw error catch InvocationTargetException invocation target e e InternalError internal error new InternalError internal e e initCause init cause e e throw error finally if in in null try in in close close catch IOException i o e e Sets set a a drawing drawing editor editor for the the project project public void setDrawingEditor set drawing editor DrawingEditor drawing editor newValue value if editor editor null editor editor remove remove view view editor editor newValue value if editor editor null editor editor add add view view Gets get the the drawing drawing editor editor of of the the project project public DrawingEditor drawing editor getDrawingEditor get drawing editor return editor editor Clears clear the the project project public void clear clear view view setDrawing set drawing new DefaultDrawing drawing undo undo discardAllEdits discard all edit Override override protected JFileChooser j chooser createOpenChooser create open chooser JFileChooser j chooser c c super createOpenChooser create open chooser c c addChoosableFileFilter add choosable filter new ExtensionFileFilter extension filter Net net Diagram diagram xml xml return c c Override override protected JFileChooser j chooser createSaveChooser create save chooser JFileChooser j chooser c c super createSaveChooser create save chooser c c addChoosableFileFilter add choosable filter new ExtensionFileFilter extension filter Net net Diagram diagram xml xml return c c This method is is called call from from within within the the constructor constructor to to initialize initialize the the form form WARNING w a r n i n g Do NOT n o t modify modify this code The the content content of of this method is is always alway regenerated regenerate by by the the Form form Editor editor editor editor fold fold defaultstate defaultstate collapsed collapse desc desc Generated generate Code GEN g e n BEGIN b e g i n initComponents init component private void initComponents init component scrollPane scroll pane new javax javax swing swing JScrollPane j scroll pane view view new org org jhotdraw jhotdraw draw draw DefaultDrawingView drawing view setLayout set layout new java awt awt BorderLayout border layout scrollPane scroll pane setHorizontalScrollBarPolicy set horizontal scroll bar policy javax javax swing swing ScrollPaneConstants scroll pane constant HORIZONTAL h o r i z o n t a l SCROLLBAR s c r o l l b a r ALWAYS a l w a y s scrollPane scroll pane setVerticalScrollBarPolicy set vertical scroll bar policy javax javax swing swing ScrollPaneConstants scroll pane constant VERTICAL v e r t i c a l SCROLLBAR s c r o l l b a r ALWAYS a l w a y s scrollPane scroll pane setViewportView set viewport view view view add add scrollPane scroll pane java awt awt BorderLayout border layout CENTER c e n t e r editor editor fold fold GEN g e n END e n d initComponents init component Variables variable declaration declaration do not not modify modify GEN g e n BEGIN b e g i n variables variable private javax javax swing swing JScrollPane j scroll pane scrollPane scroll pane private org org jhotdraw jhotdraw draw draw DefaultDrawingView drawing view view view End end of of variables variable declaration declaration GEN g e n END e n d variables variable 